/**
jsonrpc-bidirectional v6.2.1
Bidirectional JSONRPC over web sockets or HTTP with extensive plugin support.
https://github.com/oxygen/jsonrpc-bidirectional


MIT License

Copyright (c) 2017 Bigstep Cloud SRL

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
*/
!function(e,t){if("object"==typeof exports&&"object"==typeof module)module.exports=t(require(""),require("fetch"),require("forge"));else if("function"==typeof define&&define.amd)define(["","fetch","forge"],t);else{var r="object"==typeof exports?t(require(""),require("fetch"),require("forge")):t(e[""],e.fetch,e.forge);for(var n in r)("object"==typeof exports?exports:e)[n]=r[n]}}(this,function(e,t,r){return function(e){function t(n){if(r[n])return r[n].exports;var i=r[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var r={};return t.m=e,t.c=r,t.i=function(e){return e},t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{configurable:!1,enumerable:!0,get:n})},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,"a",r),r},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s=98)}([function(e,t){function r(){throw new Error("setTimeout has not been defined")}function n(){throw new Error("clearTimeout has not been defined")}function i(e){if(l===setTimeout)return setTimeout(e,0);if((l===r||!l)&&setTimeout)return l=setTimeout,setTimeout(e,0);try{return l(e,0)}catch(t){try{return l.call(null,e,0)}catch(t){return l.call(this,e,0)}}}function o(e){if(f===clearTimeout)return clearTimeout(e);if((f===n||!f)&&clearTimeout)return f=clearTimeout,clearTimeout(e);try{return f(e)}catch(t){try{return f.call(null,e)}catch(t){return f.call(this,e)}}}function s(){b&&p&&(b=!1,p.length?d=p.concat(d):y=-1,d.length&&a())}function a(){if(!b){var e=i(s);b=!0;for(var t=d.length;t;){for(p=d,d=[];++y<t;)p&&p[y].run();y=-1,t=d.length}p=null,b=!1,o(e)}}function u(e,t){this.fun=e,this.array=t}function c(){}var l,f,h=e.exports={};!function(){try{l="function"==typeof setTimeout?setTimeout:r}catch(e){l=r}try{f="function"==typeof clearTimeout?clearTimeout:n}catch(e){f=n}}();var p,d=[],b=!1,y=-1;h.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];d.push(new u(e,t)),1!==d.length||b||i(a)},u.prototype.run=function(){this.fun.apply(null,this.array)},h.title="browser",h.browser=!0,h.env={},h.argv=[],h.version="",h.versions={},h.on=c,h.addListener=c,h.once=c,h.off=c,h.removeListener=c,h.removeAllListeners=c,h.emit=c,h.prependListener=c,h.prependOnceListener=c,h.listeners=function(e){return[]},h.binding=function(e){throw new Error("process.binding is not supported")},h.cwd=function(){return"/"},h.chdir=function(e){throw new Error("process.chdir is not supported")},h.umask=function(){return 0}},function(e,t,r){"use strict";(function(t){function n(e,t){if(e===t)return 0;for(var r=e.length,n=t.length,i=0,o=Math.min(r,n);i<o;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0}function i(e){return t.Buffer&&"function"==typeof t.Buffer.isBuffer?t.Buffer.isBuffer(e):!(null==e||!e._isBuffer)}function o(e){return Object.prototype.toString.call(e)}function s(e){return!i(e)&&("function"==typeof t.ArrayBuffer&&("function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):!!e&&(e instanceof DataView||!!(e.buffer&&e.buffer instanceof ArrayBuffer))))}function a(e){if(m.isFunction(e)){if(R)return e.name;var t=e.toString(),r=t.match(S);return r&&r[1]}}function u(e,t){return"string"==typeof e?e.length<t?e:e.slice(0,t):e}function c(e){if(R||!m.isFunction(e))return m.inspect(e);var t=a(e);return"[Function"+(t?": "+t:"")+"]"}function l(e){return u(c(e.actual),128)+" "+e.operator+" "+u(c(e.expected),128)}function f(e,t,r,n,i){throw new E.AssertionError({message:r,actual:e,expected:t,operator:n,stackStartFunction:i})}function h(e,t){e||f(e,!0,t,"==",E.ok)}function p(e,t,r,a){if(e===t)return!0;if(i(e)&&i(t))return 0===n(e,t);if(m.isDate(e)&&m.isDate(t))return e.getTime()===t.getTime();if(m.isRegExp(e)&&m.isRegExp(t))return e.source===t.source&&e.global===t.global&&e.multiline===t.multiline&&e.lastIndex===t.lastIndex&&e.ignoreCase===t.ignoreCase;if(null!==e&&"object"==typeof e||null!==t&&"object"==typeof t){if(s(e)&&s(t)&&o(e)===o(t)&&!(e instanceof Float32Array||e instanceof Float64Array))return 0===n(new Uint8Array(e.buffer),new Uint8Array(t.buffer));if(i(e)!==i(t))return!1;a=a||{actual:[],expected:[]};var u=a.actual.indexOf(e);return-1!==u&&u===a.expected.indexOf(t)||(a.actual.push(e),a.expected.push(t),b(e,t,r,a))}return r?e===t:e==t}function d(e){return"[object Arguments]"==Object.prototype.toString.call(e)}function b(e,t,r,n){if(null===e||void 0===e||null===t||void 0===t)return!1;if(m.isPrimitive(e)||m.isPrimitive(t))return e===t;if(r&&Object.getPrototypeOf(e)!==Object.getPrototypeOf(t))return!1;var i=d(e),o=d(t);if(i&&!o||!i&&o)return!1;if(i)return e=k.call(e),t=k.call(t),p(e,t,r);var s,a,u=x(e),c=x(t);if(u.length!==c.length)return!1;for(u.sort(),c.sort(),a=u.length-1;a>=0;a--)if(u[a]!==c[a])return!1;for(a=u.length-1;a>=0;a--)if(s=u[a],!p(e[s],t[s],r,n))return!1;return!0}function y(e,t,r){p(e,t,!0)&&f(e,t,r,"notDeepStrictEqual",y)}function g(e,t){if(!e||!t)return!1;if("[object RegExp]"==Object.prototype.toString.call(t))return t.test(e);try{if(e instanceof t)return!0}catch(e){}return!Error.isPrototypeOf(t)&&!0===t.call({},e)}function v(e){var t;try{e()}catch(e){t=e}return t}function _(e,t,r,n){var i;if("function"!=typeof t)throw new TypeError('"block" argument must be a function');"string"==typeof r&&(n=r,r=null),i=v(t),n=(r&&r.name?" ("+r.name+").":".")+(n?" "+n:"."),e&&!i&&f(i,r,"Missing expected exception"+n);var o="string"==typeof n,s=!e&&m.isError(i),a=!e&&i&&!r;if((s&&o&&g(i,r)||a)&&f(i,r,"Got unwanted exception"+n),e&&i&&r&&!g(i,r)||!e&&i)throw i}var m=r(38),w=Object.prototype.hasOwnProperty,k=Array.prototype.slice,R=function(){return"foo"===function(){}.name}(),E=e.exports=h,S=/\s*function\s+([^\(\s]*)\s*/;E.AssertionError=function(e){this.name="AssertionError",this.actual=e.actual,this.expected=e.expected,this.operator=e.operator,e.message?(this.message=e.message,this.generatedMessage=!1):(this.message=l(this),this.generatedMessage=!0);var t=e.stackStartFunction||f;if(Error.captureStackTrace)Error.captureStackTrace(this,t);else{var r=new Error;if(r.stack){var n=r.stack,i=a(t),o=n.indexOf("\n"+i);if(o>=0){var s=n.indexOf("\n",o+1);n=n.substring(s+1)}this.stack=n}}},m.inherits(E.AssertionError,Error),E.fail=f,E.ok=h,E.equal=function(e,t,r){e!=t&&f(e,t,r,"==",E.equal)},E.notEqual=function(e,t,r){e==t&&f(e,t,r,"!=",E.notEqual)},E.deepEqual=function(e,t,r){p(e,t,!1)||f(e,t,r,"deepEqual",E.deepEqual)},E.deepStrictEqual=function(e,t,r){p(e,t,!0)||f(e,t,r,"deepStrictEqual",E.deepStrictEqual)},E.notDeepEqual=function(e,t,r){p(e,t,!1)&&f(e,t,r,"notDeepEqual",E.notDeepEqual)},E.notDeepStrictEqual=y,E.strictEqual=function(e,t,r){e!==t&&f(e,t,r,"===",E.strictEqual)},E.notStrictEqual=function(e,t,r){e===t&&f(e,t,r,"!==",E.notStrictEqual)},E.throws=function(e,t,r){_(!0,e,t,r)},E.doesNotThrow=function(e,t,r){_(!1,e,t,r)},E.ifError=function(e){if(e)throw e};var x=Object.keys||function(e){var t=[];for(var r in e)w.call(e,r)&&t.push(r);return t}}).call(t,r(5))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=r(64);e.exports=function(e){function Exception(e,t){n(this,Exception);var r=i(this,(Exception.__proto__||Object.getPrototypeOf(Exception)).call(this,e));return r.strMessage=e,r.nCode=t,r}return o(Exception,e),s(Exception,[{key:"code",get:function(){return this.nCode}}],[{key:"NOT_AUTHENTICATED",get:function(){return-1}},{key:"NOT_AUTHORIZED",get:function(){return-2}},{key:"REQUEST_EXPIRED",get:function(){return-3}},{key:"NETWORK_ERROR",get:function(){return-4}},{key:"PARSE_ERROR",get:function(){return-32700}},{key:"INVALID_REQUEST",get:function(){return-32600}},{key:"METHOD_NOT_FOUND",get:function(){return-32601}},{key:"INVALID_PARAMS",get:function(){return-32602}},{key:"INTERNAL_ERROR",get:function(){return-32603}}]),Exception}(a)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(2),e.exports=function(){function Utils(){n(this,Utils),Object.seal(this)}return i(Utils,null,[{key:"jsonDecodeSafe",value:function(e){try{return JSON.parse(e)}catch(t){throw new JSONRPC.Exception(t.message+"; RAW JSON string: "+JSON.stringify(e),JSONRPC.Exception.PARSE_ERROR)}}}]),Utils}()},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e.exports=function(){function ClientPluginBase(){i(this,ClientPluginBase)}return o(ClientPluginBase,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()}]),ClientPluginBase}()},function(e,t){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(e){"object"==typeof window&&(r=window)}e.exports=r},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(37),c=r(1),l=r(9),EndpointBase=function(e){function EndpointBase(e,t,r,o){n(this,EndpointBase);var a=i(this,(EndpointBase.__proto__||Object.getPrototypeOf(EndpointBase)).call(this));return c.strictEqual(void 0===e?"undefined":s(e),"string"),c.strictEqual(void 0===t?"undefined":s(t),"string"),c.strictEqual(void 0===r?"undefined":s(r),"object"),a._strName=e,a._strPath=EndpointBase.normalizePath(t),a._objReflection=r,a._classReverseCallsClient=o,a}return o(EndpointBase,e),a(EndpointBase,[{key:"path",get:function(){return this._strPath}},{key:"name",get:function(){return this._strName}},{key:"reflection",get:function(){return this._objReflection}},{key:"ReverseCallsClientClass",get:function(){return this._classReverseCallsClient}}],[{key:"normalizePath",value:function(e){var t=u.parse(e).pathname.trim();return t.length&&"/"===t.substr(-1)||(t+="/"),"/"!==t.substr(0,1)&&(t="/"+t),t}}]),EndpointBase}(l);e.exports=EndpointBase},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(2),JSONRPC.IncomingRequest=r(18),JSONRPC.Utils=r(3),JSONRPC.EndpointBase=r(6);var c=r(9),l=r(1);e.exports=function(e){function Server(){i(this,Server);var e=o(this,(Server.__proto__||Object.getPrototypeOf(Server)).call(this));return e._arrPlugins=[],e._objEndpoints={},Object.seal(e),e}return s(Server,e),u(Server,[{key:"attachToHTTPServer",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r,i){var o=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:i=!!i,l("string"==typeof r,"strRootPath must be of type string, received "+(void 0===r?"undefined":a(r))),r=JSONRPC.EndpointBase.normalizePath(r),t.on("request",function(){var e=n(regeneratorRuntime.mark(function e(t,n){var s,a;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(s=JSONRPC.EndpointBase.normalizePath(t.url),s.substr(0,r.length)===r){e.next=3;break}return e.abrupt("return");case 3:if(!t.headers["sec-websocket-version"]){e.next=10;break}if(!i){e.next=6;break}return e.abrupt("return");case 6:return console.error("Received websocket upgrade request, yet not sharing the HTTP connection with a WebSocket."),n.statusCode=403,n.end(),e.abrupt("return");case 10:return e.prev=10,e.next=13,o.processHTTPRequest(t,n);case 13:return a=e.sent,e.next=16,o.processRequest(a);case 16:a.callResult instanceof Error?("number"!=typeof n.statusCode||n.statusCode<500||n.statusCode>599)&&(n.statusCode=500):a.isNotification?n.statusCode=204:n.statusCode=n.statusCode||200,a.isNotification||(n.setHeader("Content-Type","application/json"),n.write(a.callResultSerialized)),e.next=24;break;case 20:e.prev=20,e.t0=e.catch(10),n.statusCode=500,console.error(e.t0);case 24:n.end();case 25:case"end":return e.stop()}},e,o,[[10,20]])}));return function(t,r){return e.apply(this,arguments)}}());case 4:case"end":return e.stop()}},e,this)}));return e}()},{key:"registerEndpoint",value:function(e){if(this._objEndpoints.hasOwnProperty(e.path)){if(this._objEndpoints[e.path]!==e)throw new Error("Another JSONRPC endpoint is registered at the same path: "+e.path)}else this._objEndpoints[e.path]=e}},{key:"unregisterEndpoint",value:function(e){if(this._objEndpoints.hasOwnProperty(e))return delete this._objEndpoints[e],!0}},{key:"addPlugin",value:function(e){this._arrPlugins.includes(e)||this._arrPlugins.push(e)}},{key:"removePlugin",value:function(e){this._arrPlugins.includes(e)&&this._arrPlugins.splice(this._arrPlugins.findIndex(function(t){return e===t}),1)}},{key:"processHTTPRequest",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=new JSONRPC.IncomingRequest,e.prev=1,"POST"!==r.method){e.next=9;break}return o=[],e.next=6,new Promise(function(e,i){r.on("error",i),n.on("error",i),r.on("end",function(){e(t.concat(o).toString())}),r.on("data",function(e){o.push(e)})});case 6:i.requestBody=e.sent,e.next=11;break;case 9:if("GET"===r.method){e.next=11;break}throw new Error("JSONRPC does not handle HTTP "+r.method+" requests.");case 11:if(i.httpIncomingMessage=r,i.httpServerResponse=n,i.headers=r.headers,i.remoteAddress=r.socket.remoteAddress,i.localAddress=r.socket.localAddress,s=JSONRPC.EndpointBase.normalizePath(r.url),this._objEndpoints.hasOwnProperty(s)){e.next=19;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+s+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 19:i.endpoint=this._objEndpoints[s],e.next=25;break;case 22:e.prev=22,e.t0=e.catch(1),i.callResult=e.t0;case 25:return e.abrupt("return",i);case 26:case"end":return e.stop()}},e,this,[[1,22]])}));return e}()},{key:"processRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,s,u,c,l,f,h,p,d,b,y,g,v,_,m,w,k,R,E,S,x,O,P,j,T,A,C,N,I,L,U,B,D,M,q,W,F,z,J;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,t.isMethodCalled){e.next=108;break}this.emit("beforeJSONDecode",t),r=!0,n=!1,i=void 0,e.prev=6,o=this._arrPlugins[Symbol.iterator]();case 8:if(r=(s=o.next()).done){e.next=15;break}return u=s.value,e.next=12,u.beforeJSONDecode(t);case 12:r=!0,e.next=8;break;case 15:e.next=21;break;case 17:e.prev=17,e.t0=e.catch(6),n=!0,i=e.t0;case 21:e.prev=21,e.prev=22,!r&&o.return&&o.return();case 24:if(e.prev=24,!n){e.next=27;break}throw i;case 27:return e.finish(24);case 28:return e.finish(21);case 29:t.requestObject||(t.requestObject=JSONRPC.Utils.jsonDecodeSafe(t.requestBody)),this.emit("afterJSONDecode",t),c=!0,l=!1,f=void 0,e.prev=34,h=this._arrPlugins[Symbol.iterator]();case 36:if(c=(p=h.next()).done){e.next=43;break}return d=p.value,e.next=40,d.afterJSONDecode(t);case 40:c=!0,e.next=36;break;case 43:e.next=49;break;case 45:e.prev=45,e.t1=e.catch(34),l=!0,f=e.t1;case 49:e.prev=49,e.prev=50,!c&&h.return&&h.return();case 52:if(e.prev=52,!l){e.next=55;break}throw f;case 55:return e.finish(52);case 56:return e.finish(49);case 57:if(!Array.isArray(t.requestObject)){e.next=59;break}throw new JSONRPC.Exception("Batch requests are not supported by this JSON-RPC server.",JSONRPC.Exception.INTERNAL_ERROR);case 59:if(t.requestObject.hasOwnProperty("params")){e.next=63;break}t.requestObject.params=[],e.next=69;break;case 63:if(Array.isArray(t.requestObject.params)){e.next=69;break}if("object"!==a(t.requestObject.params)){e.next=68;break}throw new JSONRPC.Exception("Named params are not supported by this server.",JSONRPC.Exception.INTERNAL_ERROR);case 68:throw new JSONRPC.Exception("The params property has invalid data type, per JSON-RPC 2.0 specification. Unexpected type: "+a(t.requestObject.params)+".",JSONRPC.Exception.INVALID_REQUEST);case 69:if(t.isAuthenticated){e.next=71;break}throw new JSONRPC.Exception("Not authenticated; calling method name: "+t.requestObject.method,JSONRPC.Exception.NOT_AUTHENTICATED);case 71:if(t.isAuthorized){e.next=73;break}throw new JSONRPC.Exception("Not authorized; calling method name: "+t.requestObject.method,JSONRPC.Exception.NOT_AUTHORIZED);case 73:t.isMethodCalled||this.emit("callFunction",t),b=!0,y=!1,g=void 0,e.prev=77,v=this._arrPlugins[Symbol.iterator]();case 79:if(b=(_=v.next()).done){e.next=88;break}if(m=_.value,!t.isMethodCalled){e.next=83;break}return e.abrupt("break",88);case 83:return e.next=85,m.callFunction(t);case 85:b=!0,e.next=79;break;case 88:e.next=94;break;case 90:e.prev=90,e.t2=e.catch(77),y=!0,g=e.t2;case 94:e.prev=94,e.prev=95,!b&&v.return&&v.return();case 97:if(e.prev=97,!y){e.next=100;break}throw g;case 100:return e.finish(97);case 101:return e.finish(94);case 102:if(t.isMethodCalled){e.next=108;break}if("function"==typeof t.endpoint[t.requestObject.method]){e.next=105;break}throw new JSONRPC.Exception("Method "+JSON.stringify(t.requestObject.method)+" not found on endpoint "+JSON.stringify(t.endpoint.path)+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 105:return e.next=107,t.endpoint[t.requestObject.method].apply(t.endpoint,[t].concat(t.requestObject.params));case 107:t.callResult=e.sent;case 108:e.next=113;break;case 110:e.prev=110,e.t3=e.catch(0),t.callResult=e.t3;case 113:if(!(t.callResult instanceof Error)){e.next=143;break}this.emit("exceptionCatch",t),w=!0,k=!1,R=void 0,e.prev=118,E=this._arrPlugins[Symbol.iterator]();case 120:if(w=(S=E.next()).done){e.next=127;break}return x=S.value,e.next=124,x.exceptionCatch(t);case 124:w=!0,e.next=120;break;case 127:e.next=133;break;case 129:e.prev=129,e.t4=e.catch(118),k=!0,R=e.t4;case 133:e.prev=133,e.prev=134,!w&&E.return&&E.return();case 136:if(e.prev=136,!k){e.next=139;break}throw R;case 139:return e.finish(136);case 140:return e.finish(133);case 141:e.next=170;break;case 143:this.emit("result",t),O=!0,P=!1,j=void 0,e.prev=147,T=this._arrPlugins[Symbol.iterator]();case 149:if(O=(A=T.next()).done){e.next=156;break}return C=A.value,e.next=153,C.result(t);case 153:O=!0,e.next=149;break;case 156:e.next=162;break;case 158:e.prev=158,e.t5=e.catch(147),P=!0,j=e.t5;case 162:e.prev=162,e.prev=163,!O&&T.return&&T.return();case 165:if(e.prev=165,!P){e.next=168;break}throw j;case 168:return e.finish(165);case 169:return e.finish(162);case 170:t.callResultToBeSerialized=t.toResponseObject(),this.emit("response",t),N=!0,I=!1,L=void 0,e.prev=175,U=this._arrPlugins[Symbol.iterator]();case 177:if(N=(B=U.next()).done){e.next=184;break}return D=B.value,e.next=181,D.response(t);case 181:N=!0,e.next=177;break;case 184:e.next=190;break;case 186:e.prev=186,e.t6=e.catch(175),I=!0,L=e.t6;case 190:e.prev=190,e.prev=191,!N&&U.return&&U.return();case 193:if(e.prev=193,!I){e.next=196;break}throw L;case 196:return e.finish(193);case 197:return e.finish(190);case 198:null===t.callResultSerialized&&(t.callResultSerialized=JSON.stringify(t.callResultToBeSerialized,void 0,"\t")),this.emit("afterSerialize",t),M=!0,q=!1,W=void 0,e.prev=203,F=this._arrPlugins[Symbol.iterator]();case 205:if(M=(z=F.next()).done){e.next=212;break}return J=z.value,e.next=209,J.afterSerialize(t);case 209:M=!0,e.next=205;break;case 212:e.next=218;break;case 214:e.prev=214,e.t7=e.catch(203),q=!0,W=e.t7;case 218:e.prev=218,e.prev=219,!M&&F.return&&F.return();case 221:if(e.prev=221,!q){e.next=224;break}throw W;case 224:return e.finish(221);case 225:return e.finish(218);case 226:case"end":return e.stop()}},e,this,[[0,110],[6,17,21,29],[22,,24,28],[34,45,49,57],[50,,52,56],[77,90,94,102],[95,,97,101],[118,129,133,141],[134,,136,140],[147,158,162,170],[163,,165,169],[175,186,190,198],[191,,193,197],[203,214,218,226],[219,,221,225]])}));return e}()},{key:"endpoints",get:function(){return this._objEndpoints}}]),Server}(c)}).call(t,r(8).Buffer)},function(e,t,r){"use strict";(function(e){function n(){return o.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function i(e,t){if(n()<t)throw new RangeError("Invalid typed array length");return o.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t),e.__proto__=o.prototype):(null===e&&(e=new o(t)),e.length=t),e}function o(e,t,r){if(!(o.TYPED_ARRAY_SUPPORT||this instanceof o))return new o(e,t,r);if("number"==typeof e){if("string"==typeof t)throw new Error("If encoding is specified then the first argument must be a string");return c(this,e)}return s(this,e,t,r)}function s(e,t,r,n){if("number"==typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&t instanceof ArrayBuffer?h(e,t,r,n):"string"==typeof t?l(e,t,r):p(e,t)}function a(e){if("number"!=typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function u(e,t,r,n){return a(t),t<=0?i(e,t):void 0!==r?"string"==typeof n?i(e,t).fill(r,n):i(e,t).fill(r):i(e,t)}function c(e,t){if(a(t),e=i(e,t<0?0:0|d(t)),!o.TYPED_ARRAY_SUPPORT)for(var r=0;r<t;++r)e[r]=0;return e}function l(e,t,r){if("string"==typeof r&&""!==r||(r="utf8"),!o.isEncoding(r))throw new TypeError('"encoding" must be a valid string encoding');var n=0|y(t,r);e=i(e,n);var s=e.write(t,r);return s!==n&&(e=e.slice(0,s)),e}function f(e,t){var r=t.length<0?0:0|d(t.length);e=i(e,r);for(var n=0;n<r;n+=1)e[n]=255&t[n];return e}function h(e,t,r,n){if(t.byteLength,r<0||t.byteLength<r)throw new RangeError("'offset' is out of bounds");if(t.byteLength<r+(n||0))throw new RangeError("'length' is out of bounds");return t=void 0===r&&void 0===n?new Uint8Array(t):void 0===n?new Uint8Array(t,r):new Uint8Array(t,r,n),o.TYPED_ARRAY_SUPPORT?(e=t,e.__proto__=o.prototype):e=f(e,t),e}function p(e,t){if(o.isBuffer(t)){var r=0|d(t.length);return e=i(e,r),0===e.length?e:(t.copy(e,0,0,r),e)}if(t){if("undefined"!=typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!=typeof t.length||X(t.length)?i(e,0):f(e,t);if("Buffer"===t.type&&Q(t.data))return f(e,t.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function d(e){if(e>=n())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+n().toString(16)+" bytes");return 0|e}function b(e){return+e!=e&&(e=0),o.alloc(+e)}function y(e,t){if(o.isBuffer(e))return e.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!=typeof e&&(e=""+e);var r=e.length;if(0===r)return 0;for(var n=!1;;)switch(t){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":case void 0:return J(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*r;case"hex":return r>>>1;case"base64":return Y(e).length;default:if(n)return J(e).length;t=(""+t).toLowerCase(),n=!0}}function g(e,t,r){var n=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===r||r>this.length)&&(r=this.length),r<=0)return"";if(r>>>=0,t>>>=0,r<=t)return"";for(e||(e="utf8");;)switch(e){case"hex":return C(this,t,r);case"utf8":case"utf-8":return P(this,t,r);case"ascii":return T(this,t,r);case"latin1":case"binary":return A(this,t,r);case"base64":return O(this,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,t,r);default:if(n)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),n=!0}}function v(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function _(e,t,r,n,i){if(0===e.length)return-1;if("string"==typeof r?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,isNaN(r)&&(r=i?0:e.length-1),r<0&&(r=e.length+r),r>=e.length){if(i)return-1;r=e.length-1}else if(r<0){if(!i)return-1;r=0}if("string"==typeof t&&(t=o.from(t,n)),o.isBuffer(t))return 0===t.length?-1:m(e,t,r,n,i);if("number"==typeof t)return t&=255,o.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,r):Uint8Array.prototype.lastIndexOf.call(e,t,r):m(e,[t],r,n,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,r,n,i){function o(e,t){return 1===s?e[t]:e.readUInt16BE(t*s)}var s=1,a=e.length,u=t.length;if(void 0!==n&&("ucs2"===(n=String(n).toLowerCase())||"ucs-2"===n||"utf16le"===n||"utf-16le"===n)){if(e.length<2||t.length<2)return-1;s=2,a/=2,u/=2,r/=2}var c;if(i){var l=-1;for(c=r;c<a;c++)if(o(e,c)===o(t,-1===l?0:c-l)){if(-1===l&&(l=c),c-l+1===u)return l*s}else-1!==l&&(c-=c-l),l=-1}else for(r+u>a&&(r=a-u),c=r;c>=0;c--){for(var f=!0,h=0;h<u;h++)if(o(e,c+h)!==o(t,h)){f=!1;break}if(f)return c}return-1}function w(e,t,r,n){r=Number(r)||0;var i=e.length-r;n?(n=Number(n))>i&&(n=i):n=i;var o=t.length;if(o%2!=0)throw new TypeError("Invalid hex string");n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(t.substr(2*s,2),16);if(isNaN(a))return s;e[r+s]=a}return s}function k(e,t,r,n){return K(J(t,e.length-r),e,r,n)}function R(e,t,r,n){return K(H(t),e,r,n)}function E(e,t,r,n){return R(e,t,r,n)}function S(e,t,r,n){return K(Y(t),e,r,n)}function x(e,t,r,n){return K(Z(t,e.length-r),e,r,n)}function O(e,t,r){return 0===t&&r===e.length?V.fromByteArray(e):V.fromByteArray(e.slice(t,r))}function P(e,t,r){r=Math.min(e.length,r);for(var n=[],i=t;i<r;){var o=e[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var u,c,l,f;switch(a){case 1:o<128&&(s=o);break;case 2:u=e[i+1],128==(192&u)&&(f=(31&o)<<6|63&u)>127&&(s=f);break;case 3:u=e[i+1],c=e[i+2],128==(192&u)&&128==(192&c)&&(f=(15&o)<<12|(63&u)<<6|63&c)>2047&&(f<55296||f>57343)&&(s=f);break;case 4:u=e[i+1],c=e[i+2],l=e[i+3],128==(192&u)&&128==(192&c)&&128==(192&l)&&(f=(15&o)<<18|(63&u)<<12|(63&c)<<6|63&l)>65535&&f<1114112&&(s=f)}}null===s?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|1023&s),n.push(s),i+=a}return j(n)}function j(e){var t=e.length;if(t<=$)return String.fromCharCode.apply(String,e);for(var r="",n=0;n<t;)r+=String.fromCharCode.apply(String,e.slice(n,n+=$));return r}function T(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(127&e[i]);return n}function A(e,t,r){var n="";r=Math.min(e.length,r);for(var i=t;i<r;++i)n+=String.fromCharCode(e[i]);return n}function C(e,t,r){var n=e.length;(!t||t<0)&&(t=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=t;o<r;++o)i+=z(e[o]);return i}function N(e,t,r){for(var n=e.slice(t,r),i="",o=0;o<n.length;o+=2)i+=String.fromCharCode(n[o]+256*n[o+1]);return i}function I(e,t,r){if(e%1!=0||e<0)throw new RangeError("offset is not uint");if(e+t>r)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,r,n,i,s){if(!o.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(r+n>e.length)throw new RangeError("Index out of range")}function U(e,t,r,n){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-r,2);i<o;++i)e[r+i]=(t&255<<8*(n?i:1-i))>>>8*(n?i:1-i)}function B(e,t,r,n){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-r,4);i<o;++i)e[r+i]=t>>>8*(n?i:3-i)&255}function D(e,t,r,n,i,o){if(r+n>e.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function M(e,t,r,n,i){return i||D(e,t,r,4,3.4028234663852886e38,-3.4028234663852886e38),G.write(e,t,r,n,23,4),r+4}function q(e,t,r,n,i){return i||D(e,t,r,8,1.7976931348623157e308,-1.7976931348623157e308),G.write(e,t,r,n,52,8),r+8}function W(e){if(e=F(e).replace(ee,""),e.length<2)return"";for(;e.length%4!=0;)e+="=";return e}function F(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}function z(e){return e<16?"0"+e.toString(16):e.toString(16)}function J(e,t){t=t||1/0;for(var r,n=e.length,i=null,o=[],s=0;s<n;++s){if((r=e.charCodeAt(s))>55295&&r<57344){if(!i){if(r>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(s+1===n){(t-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(t-=3)>-1&&o.push(239,191,189),i=r;continue}r=65536+(i-55296<<10|r-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((t-=1)<0)break;o.push(r)}else if(r<2048){if((t-=2)<0)break;o.push(r>>6|192,63&r|128)}else if(r<65536){if((t-=3)<0)break;o.push(r>>12|224,r>>6&63|128,63&r|128)}else{if(!(r<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,63&r|128)}}return o}function H(e){for(var t=[],r=0;r<e.length;++r)t.push(255&e.charCodeAt(r));return t}function Z(e,t){for(var r,n,i,o=[],s=0;s<e.length&&!((t-=2)<0);++s)r=e.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function Y(e){return V.toByteArray(W(e))}function K(e,t,r,n){for(var i=0;i<n&&!(i+r>=t.length||i>=e.length);++i)t[i+r]=e[i];return i}function X(e){return e!==e}var V=r(61),G=r(65),Q=r(29);t.Buffer=o,t.SlowBuffer=b,t.INSPECT_MAX_BYTES=50,o.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"==typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(e){return!1}}(),t.kMaxLength=n(),o.poolSize=8192,o._augment=function(e){return e.__proto__=o.prototype,e},o.from=function(e,t,r){return s(null,e,t,r)},o.TYPED_ARRAY_SUPPORT&&(o.prototype.__proto__=Uint8Array.prototype,o.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&o[Symbol.species]===o&&Object.defineProperty(o,Symbol.species,{value:null,configurable:!0})),o.alloc=function(e,t,r){return u(null,e,t,r)},o.allocUnsafe=function(e){return c(null,e)},o.allocUnsafeSlow=function(e){return c(null,e)},o.isBuffer=function(e){return!(null==e||!e._isBuffer)},o.compare=function(e,t){if(!o.isBuffer(e)||!o.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var r=e.length,n=t.length,i=0,s=Math.min(r,n);i<s;++i)if(e[i]!==t[i]){r=e[i],n=t[i];break}return r<n?-1:n<r?1:0},o.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},o.concat=function(e,t){if(!Q(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return o.alloc(0);var r;if(void 0===t)for(t=0,r=0;r<e.length;++r)t+=e[r].length;var n=o.allocUnsafe(t),i=0;for(r=0;r<e.length;++r){var s=e[r];if(!o.isBuffer(s))throw new TypeError('"list" argument must be an Array of Buffers');s.copy(n,i),i+=s.length}return n},o.byteLength=y,o.prototype._isBuffer=!0,o.prototype.swap16=function(){var e=this.length;if(e%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},o.prototype.swap32=function(){var e=this.length;if(e%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},o.prototype.swap64=function(){var e=this.length;if(e%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},o.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?P(this,0,e):g.apply(this,arguments)},o.prototype.equals=function(e){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===o.compare(this,e)},o.prototype.inspect=function(){var e="",r=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,r).match(/.{2}/g).join(" "),this.length>r&&(e+=" ... ")),"<Buffer "+e+">"},o.prototype.compare=function(e,t,r,n,i){if(!o.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===r&&(r=e?e.length:0),void 0===n&&(n=0),void 0===i&&(i=this.length),t<0||r>e.length||n<0||i>this.length)throw new RangeError("out of range index");if(n>=i&&t>=r)return 0;if(n>=i)return-1;if(t>=r)return 1;if(t>>>=0,r>>>=0,n>>>=0,i>>>=0,this===e)return 0;for(var s=i-n,a=r-t,u=Math.min(s,a),c=this.slice(n,i),l=e.slice(t,r),f=0;f<u;++f)if(c[f]!==l[f]){s=c[f],a=l[f];break}return s<a?-1:a<s?1:0},o.prototype.includes=function(e,t,r){return-1!==this.indexOf(e,t,r)},o.prototype.indexOf=function(e,t,r){return _(this,e,t,r,!0)},o.prototype.lastIndexOf=function(e,t,r){return _(this,e,t,r,!1)},o.prototype.write=function(e,t,r,n){if(void 0===t)n="utf8",r=this.length,t=0;else if(void 0===r&&"string"==typeof t)n=t,r=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(r)?(r|=0,void 0===n&&(n="utf8")):(n=r,r=void 0)}var i=this.length-t;if((void 0===r||r>i)&&(r=i),e.length>0&&(r<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");n||(n="utf8");for(var o=!1;;)switch(n){case"hex":return w(this,e,t,r);case"utf8":case"utf-8":return k(this,e,t,r);case"ascii":return R(this,e,t,r);case"latin1":case"binary":return E(this,e,t,r);case"base64":return S(this,e,t,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return x(this,e,t,r);default:if(o)throw new TypeError("Unknown encoding: "+n);n=(""+n).toLowerCase(),o=!0}},o.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var $=4096;o.prototype.slice=function(e,t){var r=this.length;e=~~e,t=void 0===t?r:~~t,e<0?(e+=r)<0&&(e=0):e>r&&(e=r),t<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e);var n;if(o.TYPED_ARRAY_SUPPORT)n=this.subarray(e,t),n.__proto__=o.prototype;else{var i=t-e;n=new o(i,void 0);for(var s=0;s<i;++s)n[s]=this[s+e]}return n},o.prototype.readUIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return n},o.prototype.readUIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e+--t],i=1;t>0&&(i*=256);)n+=this[e+--t]*i;return n},o.prototype.readUInt8=function(e,t){return t||I(e,1,this.length),this[e]},o.prototype.readUInt16LE=function(e,t){return t||I(e,2,this.length),this[e]|this[e+1]<<8},o.prototype.readUInt16BE=function(e,t){return t||I(e,2,this.length),this[e]<<8|this[e+1]},o.prototype.readUInt32LE=function(e,t){return t||I(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},o.prototype.readUInt32BE=function(e,t){return t||I(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},o.prototype.readIntLE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=this[e],i=1,o=0;++o<t&&(i*=256);)n+=this[e+o]*i;return i*=128,n>=i&&(n-=Math.pow(2,8*t)),n},o.prototype.readIntBE=function(e,t,r){e|=0,t|=0,r||I(e,t,this.length);for(var n=t,i=1,o=this[e+--n];n>0&&(i*=256);)o+=this[e+--n]*i;return i*=128,o>=i&&(o-=Math.pow(2,8*t)),o},o.prototype.readInt8=function(e,t){return t||I(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},o.prototype.readInt16LE=function(e,t){t||I(e,2,this.length);var r=this[e]|this[e+1]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt16BE=function(e,t){t||I(e,2,this.length);var r=this[e+1]|this[e]<<8;return 32768&r?4294901760|r:r},o.prototype.readInt32LE=function(e,t){return t||I(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},o.prototype.readInt32BE=function(e,t){return t||I(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},o.prototype.readFloatLE=function(e,t){return t||I(e,4,this.length),G.read(this,e,!0,23,4)},o.prototype.readFloatBE=function(e,t){return t||I(e,4,this.length),G.read(this,e,!1,23,4)},o.prototype.readDoubleLE=function(e,t){return t||I(e,8,this.length),G.read(this,e,!0,52,8)},o.prototype.readDoubleBE=function(e,t){return t||I(e,8,this.length),G.read(this,e,!1,52,8)},o.prototype.writeUIntLE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){L(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=1,o=0;for(this[t]=255&e;++o<r&&(i*=256);)this[t+o]=e/i&255;return t+r},o.prototype.writeUIntBE=function(e,t,r,n){if(e=+e,t|=0,r|=0,!n){L(this,e,t,r,Math.pow(2,8*r)-1,0)}var i=r-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+r},o.prototype.writeUInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,255,0),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},o.prototype.writeUInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeUInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,65535,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeUInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):B(this,e,t,!0),t+4},o.prototype.writeUInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,4294967295,0),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},o.prototype.writeIntLE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=0,s=1,a=0;for(this[t]=255&e;++o<r&&(s*=256);)e<0&&0===a&&0!==this[t+o-1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeIntBE=function(e,t,r,n){if(e=+e,t|=0,!n){var i=Math.pow(2,8*r-1);L(this,e,t,r,i-1,-i)}var o=r-1,s=1,a=0;for(this[t+o]=255&e;--o>=0&&(s*=256);)e<0&&0===a&&0!==this[t+o+1]&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+r},o.prototype.writeInt8=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,1,127,-128),o.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},o.prototype.writeInt16LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):U(this,e,t,!0),t+2},o.prototype.writeInt16BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,2,32767,-32768),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):U(this,e,t,!1),t+2},o.prototype.writeInt32LE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),o.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):B(this,e,t,!0),t+4},o.prototype.writeInt32BE=function(e,t,r){return e=+e,t|=0,r||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),o.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):B(this,e,t,!1),t+4},o.prototype.writeFloatLE=function(e,t,r){return M(this,e,t,!0,r)},o.prototype.writeFloatBE=function(e,t,r){return M(this,e,t,!1,r)},o.prototype.writeDoubleLE=function(e,t,r){return q(this,e,t,!0,r)},o.prototype.writeDoubleBE=function(e,t,r){return q(this,e,t,!1,r)},o.prototype.copy=function(e,t,r,n){if(r||(r=0),n||0===n||(n=this.length),t>=e.length&&(t=e.length),t||(t=0),n>0&&n<r&&(n=r),n===r)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(r<0||r>=this.length)throw new RangeError("sourceStart out of bounds");if(n<0)throw new RangeError("sourceEnd out of bounds");n>this.length&&(n=this.length),e.length-t<n-r&&(n=e.length-t+r);var i,s=n-r;if(this===e&&r<t&&t<n)for(i=s-1;i>=0;--i)e[i+t]=this[i+r];else if(s<1e3||!o.TYPED_ARRAY_SUPPORT)for(i=0;i<s;++i)e[i+t]=this[i+r];else Uint8Array.prototype.set.call(e,this.subarray(r,r+s),t);return s},o.prototype.fill=function(e,t,r,n){if("string"==typeof e){if("string"==typeof t?(n=t,t=0,r=this.length):"string"==typeof r&&(n=r,r=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==n&&"string"!=typeof n)throw new TypeError("encoding must be a string");if("string"==typeof n&&!o.isEncoding(n))throw new TypeError("Unknown encoding: "+n)}else"number"==typeof e&&(e&=255);if(t<0||this.length<t||this.length<r)throw new RangeError("Out of range index");if(r<=t)return this;t>>>=0,r=void 0===r?this.length:r>>>0,e||(e=0);var s;if("number"==typeof e)for(s=t;s<r;++s)this[s]=e;else{var a=o.isBuffer(e)?e:J(new o(e,n).toString()),u=a.length;for(s=0;s<r-t;++s)this[s+t]=a[s%u]}return this};var ee=/[^+\/0-9A-Za-z-_]/g}).call(t,r(5))},function(e,t){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function n(e){return"function"==typeof e}function i(e){return"number"==typeof e}function o(e){return"object"==typeof e&&null!==e}function s(e){return void 0===e}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(e){if(!i(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},r.prototype.emit=function(e){var t,r,i,a,u,c;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(r=this._events[e],s(r))return!1;if(n(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:a=Array.prototype.slice.call(arguments,1),r.apply(this,a)}else if(o(r))for(a=Array.prototype.slice.call(arguments,1),c=r.slice(),i=c.length,u=0;u<i;u++)c[u].apply(this,a);return!0},r.prototype.addListener=function(e,t){var i;if(!n(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,n(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(i=s(this._maxListeners)?r.defaultMaxListeners:this._maxListeners)&&i>0&&this._events[e].length>i&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(e,t){function r(){this.removeListener(e,r),i||(i=!0,t.apply(this,arguments))}if(!n(t))throw TypeError("listener must be a function");var i=!1;return r.listener=t,this.on(e,r),this},r.prototype.removeListener=function(e,t){var r,i,s,a;if(!n(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(r=this._events[e],s=r.length,i=-1,r===t||n(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(r)){for(a=s;a-- >0;)if(r[a]===t||r[a].listener&&r[a].listener===t){i=a;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},r.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r=this._events[e],n(r))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},r.prototype.listeners=function(e){return this._events&&this._events[e]?n(this._events[e])?[this._events[e]]:this._events[e].slice():[]},r.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(n(t))return 1;if(t)return t.length}return 0},r.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t,r){"use strict";var n={};n.Cache=r(48),n.DebugLogger=r(49),n.PrettyBrowserConsoleErrors=r(50),n.SignatureAdd=r(52),n.WebSocketTransport=r(54),n.WorkerTransport=r(55),n.ProcessStdIOTransport=r(51),n.WebRTCTransport=r(53),e.exports=n},function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);c.call(this,e),l.call(this,e),e&&!1===e.readable&&(this.readable=!1),e&&!1===e.writable&&(this.writable=!1),this.allowHalfOpen=!0,e&&!1===e.allowHalfOpen&&(this.allowHalfOpen=!1),this.once("end",i)}function i(){this.allowHalfOpen||this._writableState.ended||s(o,this)}function o(e){e.end()}var s=r(21),a=Object.keys||function(e){var t=[];for(var r in e)t.push(r);return t};e.exports=n;var u=r(16);u.inherits=r(13);var c=r(32),l=r(27);u.inherits(n,c);for(var f=a(l.prototype),h=0;h<f.length;h++){var p=f[h];n.prototype[p]||(n.prototype[p]=l.prototype[p])}Object.defineProperty(n.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed&&this._writableState.destroyed)},set:function(e){void 0!==this._readableState&&void 0!==this._writableState&&(this._readableState.destroyed=e,this._writableState.destroyed=e)}}),n.prototype._destroy=function(e,t){this.push(null),this.end(),s(t,e)}},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.Exception=r(2),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(10),JSONRPC.Utils=r(3),JSONRPC.OutgoingRequest=r(47);var u=r(9),c=r(94),l=r(1);e.exports=function(e){function Client(e,t){i(this,Client);var r=o(this,(Client.__proto__||Object.getPrototypeOf(Client)).call(this));return r._arrPlugins=[],r._strJSONRPCEndpointURL=e,r._nCallID=1,r._strHTTPUser=null,r._strHTTPPassword=null,r._strBase64BasicAuthentication=null,r._objFetchOptions=t,r}return s(Client,e),a(Client,[{key:"setHTTPCredentials",value:function(e,r){this._strHTTPUser=e,this._strHTTPPassword=r,this._strBase64BasicAuthentication=new t(e+":"+r).toString("base64")}},{key:"rpc",value:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r){var n,i,o,s,a,u,f,h,p,d,b,y,g,v,_,m,w,k,R,E,S,x,O,P,j,T,A,C,N,I,L,U,B,D,M,q,W,F,z,J,H=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l("boolean"==typeof H,"bNotification must be of type boolean."),l(Array.isArray(r),"arrParams must be an Array."),n=new JSONRPC.OutgoingRequest(t,r,H?void 0:this._nCallID),this._nCallID++,e.prev=4,n.endpointURL=this.endpointURL,n.headers["Content-Type"]="application/json",null!==this.httpUser&&null!==this.httpPassword&&(n.headers.Authorization="Basic "+this._strBase64BasicAuthentication),n.requestObject=n.toRequestObject(),this.emit("beforeJSONEncode",n),i=!0,o=!1,s=void 0,e.prev=13,a=this._arrPlugins[Symbol.iterator]();case 15:if(i=(u=a.next()).done){e.next=22;break}return f=u.value,e.next=19,f.beforeJSONEncode(n);case 19:i=!0,e.next=15;break;case 22:e.next=28;break;case 24:e.prev=24,e.t0=e.catch(13),o=!0,s=e.t0;case 28:e.prev=28,e.prev=29,!i&&a.return&&a.return();case 31:if(e.prev=31,!o){e.next=34;break}throw s;case 34:return e.finish(31);case 35:return e.finish(28);case 36:null===n.requestBody&&(n.requestBody=JSON.stringify(n.requestObject,null,"\t")),this.emit("afterJSONEncode",n),h=!0,p=!1,d=void 0,e.prev=41,b=this._arrPlugins[Symbol.iterator]();case 43:if(h=(y=b.next()).done){e.next=50;break}return g=y.value,e.next=47,g.afterJSONEncode(n);case 47:h=!0,e.next=43;break;case 50:e.next=56;break;case 52:e.prev=52,e.t1=e.catch(41),p=!0,d=e.t1;case 56:e.prev=56,e.prev=57,!h&&b.return&&b.return();case 59:if(e.prev=59,!p){e.next=62;break}throw d;case 62:return e.finish(59);case 63:return e.finish(56);case 64:n.isMethodCalled||this.emit("makeRequest",n),v=!0,_=!1,m=void 0,e.prev=68,w=this._arrPlugins[Symbol.iterator]();case 70:if(v=(k=w.next()).done){e.next=79;break}if(R=k.value,!n.isMethodCalled){e.next=74;break}return e.abrupt("break",79);case 74:return e.next=76,R.makeRequest(n);case 76:v=!0,e.next=70;break;case 79:e.next=85;break;case 81:e.prev=81,e.t2=e.catch(68),_=!0,m=e.t2;case 85:e.prev=85,e.prev=86,!v&&w.return&&w.return();case 88:if(e.prev=88,!_){e.next=91;break}throw m;case 91:return e.finish(88);case 92:return e.finish(85);case 93:if(E=null,S=!1,n.isMethodCalled){e.next=109;break}return x=new(c.Request?c.Request:Request)(n.endpointURL,{method:"POST",mode:"cors",headers:new(c.Headers?c.Headers:Headers)(n.headers),body:n.requestBody,cache:"no-cache",credentials:"include"}),e.next=99,c(x,this._objFetchOptions);case 99:if(E=e.sent,S=!E.ok,E.ok||0!==parseInt(E.status,10)){e.next=106;break}n.responseObject={jsonrpc:Client.JSONRPC_VERSION,error:{code:JSONRPC.Exception.NETWORK_ERROR,message:"Network error. The internet connection may have failed."},id:n.callID},n.responseBody=JSON.stringify(n.responseObject,void 0,"\t"),e.next=109;break;case 106:return e.next=108,E.text();case 108:n.responseBody=e.sent;case 109:H&&(n.responseObject={jsonrpc:Client.JSONRPC_VERSION,result:null},n.responseBody=JSON.stringify(n.responseObject,void 0,"\t")),this.emit("beforeJSONDecode",n),O=!0,P=!1,j=void 0,e.prev=114,T=this._arrPlugins[Symbol.iterator]();case 116:if(O=(A=T.next()).done){e.next=123;break}return C=A.value,e.next=120,C.beforeJSONDecode(n);case 120:O=!0,e.next=116;break;case 123:e.next=129;break;case 125:e.prev=125,e.t3=e.catch(114),P=!0,j=e.t3;case 129:e.prev=129,e.prev=130,!O&&T.return&&T.return();case 132:if(e.prev=132,!P){e.next=135;break}throw j;case 135:return e.finish(132);case 136:return e.finish(129);case 137:null!==n.responseObject&&void 0!==n.responseObject||(n.responseObject=JSONRPC.Utils.jsonDecodeSafe(n.responseBody)),this.emit("afterJSONDecode",n),N=!0,I=!1,L=void 0,e.prev=142,U=this._arrPlugins[Symbol.iterator]();case 144:if(N=(B=U.next()).done){e.next=151;break}return D=B.value,e.next=148,D.afterJSONDecode(n);case 148:N=!0,e.next=144;break;case 151:e.next=157;break;case 153:e.prev=153,e.t4=e.catch(142),I=!0,L=e.t4;case 157:e.prev=157,e.prev=158,!N&&U.return&&U.return();case 160:if(e.prev=160,!I){e.next=163;break}throw L;case 163:return e.finish(160);case 164:return e.finish(157);case 165:n.responseObject.hasOwnProperty("error")?n.responseObject.error.hasOwnProperty("message")&&"string"==typeof n.responseObject.error.message&&n.responseObject.error.hasOwnProperty("code")&&"number"==typeof n.responseObject.error.code?n.callResult=new JSONRPC.Exception(n.responseObject.error.message,n.responseObject.error.code):n.callResult=new JSONRPC.Exception("Invalid error object on JSONRPC protocol response. Response: "+JSON.stringify(n.responseObject),JSONRPC.Exception.INTERNAL_ERROR):n.responseObject.hasOwnProperty("result")?n.callResult=n.responseObject.result:S=!0,!S||n.callResult instanceof Error||(n.callResult=new JSONRPC.Exception("Invalid error object on JSONRPC protocol response. Response object: "+JSON.stringify(n.responseObject)+". HTTP response class instance: "+JSON.stringify(E)+".",JSONRPC.Exception.INTERNAL_ERROR)),e.next=172;break;case 169:e.prev=169,e.t5=e.catch(4),n.callResult=e.t5;case 172:if(!(n.callResult instanceof Error)){e.next=201;break}this.emit("exceptionCatch",n),M=!0,q=!1,W=void 0,e.prev=177,F=this._arrPlugins[Symbol.iterator]();case 179:if(M=(z=F.next()).done){e.next=186;break}return J=z.value,e.next=183,J.exceptionCatch(n);case 183:M=!0,e.next=179;break;case 186:e.next=192;break;case 188:e.prev=188,e.t6=e.catch(177),q=!0,W=e.t6;case 192:e.prev=192,e.prev=193,!M&&F.return&&F.return();case 195:if(e.prev=195,!q){e.next=198;break}throw W;case 198:return e.finish(195);case 199:return e.finish(192);case 200:throw n.callResult;case 201:return e.abrupt("return",n.callResult);case 202:case"end":return e.stop()}},e,this,[[4,169],[13,24,28,36],[29,,31,35],[41,52,56,64],[57,,59,63],[68,81,85,93],[86,,88,92],[114,125,129,137],[130,,132,136],[142,153,157,165],[158,,160,164],[177,188,192,200],[193,,195,199]])}));return e}()},{key:"addPlugin",value:function(e){this._arrPlugins.includes(e)||this._arrPlugins.push(e)}},{key:"removePlugin",value:function(e){this._arrPlugins.includes(e)&&this._arrPlugins.splice(this._arrPlugins.findIndex(function(t){return e===t}),1)}},{key:"rpcFunctions",value:function(){return this.rpc("rpc.functions",[].slice.call(arguments))}},{key:"rpcReflectionFunction",value:function(e){return this.rpc("rpc.reflectionFunction",[e])}},{key:"rpcReflectionFunctions",value:function(e){return this.rpc("rpc.reflectionFunctions",[e])}},{key:"rpcAllowedCrossSiteXHRSubdomains",value:function(){return this.rpc("rpc.allowedCrossSiteXHRSubdomains",[])}},{key:"enableLogging",value:function(){this._consoleLoggerPlugin||(this._consoleLoggerPlugin=new JSONRPC.Plugins.Client.DebugLogger),this.addPlugin(this._consoleLoggerPlugin)}},{key:"disableLogging",value:function(){this._consoleLoggerPlugin&&this.removePlugin(this._consoleLoggerPlugin)}},{key:"endpointURL",get:function(){return this._strJSONRPCEndpointURL}},{key:"plugins",get:function(){return this._arrPlugins}},{key:"callID",get:function(){return this._nCallID}},{key:"httpUser",get:function(){return this._strHTTPUser}},{key:"httpPassword",get:function(){return this._strHTTPPassword}}],[{key:"JSONRPC_VERSION",get:function(){return"2.0"}}]),Client}(u)}).call(t,r(8).Buffer)},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(1),JSONRPC=r(17);JSONRPC.Server=r(7);var c=r(9);e.exports=function(e){function RouterBase(e){n(this,RouterBase);var t=i(this,(RouterBase.__proto__||Object.getPrototypeOf(RouterBase)).call(this));return u(null===e||e instanceof JSONRPC.Server,"jsonrpcServer must be either null or an instance or subclass of JSONRPC.Server."),t._jsonrpcServer=e,t._nConnectionIDCounter=0,t._objSessions={},t}return o(RouterBase,e),a(RouterBase,[{key:"connectionIDToSingletonClient",value:function(e,t){if(u("number"==typeof e,"nConnectionID must be a number. Received this: "+JSON.stringify(e)),u("function"==typeof t,"Invalid ClientClass value: "+(void 0===t?"undefined":s(t))),!this._objSessions.hasOwnProperty(e))throw new Error("Connection "+JSON.stringify(e)+" not found in router.");return null===this._objSessions[e].clientReverseCalls?this._objSessions[e].clientReverseCalls=this._makeReverseCallsClient(t,this._objSessions[e]):u(this._objSessions[e].clientReverseCalls instanceof t,"clientReverseCalls already initialized with a different JSONRPC.Client subclass."),this._objSessions[e].clientReverseCalls}},{key:"onConnectionEnded",value:function(e){delete this._objSessions[e]}},{key:"_makeReverseCallsClient",value:function(e,t){throw new Error("Must implement.")}}]),RouterBase}(c)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();e.exports=function(){function ServerPluginBase(){i(this,ServerPluginBase)}return o(ServerPluginBase,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"callFunction",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"result",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"response",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterSerialize",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()}]),ServerPluginBase}()},function(e,t,r){(function(e){function r(e){return Array.isArray?Array.isArray(e):"[object Array]"===y(e)}function n(e){return"boolean"==typeof e}function i(e){return null===e}function o(e){return null==e}function s(e){return"number"==typeof e}function a(e){return"string"==typeof e}function u(e){return"symbol"==typeof e}function c(e){return void 0===e}function l(e){return"[object RegExp]"===y(e)}function f(e){return"object"==typeof e&&null!==e}function h(e){return"[object Date]"===y(e)}function p(e){return"[object Error]"===y(e)||e instanceof Error}function d(e){return"function"==typeof e}function b(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function y(e){return Object.prototype.toString.call(e)}t.isArray=r,t.isBoolean=n,t.isNull=i,t.isNullOrUndefined=o,t.isNumber=s,t.isString=a,t.isSymbol=u,t.isUndefined=c,t.isRegExp=l,t.isObject=f,t.isDate=h,t.isError=p,t.isFunction=d,t.isPrimitive=b,t.isBuffer=e.isBuffer}).call(t,r(8).Buffer)},function(e,t,r){var n={Client:r(12),ClientPluginBase:r(4),Server:r(7),ServerPluginBase:r(15),EndpointBase:r(6),BidirectionalWebsocketRouter:r(41),BidirectionalWorkerRouter:r(24),BidirectionalWebRTCRouter:r(40),RouterBase:r(14),Exception:r(2),Utils:r(3),Plugins:{Client:r(10),Server:r(25)},WebSocketAdapters:{WebSocketWrapperBase:r(19),uws:{WebSocketWrapper:r(60)}},NodeClusterBase:r(46)};e.exports=n},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),JSONRPC={};JSONRPC.EndpointBase=r(6),JSONRPC.Exception=r(2),JSONRPC.Server=r(7),JSONRPC.RouterBase=r(14);var a=r(37),u=a.URL,c=r(26);e.exports=function(){function e(){n(this,e),this._bAuthenticated=!1,this._bAuthorized=!1,this._mxRequestBody=null,this._requestObject=null,this._endpoint=null,this._router=null,this._mxResult=null,this._objResponseToBeSerialized=null,this._mxResultSerialized=null,this._bMethodCalled=!1,this._nConnectionID=null,this._classClient=null,this._objHeaders={},this._strRemoteAddress="",this._strLocalAddress="",this._objHTTPIncomingMessage=null,this._objHTTPServerResponse=null,this._objSession={},Object.seal(this)}return o(e,[{key:"addHTTPResponseHeaders",value:function(e){if(void 0===this.httpServerResponse||null===this.httpServerResponse)throw new Error("Error when trying to add HTTP response headers. The httpServerResponse is not set on the IncomingRequest instance.");if("object"!==(void 0===e?"undefined":i(e)))throw new TypeError('Invalid type "'+(void 0===e?"undefined":i(e))+'" for extraResponseHeaders set on incomingRequest. Expected "object".');for(var t in e){if(t!==t.toLowerCase())throw new TypeError("Invalid extra response header key "+t+". Keys must be lowercased.");var r=e[t];if("string"!=typeof r)throw new TypeError("Invalid extra response header value "+JSON.stringify(r)+" for key "+t+". Only string values are allowed.");if(r=c.unescape(r),r.includes("\n")||r.includes("\r"))throw new Error("Invalid extra response header value "+JSON.stringify(r)+".")}for(var n in e)this.httpServerResponse.setHeader(n,e[n])}},{key:"setRedirectURL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:307;if(e.includes("\n\t\r"))throw new TypeError("Invalid redirect URL "+JSON.stringify(e));s(Number.isInteger(t)&&t>=300&&t<=399,"Invalid redirect HTTP status code. Expected a number between 300 and 399, but got "+JSON.stringify(t)+".");var r=new u(e);this.addHTTPResponseHeaders({location:r.toString()}),this.httpServerResponse.statusCode=t}},{key:"toResponseObject",value:function(){var e={id:null,jsonrpc:"2.0"};return this.callResult instanceof Error?e.error={message:this.callResult.message,code:this.callResult instanceof JSONRPC.Exception?this.callResult.code:0,data:this.callResult.stack.split(/[\r\n]+/gm)}:e.result=void 0===this.callResult?null:this.callResult,null!==this._requestObject&&"object"===i(this._requestObject)&&this._requestObject.hasOwnProperty("id")&&(e.id=this._requestObject.id),e}},{key:"isAuthenticated",get:function(){return this._bAuthenticated},set:function(e){s("boolean"==typeof e,"bAuthenticated must be of type boolean."),this._bAuthenticated=e}},{key:"connectionID",get:function(){return this._nConnectionID},set:function(e){s("number"==typeof e&&parseInt(e,10)===e,"Connection ID must be an integer."),this._nConnectionID=e}},{key:"isAuthorized",get:function(){return this._bAuthorized},set:function(e){s("boolean"==typeof e,"bAuthorized must be of type boolean."),this._bAuthorized=e}},{key:"requestBody",get:function(){return this._mxRequestBody},set:function(e){this._mxRequestBody=e}},{key:"requestHTTPGetQuery",get:function(){if(void 0===this.httpIncomingMessage||null===this.httpIncomingMessage)return null;var e=this.httpIncomingMessage.url;return e.includes("?")&&(e=e.split("?")[1]),c.parse(e)}},{key:"requestHTTPMethod",get:function(){return void 0===this.httpIncomingMessage||null===this.httpIncomingMessage?null:this.httpIncomingMessage.method}},{key:"requestObject",get:function(){return this._requestObject},set:function(e){s("object"===(void 0===e?"undefined":i(e))||Array.isArray(e),"objRequest must be of type Array or Object."),this._requestObject=e}},{key:"isNotification",get:function(){return null!==this._requestObject&&"object"===i(this._requestObject)&&!this.requestObject.hasOwnProperty("id")}},{key:"endpoint",get:function(){return this._endpoint},set:function(e){s(e instanceof JSONRPC.EndpointBase,"endpoint must extend JSONRPC.EndpointBase"),this._endpoint=e}},{key:"router",set:function(e){s(e instanceof JSONRPC.RouterBase,"router must extend JSONRPC.RouterBase."),this._router=e}},{key:"reverseCallsClient",get:function(){return null===this._classClient&&null!==this.connectionID&&this.endpoint&&this.endpoint.ReverseCallsClientClass&&(this._classClient=this._router.connectionIDToSingletonClient(this.connectionID,this.endpoint.ReverseCallsClientClass)),this._classClient}},{key:"isMethodCalled",get:function(){return this._bMethodCalled},set:function(e){s("boolean"==typeof e,"bMethodCalled must be of type boolean."),this._bMethodCalled=e}},{key:"callResult",get:function(){return this._mxResult},set:function(e){this.isMethodCalled=!0,this._mxResult=e}},{key:"callResultToBeSerialized",get:function(){return this._objResponseToBeSerialized},set:function(e){this._objResponseToBeSerialized=e}},{key:"callResultSerialized",get:function(){return this._mxResultSerialized},set:function(e){this._mxResultSerialized=e}},{key:"httpServerResponse",get:function(){return this._objHTTPServerResponse||null},set:function(e){if("object"!==(void 0===e?"undefined":i(e)))throw new TypeError("Invalid type "+(void 0===e?"undefined":i(e))+" for httpServerResponse property in "+this.constructor.name+'. Expected "object".');this._objHTTPServerResponse=e}},{key:"httpIncomingMessage",get:function(){return this._objHTTPIncomingMessage||null},set:function(e){if("object"!==(void 0===e?"undefined":i(e)))throw new TypeError("Invalid type "+(void 0===e?"undefined":i(e))+" for httpServerResponse property in "+this.constructor.name+'. Expected "object".');this._objHTTPIncomingMessage=e}},{key:"headers",get:function(){return this._objHeaders},set:function(e){this._objHeaders=e}},{key:"session",get:function(){return this._objSession},set:function(e){if("object"!==(void 0===e?"undefined":i(e)))throw new TypeError('Invalid set value of type "'+(void 0===e?"undefined":i(e))+'" for session. Expected "object"');this._objSession=e}},{key:"remoteAddress",get:function(){return!this.httpIncomingMessage||void 0!==this._strRemoteAddress&&null!==this._strRemoteAddress||(this._strRemoteAddress=this.httpIncomingMessage.socket.remoteAddress),this._strRemoteAddress},set:function(e){this._strRemoteAddress=e}},{key:"localAddress",get:function(){return!this.httpIncomingMessage||void 0!==this._strLocalAddress&&null!==this._strLocalAddress||(this._strLocalAddress=this.httpIncomingMessage.socket.localAddress),this._strLocalAddress},set:function(e){this._strLocalAddress=e}}]),e}()},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(n)},u=r(9);e.exports=function(e){function WebSocketWrapperBase(e,t){n(this,WebSocketWrapperBase);var r=i(this,(WebSocketWrapperBase.__proto__||Object.getPrototypeOf(WebSocketWrapperBase)).call(this));return r._webSocket=e,r}return o(WebSocketWrapperBase,e),s(WebSocketWrapperBase,[{key:"on",value:function(e,t){return this._webSocket.on(e,t)}},{key:"superOn",value:function(e,t){return a(WebSocketWrapperBase.prototype.__proto__||Object.getPrototypeOf(WebSocketWrapperBase.prototype),"on",this).call(this,e,t)}},{key:"send",value:function(e){for(var t,r=arguments.length,n=Array(r>1?r-1:0),i=1;i<r;i++)n[i-1]=arguments[i];return(t=this._webSocket).send.apply(t,[e].concat(n))}},{key:"close",value:function(e,t){return this._webSocket.close(e,t)}},{key:"terminate",value:function(){return this._webSocket.terminate()}},{key:"ping",value:function(){var e;return(e=this._webSocket).ping.apply(e,arguments)}},{key:"pong",value:function(){var e;return(e=this._webSocket).pong.apply(e,arguments)}},{key:"url",get:function(){return this._webSocket.url}},{key:"socket",get:function(){return this._webSocket.socket}},{key:"readyState",get:function(){return this._webSocket.readyState}},{key:"protocol",get:function(){return this._webSocket.protocol}},{key:"protocolVersion",get:function(){return this._webSocket.protocolVersion}}],[{key:"CONNECTING",get:function(){return 0}},{key:"OPEN",get:function(){return 1}},{key:"CLOSING",get:function(){return 2}},{key:"CLOSED",get:function(){return 3}}]),WebSocketWrapperBase}(u)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var i="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Int32Array;t.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(r){if("object"!=typeof r)throw new TypeError(r+"must be non-object");for(var i in r)n(r,i)&&(e[i]=r[i])}}return e},t.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var o={arraySet:function(e,t,r,n,i){if(t.subarray&&e.subarray)return void e.set(t.subarray(r,r+n),i);for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){var t,r,n,i,o,s;for(n=0,t=0,r=e.length;t<r;t++)n+=e[t].length;for(s=new Uint8Array(n),i=0,t=0,r=e.length;t<r;t++)o=e[t],s.set(o,i),i+=o.length;return s}},s={arraySet:function(e,t,r,n,i){for(var o=0;o<n;o++)e[i+o]=t[r+o]},flattenChunks:function(e){return[].concat.apply([],e)}};t.setTyped=function(e){e?(t.Buf8=Uint8Array,t.Buf16=Uint16Array,t.Buf32=Int32Array,t.assign(t,o)):(t.Buf8=Array,t.Buf16=Array,t.Buf32=Array,t.assign(t,s))},t.setTyped(i)},function(e,t,r){"use strict";(function(t){function r(e,r,n,i){if("function"!=typeof e)throw new TypeError('"callback" argument must be a function');var o,s,a=arguments.length;switch(a){case 0:case 1:return t.nextTick(e);case 2:return t.nextTick(function(){e.call(null,r)});case 3:return t.nextTick(function(){e.call(null,r,n)});case 4:return t.nextTick(function(){e.call(null,r,n,i)});default:for(o=new Array(a-1),s=0;s<o.length;)o[s++]=arguments[s];return t.nextTick(function(){e.apply(null,o)})}}!t.version||0===t.version.indexOf("v0.")||0===t.version.indexOf("v1.")&&0!==t.version.indexOf("v1.8.")?e.exports=r:e.exports=t.nextTick}).call(t,r(0))},function(e,t,r){function n(e,t){for(var r in e)t[r]=e[r]}function i(e,t,r){return s(e,t,r)}var o=r(8),s=o.Buffer;s.from&&s.alloc&&s.allocUnsafe&&s.allocUnsafeSlow?e.exports=o:(n(o,t),t.Buffer=i),n(s,i),i.from=function(e,t,r){if("number"==typeof e)throw new TypeError("Argument must not be a number");return s(e,t,r)},i.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError("Argument must be a number");var n=s(e);return void 0!==t?"string"==typeof r?n.fill(t,r):n.fill(t):n.fill(0),n},i.allocUnsafe=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return s(e)},i.allocUnsafeSlow=function(e){if("number"!=typeof e)throw new TypeError("Argument must be a number");return o.SlowBuffer(e)}},function(t,r){t.exports=e},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),c=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(n)},l=r(1),f=r(23);f||(f={isMaster:!(self&&void 0===self.document),isWorker:!(!self||void 0!==self.document)});var JSONRPC={};JSONRPC.Exception=r(2),JSONRPC.Server=r(7),JSONRPC.IncomingRequest=r(18),JSONRPC.EndpointBase=r(6),JSONRPC.RouterBase=r(14),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(10),JSONRPC.Utils=r(3),e.exports=function(e){function BidirectionalWorkerRouter(e){i(this,BidirectionalWorkerRouter);var t=o(this,(BidirectionalWorkerRouter.__proto__||Object.getPrototypeOf(BidirectionalWorkerRouter)).call(this,e));return e.on("response",function(e){e.callResultSerialized=e.callResultToBeSerialized}),t._objWaitForWorkerReadyPromises={},t}return s(BidirectionalWorkerRouter,e),u(BidirectionalWorkerRouter,[{key:"addWorker",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,i){var o,s,u,c,h,p=this,d=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e4;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i){e.next=6;break}if(!f.isWorker){e.next=3;break}throw new Error("The strEndpointPath param is mandatory inside workers.");case 3:i=null,e.next=7;break;case 6:i=JSONRPC.EndpointBase.normalizePath(i);case 7:if(l(f.isMaster||t===r||self===r,"Unknown worker type."),o=++this._nConnectionIDCounter,s=void 0,f.isMaster&&(this._objWaitForWorkerReadyPromises[o]={fnResolve:null,fnReject:null},s=new Promise(function(e,t){p._objWaitForWorkerReadyPromises[o].fnResolve=e,p._objWaitForWorkerReadyPromises[o].fnReject=t})),u={worker:r,nConnectionID:o,clientReverseCalls:null,clientWorkerTransportPlugin:null,strEndpointPath:i},this._objSessions[o]=u,c=function(){p.onConnectionEnded(o),r.terminate?r.terminate():r===t||r.isDead()||r.kill()},r.addEventListener?(r.addEventListener("message",function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.isMaster||"object"!==a(t.data)||!t.data.jsonrpc||"rpc.connectToEndpoint"!==t.data.method){e.next=2;break}return e.abrupt("return",p._onRPCConnectToEndpoint(t.data,o));case 2:return e.next=4,p._routeMessage(t.data,u);case 4:case"end":return e.stop()}},e,p)}));return function(t){return e.apply(this,arguments)}}()),r.addEventListener("error",c)):(r.on("message",function(){var e=n(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!f.isMaster||"object"!==(void 0===t?"undefined":a(t))||!t.jsonrpc||"rpc.connectToEndpoint"!==t.method){e.next=2;break}return e.abrupt("return",p._onRPCConnectToEndpoint(t,o));case 2:return e.next=4,p._routeMessage(t,u);case 4:case"end":return e.stop()}},e,p)}));return function(t,r){return e.apply(this,arguments)}}()),r.on("exit",function(e,t){p.onConnectionEnded(o)}),r.on("error",c)),!f.isMaster){e.next=20;break}return h=setTimeout(function(e){p._objWaitForWorkerReadyPromises[o].fnReject(new Error("Timed out waiting for worker to be ready for JSONRPC."))},d),e.next=19,s;case 19:clearTimeout(h);case 20:return e.abrupt("return",o);case 21:case"end":return e.stop()}},e,this)}));return e}()},{key:"_onRPCConnectToEndpoint",value:function(e,t){var r=e.params[0];if(l("number"==typeof t,"nConnectionID must be of type number."),!this._objSessions.hasOwnProperty(t))return void console.error(new Error("[rpc.connectToEndpoint] Worker with connection ID "+t+" doesn't exist. Maybe it was closed."));try{l("string"==typeof r,"strEndpointPath must be of type string."),this._objSessions[t].strEndpointPath=JSONRPC.EndpointBase.normalizePath(r),this._objWaitForWorkerReadyPromises[t].fnResolve(this._objSessions[t].strEndpointPath);var n=this._objSessions[t].worker,i={id:e.id,result:null,jsonrpc:"2.0"};n.postMessage?n.postMessage(i):n.send(i)}catch(r){var o=this._objSessions[t].worker,s={id:e.id,error:{message:r.message+"\n"+r.stack,code:0},jsonrpc:"2.0"};o.postMessage?o.postMessage(s):o.send(s),this._objWaitForWorkerReadyPromises[t].fnReject(r)}}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWorkerTransportPlugin=new JSONRPC.Plugins.Client.WorkerTransport(t.worker,!0),r.addPlugin(t.clientWorkerTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var i,o,s,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.worker,o=n.nConnectionID,"object"===(void 0===r?"undefined":a(r))){e.next=5;break}return console.error("["+t.pid+"] WorkerBidirectionalRouter: Received "+(void 0===r?"undefined":a(r))+" instead of object. Ignoring. RAW message: "+JSON.stringify(r)),e.abrupt("return");case 5:if(s=!r.hasOwnProperty("id"),e.prev=6,!r.hasOwnProperty("method")){e.next=30;break}if(this._jsonrpcServer){e.next=10;break}throw new Error("JSONRPC.Server not initialized on this Worker.");case 10:if(u=new JSONRPC.IncomingRequest,u.connectionID=o,u.router=this,e.prev=13,c=this._objSessions[o].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(c)){e.next=17;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+c+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 17:u.endpoint=this._jsonrpcServer.endpoints[c],u.requestBody=r,u.requestObject=r,e.next=25;break;case 22:e.prev=22,e.t0=e.catch(13),u.callResult=e.t0;case 25:return e.next=27,this._jsonrpcServer.processRequest(u);case 27:s||(i.postMessage?i.postMessage(u.callResultSerialized):i.send(u.callResultSerialized)),e.next=44;break;case 30:if(!r.hasOwnProperty("result")&&!r.hasOwnProperty("error")){e.next=42;break}if(!this._objSessions.hasOwnProperty(o)||null!==this._objSessions[o].clientWorkerTransportPlugin){e.next=34;break}throw i.terminate?i.terminate():i!==t&&i.kill(),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 34:if(!this._objSessions.hasOwnProperty(o)){e.next=39;break}return e.next=37,this._objSessions[o].clientWorkerTransportPlugin.processResponse(r);case 37:e.next=40;break;case 39:console.error("Connection ID "+o+" is closed and session is missing. Ignoring response: "+JSON.stringify(r));case 40:e.next=44;break;case 42:throw s=!1,new Error("Unable to qualify the message as a JSONRPC request or response.");case 44:e.next=53;break;case 46:e.prev=46,e.t1=e.catch(6),console.error(e.t1),console.error("Uncaught error. RAW remote message: "+JSON.stringify(r)),console.log("["+t.pid+"] Unclean state. Closing worker."),this.onConnectionEnded(o),i.terminate?i.terminate():i!==t&&i.kill();case 53:case"end":return e.stop()}},e,this,[[6,46],[13,22]])}));return e}()},{key:"onConnectionEnded",value:function(e){c(BidirectionalWorkerRouter.prototype.__proto__||Object.getPrototypeOf(BidirectionalWorkerRouter.prototype),"onConnectionEnded",this).call(this,e),delete this._objWaitForWorkerReadyPromises[e]}}]),BidirectionalWorkerRouter}(JSONRPC.RouterBase)}).call(t,r(0))},function(e,t,r){"use strict";var n={};n.DebugLogger=r(58),n.AuthenticationSkip=r(56),n.AuthorizeAll=r(57),n.URLPublic=r(59),e.exports=n},function(e,t,r){"use strict";t.decode=t.parse=r(77),t.encode=t.stringify=r(78)},function(e,t,r){"use strict";(function(t,n,i){function o(e){var t=this;this.next=null,this.entry=null,this.finish=function(){O(t,e)}}function s(e){return I.from(e)}function a(e){return I.isBuffer(e)||e instanceof L}function u(){}function c(e,t){j=j||r(11),e=e||{},this.objectMode=!!e.objectMode,t instanceof j&&(this.objectMode=this.objectMode||!!e.writableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=!1===e.decodeStrings;this.decodeStrings=!s,this.defaultEncoding=e.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(e){v(t,e)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new o(this)}function l(e){if(j=j||r(11),!(B.call(l,this)||this instanceof j))return new l(e);this._writableState=new c(e,this),this.writable=!0,e&&("function"==typeof e.write&&(this._write=e.write),"function"==typeof e.writev&&(this._writev=e.writev),"function"==typeof e.destroy&&(this._destroy=e.destroy),"function"==typeof e.final&&(this._final=e.final)),N.call(this)}function f(e,t){var r=new Error("write after end");e.emit("error",r),P(t,r)}function h(e,t,r,n){var i=!0,o=!1;return null===r?o=new TypeError("May not write null values to stream"):"string"==typeof r||void 0===r||t.objectMode||(o=new TypeError("Invalid non-string/buffer chunk")),o&&(e.emit("error",o),P(n,o),i=!1),i}function p(e,t,r){return e.objectMode||!1===e.decodeStrings||"string"!=typeof t||(t=I.from(t,r)),t}function d(e,t,r,n,i,o){if(!r){var s=p(t,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=t.objectMode?1:n.length;t.length+=a;var u=t.length<t.highWaterMark;if(u||(t.needDrain=!0),t.writing||t.corked){var c=t.lastBufferedRequest;t.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},c?c.next=t.lastBufferedRequest:t.bufferedRequest=t.lastBufferedRequest,t.bufferedRequestCount+=1}else b(e,t,!1,a,n,i,o);return u}function b(e,t,r,n,i,o,s){t.writelen=n,t.writecb=s,t.writing=!0,t.sync=!0,r?e._writev(i,t.onwrite):e._write(i,o,t.onwrite),t.sync=!1}function y(e,t,r,n,i){--t.pendingcb,r?(P(i,n),P(S,e,t),e._writableState.errorEmitted=!0,e.emit("error",n)):(i(n),e._writableState.errorEmitted=!0,e.emit("error",n),S(e,t))}function g(e){e.writing=!1,e.writecb=null,e.length-=e.writelen,e.writelen=0}function v(e,t){var r=e._writableState,n=r.sync,i=r.writecb;if(g(r),t)y(e,r,n,t,i);else{var o=k(r);o||r.corked||r.bufferProcessing||!r.bufferedRequest||w(e,r),n?T(_,e,r,o,i):_(e,r,o,i)}}function _(e,t,r,n){r||m(e,t),t.pendingcb--,n(),S(e,t)}function m(e,t){0===t.length&&t.needDrain&&(t.needDrain=!1,e.emit("drain"))}function w(e,t){t.bufferProcessing=!0;var r=t.bufferedRequest;if(e._writev&&r&&r.next){var n=t.bufferedRequestCount,i=new Array(n),s=t.corkedRequestsFree;s.entry=r;for(var a=0,u=!0;r;)i[a]=r,r.isBuf||(u=!1),r=r.next,a+=1;i.allBuffers=u,b(e,t,!0,t.length,i,"",s.finish),t.pendingcb++,t.lastBufferedRequest=null,s.next?(t.corkedRequestsFree=s.next,s.next=null):t.corkedRequestsFree=new o(t)}else{for(;r;){var c=r.chunk,l=r.encoding,f=r.callback;if(b(e,t,!1,t.objectMode?1:c.length,c,l,f),r=r.next,t.writing)break}null===r&&(t.lastBufferedRequest=null)}t.bufferedRequestCount=0,t.bufferedRequest=r,t.bufferProcessing=!1}function k(e){return e.ending&&0===e.length&&null===e.bufferedRequest&&!e.finished&&!e.writing}function R(e,t){e._final(function(r){t.pendingcb--,r&&e.emit("error",r),t.prefinished=!0,e.emit("prefinish"),S(e,t)})}function E(e,t){t.prefinished||t.finalCalled||("function"==typeof e._final?(t.pendingcb++,t.finalCalled=!0,P(R,e,t)):(t.prefinished=!0,e.emit("prefinish")))}function S(e,t){var r=k(t);return r&&(E(e,t),0===t.pendingcb&&(t.finished=!0,e.emit("finish"))),r}function x(e,t,r){t.ending=!0,S(e,t),r&&(t.finished?P(r):e.once("finish",r)),t.ended=!0,e.writable=!1}function O(e,t,r){var n=e.entry;for(e.entry=null;n;){var i=n.callback;t.pendingcb--,i(r),n=n.next}t.corkedRequestsFree?t.corkedRequestsFree.next=e:t.corkedRequestsFree=e}var P=r(21);e.exports=l;var j,T=!t.browser&&["v0.10","v0.9."].indexOf(t.version.slice(0,5))>-1?n:P;l.WritableState=c;var A=r(16);A.inherits=r(13);var C={deprecate:r(90)},N=r(35),I=r(22).Buffer,L=i.Uint8Array||function(){},U=r(34);A.inherits(l,N),c.prototype.getBuffer=function(){for(var e=this.bufferedRequest,t=[];e;)t.push(e),e=e.next;return t},function(){try{Object.defineProperty(c.prototype,"buffer",{get:C.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch(e){}}();var B;"function"==typeof Symbol&&Symbol.hasInstance&&"function"==typeof Function.prototype[Symbol.hasInstance]?(B=Function.prototype[Symbol.hasInstance],Object.defineProperty(l,Symbol.hasInstance,{value:function(e){return!!B.call(this,e)||e&&e._writableState instanceof c}})):B=function(e){return e instanceof this},l.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))},l.prototype.write=function(e,t,r){var n=this._writableState,i=!1,o=a(e)&&!n.objectMode;return o&&!I.isBuffer(e)&&(e=s(e)),"function"==typeof t&&(r=t,t=null),o?t="buffer":t||(t=n.defaultEncoding),"function"!=typeof r&&(r=u),n.ended?f(this,r):(o||h(this,n,e,r))&&(n.pendingcb++,i=d(this,n,o,e,t,r)),i},l.prototype.cork=function(){this._writableState.corked++},l.prototype.uncork=function(){var e=this._writableState;e.corked&&(e.corked--,e.writing||e.corked||e.finished||e.bufferProcessing||!e.bufferedRequest||w(this,e))},l.prototype.setDefaultEncoding=function(e){if("string"==typeof e&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this},l.prototype._write=function(e,t,r){r(new Error("_write() is not implemented"))},l.prototype._writev=null,l.prototype.end=function(e,t,r){var n=this._writableState;"function"==typeof e?(r=e,e=null,t=null):"function"==typeof t&&(r=t,t=null),null!==e&&void 0!==e&&this.write(e,t),n.corked&&(n.corked=1,this.uncork()),n.ending||n.finished||x(this,n,r)},Object.defineProperty(l.prototype,"destroyed",{get:function(){return void 0!==this._writableState&&this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}}),l.prototype.destroy=U.destroy,l.prototype._undestroy=U.undestroy,l.prototype._destroy=function(e,t){this.end(),t(e)}}).call(t,r(0),r(88).setImmediate,r(5))},function(e,t,r){t=e.exports=r(32),t.Stream=t,t.Readable=t,t.Writable=r(27),t.Duplex=r(11),t.Transform=r(33),t.PassThrough=r(80)},function(e,t){var r={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==r.call(e)}},function(e,t,r){"use strict";function n(e,t,r,n){for(var i=65535&e|0,o=e>>>16&65535|0,s=0;0!==r;){s=r>2e3?2e3:r,r-=s;do{i=i+t[n++]|0,o=o+i|0}while(--s);i%=65521,o%=65521}return i|o<<16|0}e.exports=n},function(e,t,r){"use strict";function n(e,t,r,n){var o=i,s=n+r;e^=-1;for(var a=n;a<s;a++)e=e>>>8^o[255&(e^t[a])];return-1^e}var i=function(){for(var e,t=[],r=0;r<256;r++){e=r;for(var n=0;n<8;n++)e=1&e?3988292384^e>>>1:e>>>1;t[r]=e}return t}();e.exports=n},function(e,t,r){"use strict";(function(t,n){function i(e){return B.from(e)}function o(e){return B.isBuffer(e)||e instanceof D}function s(e,t,r){if("function"==typeof e.prependListener)return e.prependListener(t,r);e._events&&e._events[t]?I(e._events[t])?e._events[t].unshift(r):e._events[t]=[r,e._events[t]]:e.on(t,r)}function a(e,t){N=N||r(11),e=e||{},this.objectMode=!!e.objectMode,t instanceof N&&(this.objectMode=this.objectMode||!!e.readableObjectMode);var n=e.highWaterMark,i=this.objectMode?16:16384;this.highWaterMark=n||0===n?n:i,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new z,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=e.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(F||(F=r(36).StringDecoder),this.decoder=new F(e.encoding),this.encoding=e.encoding)}function u(e){if(N=N||r(11),!(this instanceof u))return new u(e);this._readableState=new a(e,this),this.readable=!0,e&&("function"==typeof e.read&&(this._read=e.read),"function"==typeof e.destroy&&(this._destroy=e.destroy)),U.call(this)}function c(e,t,r,n,o){var s=e._readableState;if(null===t)s.reading=!1,b(e,s);else{var a;o||(a=f(s,t)),a?e.emit("error",a):s.objectMode||t&&t.length>0?("string"==typeof t||s.objectMode||Object.getPrototypeOf(t)===B.prototype||(t=i(t)),n?s.endEmitted?e.emit("error",new Error("stream.unshift() after end event")):l(e,s,t,!0):s.ended?e.emit("error",new Error("stream.push() after EOF")):(s.reading=!1,s.decoder&&!r?(t=s.decoder.write(t),s.objectMode||0!==t.length?l(e,s,t,!1):v(e,s)):l(e,s,t,!1))):n||(s.reading=!1)}return h(s)}function l(e,t,r,n){t.flowing&&0===t.length&&!t.sync?(e.emit("data",r),e.read(0)):(t.length+=t.objectMode?1:r.length,n?t.buffer.unshift(r):t.buffer.push(r),t.needReadable&&y(e)),v(e,t)}function f(e,t){var r;return o(t)||"string"==typeof t||void 0===t||e.objectMode||(r=new TypeError("Invalid non-string/buffer chunk")),r}function h(e){return!e.ended&&(e.needReadable||e.length<e.highWaterMark||0===e.length)}function p(e){return e>=Z?e=Z:(e--,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,e|=e>>>16,e++),e}function d(e,t){return e<=0||0===t.length&&t.ended?0:t.objectMode?1:e!==e?t.flowing&&t.length?t.buffer.head.data.length:t.length:(e>t.highWaterMark&&(t.highWaterMark=p(e)),e<=t.length?e:t.ended?t.length:(t.needReadable=!0,0))}function b(e,t){if(!t.ended){if(t.decoder){var r=t.decoder.end();r&&r.length&&(t.buffer.push(r),t.length+=t.objectMode?1:r.length)}t.ended=!0,y(e)}}function y(e){var t=e._readableState;t.needReadable=!1,t.emittedReadable||(W("emitReadable",t.flowing),t.emittedReadable=!0,t.sync?C(g,e):g(e))}function g(e){W("emit readable"),e.emit("readable"),E(e)}function v(e,t){t.readingMore||(t.readingMore=!0,C(_,e,t))}function _(e,t){for(var r=t.length;!t.reading&&!t.flowing&&!t.ended&&t.length<t.highWaterMark&&(W("maybeReadMore read 0"),e.read(0),r!==t.length);)r=t.length;t.readingMore=!1}function m(e){return function(){var t=e._readableState;W("pipeOnDrain",t.awaitDrain),t.awaitDrain&&t.awaitDrain--,0===t.awaitDrain&&L(e,"data")&&(t.flowing=!0,E(e))}}function w(e){W("readable nexttick read 0"),e.read(0)}function k(e,t){t.resumeScheduled||(t.resumeScheduled=!0,C(R,e,t))}function R(e,t){t.reading||(W("resume read 0"),e.read(0)),t.resumeScheduled=!1,t.awaitDrain=0,e.emit("resume"),E(e),t.flowing&&!t.reading&&e.read(0)}function E(e){var t=e._readableState;for(W("flow",t.flowing);t.flowing&&null!==e.read(););}function S(e,t){if(0===t.length)return null;var r;return t.objectMode?r=t.buffer.shift():!e||e>=t.length?(r=t.decoder?t.buffer.join(""):1===t.buffer.length?t.buffer.head.data:t.buffer.concat(t.length),t.buffer.clear()):r=x(e,t.buffer,t.decoder),r}function x(e,t,r){var n;return e<t.head.data.length?(n=t.head.data.slice(0,e),t.head.data=t.head.data.slice(e)):n=e===t.head.data.length?t.shift():r?O(e,t):P(e,t),n}function O(e,t){var r=t.head,n=1,i=r.data;for(e-=i.length;r=r.next;){var o=r.data,s=e>o.length?o.length:e;if(s===o.length?i+=o:i+=o.slice(0,e),0===(e-=s)){s===o.length?(++n,r.next?t.head=r.next:t.head=t.tail=null):(t.head=r,r.data=o.slice(s));break}++n}return t.length-=n,i}function P(e,t){var r=B.allocUnsafe(e),n=t.head,i=1;for(n.data.copy(r),e-=n.data.length;n=n.next;){var o=n.data,s=e>o.length?o.length:e;if(o.copy(r,r.length-e,0,s),0===(e-=s)){s===o.length?(++i,n.next?t.head=n.next:t.head=t.tail=null):(t.head=n,n.data=o.slice(s));break}++i}return t.length-=i,r}function j(e){var t=e._readableState;if(t.length>0)throw new Error('"endReadable()" called on non-empty stream');t.endEmitted||(t.ended=!0,C(T,t,e))}function T(e,t){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}function A(e,t){for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r;return-1}var C=r(21);e.exports=u;var N,I=r(29);u.ReadableState=a;var L=(r(9).EventEmitter,function(e,t){return e.listeners(t).length}),U=r(35),B=r(22).Buffer,D=t.Uint8Array||function(){},M=r(16);M.inherits=r(13);var q=r(96),W=void 0;W=q&&q.debuglog?q.debuglog("stream"):function(){};var F,z=r(81),J=r(34);M.inherits(u,U);var H=["error","close","destroy","pause","resume"];Object.defineProperty(u.prototype,"destroyed",{get:function(){return void 0!==this._readableState&&this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}}),u.prototype.destroy=J.destroy,u.prototype._undestroy=J.undestroy,u.prototype._destroy=function(e,t){this.push(null),t(e)},u.prototype.push=function(e,t){var r,n=this._readableState;return n.objectMode?r=!0:"string"==typeof e&&(t=t||n.defaultEncoding,t!==n.encoding&&(e=B.from(e,t),t=""),r=!0),c(this,e,t,!1,r)},u.prototype.unshift=function(e){return c(this,e,null,!0,!1)},u.prototype.isPaused=function(){return!1===this._readableState.flowing},u.prototype.setEncoding=function(e){return F||(F=r(36).StringDecoder),this._readableState.decoder=new F(e),this._readableState.encoding=e,this};var Z=8388608;u.prototype.read=function(e){W("read",e),e=parseInt(e,10);var t=this._readableState,r=e;if(0!==e&&(t.emittedReadable=!1),0===e&&t.needReadable&&(t.length>=t.highWaterMark||t.ended))return W("read: emitReadable",t.length,t.ended),0===t.length&&t.ended?j(this):y(this),null;if(0===(e=d(e,t))&&t.ended)return 0===t.length&&j(this),null;var n=t.needReadable;W("need readable",n),(0===t.length||t.length-e<t.highWaterMark)&&(n=!0,W("length less than watermark",n)),t.ended||t.reading?(n=!1,W("reading or ended",n)):n&&(W("do read"),t.reading=!0,t.sync=!0,0===t.length&&(t.needReadable=!0),this._read(t.highWaterMark),t.sync=!1,t.reading||(e=d(r,t)));var i;return i=e>0?S(e,t):null,null===i?(t.needReadable=!0,e=0):t.length-=e,0===t.length&&(t.ended||(t.needReadable=!0),r!==e&&t.ended&&j(this)),null!==i&&this.emit("data",i),i},u.prototype._read=function(e){this.emit("error",new Error("_read() is not implemented"))},u.prototype.pipe=function(e,t){function r(e,t){W("onunpipe"),e===h&&t&&!1===t.hasUnpiped&&(t.hasUnpiped=!0,o())}function i(){W("onend"),e.end()}function o(){W("cleanup"),e.removeListener("close",c),e.removeListener("finish",l),e.removeListener("drain",y),e.removeListener("error",u),e.removeListener("unpipe",r),h.removeListener("end",i),h.removeListener("end",f),h.removeListener("data",a),g=!0,!p.awaitDrain||e._writableState&&!e._writableState.needDrain||y()}function a(t){W("ondata"),v=!1,!1!==e.write(t)||v||((1===p.pipesCount&&p.pipes===e||p.pipesCount>1&&-1!==A(p.pipes,e))&&!g&&(W("false write response, pause",h._readableState.awaitDrain),h._readableState.awaitDrain++,v=!0),h.pause())}function u(t){W("onerror",t),f(),e.removeListener("error",u),0===L(e,"error")&&e.emit("error",t)}function c(){e.removeListener("finish",l),f()}function l(){W("onfinish"),e.removeListener("close",c),f()}function f(){W("unpipe"),h.unpipe(e)}var h=this,p=this._readableState;switch(p.pipesCount){case 0:p.pipes=e;break;case 1:p.pipes=[p.pipes,e];break;default:p.pipes.push(e)}p.pipesCount+=1,W("pipe count=%d opts=%j",p.pipesCount,t);var d=(!t||!1!==t.end)&&e!==n.stdout&&e!==n.stderr,b=d?i:f;p.endEmitted?C(b):h.once("end",b),e.on("unpipe",r);var y=m(h);e.on("drain",y);var g=!1,v=!1;return h.on("data",a),s(e,"error",u),e.once("close",c),e.once("finish",l),e.emit("pipe",h),p.flowing||(W("pipe resume"),h.resume()),e},u.prototype.unpipe=function(e){var t=this._readableState,r={hasUnpiped:!1};if(0===t.pipesCount)return this;if(1===t.pipesCount)return e&&e!==t.pipes?this:(e||(e=t.pipes),t.pipes=null,t.pipesCount=0,t.flowing=!1,e&&e.emit("unpipe",this,r),this);if(!e){var n=t.pipes,i=t.pipesCount;t.pipes=null,t.pipesCount=0,t.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,r);return this}var s=A(t.pipes,e);return-1===s?this:(t.pipes.splice(s,1),t.pipesCount-=1,1===t.pipesCount&&(t.pipes=t.pipes[0]),e.emit("unpipe",this,r),this)},u.prototype.on=function(e,t){var r=U.prototype.on.call(this,e,t);if("data"===e)!1!==this._readableState.flowing&&this.resume();else if("readable"===e){var n=this._readableState;n.endEmitted||n.readableListening||(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&y(this):C(w,this))}return r},u.prototype.addListener=u.prototype.on,u.prototype.resume=function(){var e=this._readableState;return e.flowing||(W("resume"),e.flowing=!0,k(this,e)),this},u.prototype.pause=function(){return W("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(W("pause"),this._readableState.flowing=!1,this.emit("pause")),this},u.prototype.wrap=function(e){var t=this._readableState,r=!1,n=this;e.on("end",function(){if(W("wrapped end"),t.decoder&&!t.ended){var e=t.decoder.end();e&&e.length&&n.push(e)}n.push(null)}),e.on("data",function(i){if(W("wrapped data"),t.decoder&&(i=t.decoder.write(i)),(!t.objectMode||null!==i&&void 0!==i)&&(t.objectMode||i&&i.length)){n.push(i)||(r=!0,e.pause())}});for(var i in e)void 0===this[i]&&"function"==typeof e[i]&&(this[i]=function(t){return function(){return e[t].apply(e,arguments)}}(i));for(var o=0;o<H.length;o++)e.on(H[o],n.emit.bind(n,H[o]));return n._read=function(t){W("wrapped _read",t),r&&(r=!1,e.resume())},n},u._fromList=S}).call(t,r(5),r(0))},function(e,t,r){"use strict";function n(e){this.afterTransform=function(t,r){return i(e,t,r)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null,this.writeencoding=null}function i(e,t,r){var n=e._transformState;n.transforming=!1;var i=n.writecb;if(!i)return e.emit("error",new Error("write callback called multiple times"));n.writechunk=null,n.writecb=null,null!==r&&void 0!==r&&e.push(r),i(t);var o=e._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&e._read(o.highWaterMark)}function o(e){if(!(this instanceof o))return new o(e);a.call(this,e),this._transformState=new n(this);var t=this;this._readableState.needReadable=!0,this._readableState.sync=!1,e&&("function"==typeof e.transform&&(this._transform=e.transform),"function"==typeof e.flush&&(this._flush=e.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(e,r){s(t,e,r)}):s(t)})}function s(e,t,r){if(t)return e.emit("error",t);null!==r&&void 0!==r&&e.push(r);var n=e._writableState,i=e._transformState;if(n.length)throw new Error("Calling transform done when ws.length != 0");if(i.transforming)throw new Error("Calling transform done when still transforming");return e.push(null)}e.exports=o;var a=r(11),u=r(16);u.inherits=r(13),u.inherits(o,a),o.prototype.push=function(e,t){return this._transformState.needTransform=!1,a.prototype.push.call(this,e,t)},o.prototype._transform=function(e,t,r){throw new Error("_transform() is not implemented")},o.prototype._write=function(e,t,r){var n=this._transformState;if(n.writecb=r,n.writechunk=e,n.writeencoding=t,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(e){var t=this._transformState;null!==t.writechunk&&t.writecb&&!t.transforming?(t.transforming=!0,this._transform(t.writechunk,t.writeencoding,t.afterTransform)):t.needTransform=!0},o.prototype._destroy=function(e,t){var r=this;a.prototype._destroy.call(this,e,function(e){t(e),r.emit("close")})}},function(e,t,r){"use strict";function n(e,t){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;if(n||i)return void(t?t(e):!e||this._writableState&&this._writableState.errorEmitted||s(o,this,e));this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(e||null,function(e){!t&&e?(s(o,r,e),r._writableState&&(r._writableState.errorEmitted=!0)):t&&t(e)})}function i(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function o(e,t){e.emit("error",t)}var s=r(21);e.exports={destroy:n,undestroy:i}},function(e,t,r){e.exports=r(9).EventEmitter},function(e,t,r){"use strict";function n(e){if(!e)return"utf8";for(var t;;)switch(e){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return e;default:if(t)return;e=(""+e).toLowerCase(),t=!0}}function i(e){var t=n(e);if("string"!=typeof t&&(v.isEncoding===_||!_(e)))throw new Error("Unknown encoding: "+e);return t||e}function o(e){this.encoding=i(e);var t;switch(this.encoding){case"utf16le":this.text=h,this.end=p,t=4;break;case"utf8":this.fillLast=c,t=4;break;case"base64":this.text=d,this.end=b,t=3;break;default:return this.write=y,void(this.end=g)}this.lastNeed=0,this.lastTotal=0,this.lastChar=v.allocUnsafe(t)}function s(e){return e<=127?0:e>>5==6?2:e>>4==14?3:e>>3==30?4:-1}function a(e,t,r){var n=t.length-1;if(n<r)return 0;var i=s(t[n]);return i>=0?(i>0&&(e.lastNeed=i-1),i):--n<r?0:(i=s(t[n]))>=0?(i>0&&(e.lastNeed=i-2),i):--n<r?0:(i=s(t[n]),i>=0?(i>0&&(2===i?i=0:e.lastNeed=i-3),i):0)}function u(e,t,r){if(128!=(192&t[0]))return e.lastNeed=0,"".repeat(r);if(e.lastNeed>1&&t.length>1){if(128!=(192&t[1]))return e.lastNeed=1,"".repeat(r+1);if(e.lastNeed>2&&t.length>2&&128!=(192&t[2]))return e.lastNeed=2,"".repeat(r+2)}}function c(e){var t=this.lastTotal-this.lastNeed,r=u(this,e,t);return void 0!==r?r:this.lastNeed<=e.length?(e.copy(this.lastChar,t,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal)):(e.copy(this.lastChar,t,0,e.length),void(this.lastNeed-=e.length))}function l(e,t){var r=a(this,e,t);if(!this.lastNeed)return e.toString("utf8",t);this.lastTotal=r;var n=e.length-(r-this.lastNeed);return e.copy(this.lastChar,0,n),e.toString("utf8",t,n)}function f(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+"".repeat(this.lastTotal-this.lastNeed):t}function h(e,t){if((e.length-t)%2==0){var r=e.toString("utf16le",t);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=e[e.length-1],e.toString("utf16le",t,e.length-1)}function p(e){var t=e&&e.length?this.write(e):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return t+this.lastChar.toString("utf16le",0,r)}return t}function d(e,t){var r=(e.length-t)%3;return 0===r?e.toString("base64",t):(this.lastNeed=3-r,this.lastTotal=3,1===r?this.lastChar[0]=e[e.length-1]:(this.lastChar[0]=e[e.length-2],this.lastChar[1]=e[e.length-1]),e.toString("base64",t,e.length-r))}function b(e){var t=e&&e.length?this.write(e):"";return this.lastNeed?t+this.lastChar.toString("base64",0,3-this.lastNeed):t}function y(e){return e.toString(this.encoding)}function g(e){return e&&e.length?this.write(e):""}var v=r(22).Buffer,_=v.isEncoding||function(e){switch((e=""+e)&&e.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};t.StringDecoder=o,o.prototype.write=function(e){if(0===e.length)return"";var t,r;if(this.lastNeed){if(void 0===(t=this.fillLast(e)))return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<e.length?t?t+this.text(e,r):this.text(e,r):t||""},o.prototype.end=f,o.prototype.text=l,o.prototype.fillLast=function(e){if(this.lastNeed<=e.length)return e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);e.copy(this.lastChar,this.lastTotal-this.lastNeed,0,e.length),this.lastNeed-=e.length}},function(e,t,r){"use strict";function n(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(e,t,r){if(e&&c.isObject(e)&&e instanceof n)return e;var i=new n;return i.parse(e,t,r),i}function o(e){return c.isString(e)&&(e=i(e)),e instanceof n?e.format():n.prototype.format.call(e)}function s(e,t){return i(e,!1,!0).resolve(t)}function a(e,t){return e?i(e,!1,!0).resolveObject(t):t}var u=r(76),c=r(89);t.parse=i,t.resolve=s,t.resolveObject=a,t.format=o,t.Url=n;var l=/^([a-z0-9.+-]+:)/i,f=/:[0-9]*$/,h=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,p=["<",">",'"',"`"," ","\r","\n","\t"],d=["{","}","|","\\","^","`"].concat(p),b=["'"].concat(d),y=["%","/","?",";","#"].concat(b),g=["/","?","#"],v=/^[+a-z0-9A-Z_-]{0,63}$/,_=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,m={javascript:!0,"javascript:":!0},w={javascript:!0,"javascript:":!0},k={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},R=r(26);n.prototype.parse=function(e,t,r){if(!c.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var n=e.indexOf("?"),i=-1!==n&&n<e.indexOf("#")?"?":"#",o=e.split(i),s=/\\/g;o[0]=o[0].replace(s,"/"),e=o.join(i);var a=e;if(a=a.trim(),!r&&1===e.split("#").length){var f=h.exec(a);if(f)return this.path=a,this.href=a,this.pathname=f[1],f[2]?(this.search=f[2],this.query=t?R.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var p=l.exec(a);if(p){p=p[0];var d=p.toLowerCase();this.protocol=d,a=a.substr(p.length)}if(r||p||a.match(/^\/\/[^@\/]+@[^@\/]+/)){var E="//"===a.substr(0,2);!E||p&&w[p]||(a=a.substr(2),this.slashes=!0)}if(!w[p]&&(E||p&&!k[p])){for(var S=-1,x=0;x<g.length;x++){var O=a.indexOf(g[x]);-1!==O&&(-1===S||O<S)&&(S=O)}var P,j;j=-1===S?a.lastIndexOf("@"):a.lastIndexOf("@",S),-1!==j&&(P=a.slice(0,j),a=a.slice(j+1),this.auth=decodeURIComponent(P)),S=-1;for(var x=0;x<y.length;x++){var O=a.indexOf(y[x]);-1!==O&&(-1===S||O<S)&&(S=O)}-1===S&&(S=a.length),this.host=a.slice(0,S),a=a.slice(S),this.parseHost(),this.hostname=this.hostname||"";var T="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!T)for(var A=this.hostname.split(/\./),x=0,C=A.length;x<C;x++){var N=A[x];if(N&&!N.match(v)){for(var I="",L=0,U=N.length;L<U;L++)N.charCodeAt(L)>127?I+="x":I+=N[L];if(!I.match(v)){var B=A.slice(0,x),D=A.slice(x+1),M=N.match(_);M&&(B.push(M[1]),D.unshift(M[2])),D.length&&(a="/"+D.join(".")+a),this.hostname=B.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),T||(this.hostname=u.toASCII(this.hostname));var q=this.port?":"+this.port:"",W=this.hostname||"";this.host=W+q,this.href+=this.host,T&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==a[0]&&(a="/"+a))}if(!m[d])for(var x=0,C=b.length;x<C;x++){var F=b[x];if(-1!==a.indexOf(F)){var z=encodeURIComponent(F);z===F&&(z=escape(F)),a=a.split(F).join(z)}}var J=a.indexOf("#");-1!==J&&(this.hash=a.substr(J),a=a.slice(0,J));var H=a.indexOf("?");if(-1!==H?(this.search=a.substr(H),this.query=a.substr(H+1),t&&(this.query=R.parse(this.query)),a=a.slice(0,H)):t&&(this.search="",this.query={}),a&&(this.pathname=a),k[d]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var q=this.pathname||"",Z=this.search||"";this.path=q+Z}return this.href=this.format(),this},n.prototype.format=function(){var e=this.auth||"";e&&(e=encodeURIComponent(e),e=e.replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&c.isObject(this.query)&&Object.keys(this.query).length&&(o=R.stringify(this.query));var s=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||k[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),s&&"?"!==s.charAt(0)&&(s="?"+s),r=r.replace(/[?#]/g,function(e){return encodeURIComponent(e)}),s=s.replace("#","%23"),t+i+r+s+n},n.prototype.resolve=function(e){return this.resolveObject(i(e,!1,!0)).format()},n.prototype.resolveObject=function(e){if(c.isString(e)){var t=new n;t.parse(e,!1,!0),e=t}for(var r=new n,i=Object.keys(this),o=0;o<i.length;o++){var s=i[o];r[s]=this[s]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var a=Object.keys(e),u=0;u<a.length;u++){var l=a[u];"protocol"!==l&&(r[l]=e[l])}return k[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!k[e.protocol]){for(var f=Object.keys(e),h=0;h<f.length;h++){var p=f[h];r[p]=e[p]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||w[e.protocol])r.pathname=e.pathname;else{for(var d=(e.pathname||"").split("/");d.length&&!(e.host=d.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==d[0]&&d.unshift(""),d.length<2&&d.unshift(""),r.pathname=d.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var b=r.pathname||"",y=r.search||"";r.path=b+y}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var g=r.pathname&&"/"===r.pathname.charAt(0),v=e.host||e.pathname&&"/"===e.pathname.charAt(0),_=v||g||r.host&&e.pathname,m=_,R=r.pathname&&r.pathname.split("/")||[],d=e.pathname&&e.pathname.split("/")||[],E=r.protocol&&!k[r.protocol];if(E&&(r.hostname="",r.port=null,r.host&&(""===R[0]?R[0]=r.host:R.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===d[0]?d[0]=e.host:d.unshift(e.host)),e.host=null),_=_&&(""===d[0]||""===R[0])),v)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,R=d;else if(d.length)R||(R=[]),R.pop(),R=R.concat(d),r.search=e.search,r.query=e.query;else if(!c.isNullOrUndefined(e.search)){if(E){r.hostname=r.host=R.shift();var S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())}return r.search=e.search,r.query=e.query,c.isNull(r.pathname)&&c.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!R.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var x=R.slice(-1)[0],O=(r.host||e.host||R.length>1)&&("."===x||".."===x)||""===x,P=0,j=R.length;j>=0;j--)x=R[j],"."===x?R.splice(j,1):".."===x?(R.splice(j,1),P++):P&&(R.splice(j,1),P--);if(!_&&!m)for(;P--;P)R.unshift("..");!_||""===R[0]||R[0]&&"/"===R[0].charAt(0)||R.unshift(""),O&&"/"!==R.join("/").substr(-1)&&R.push("");var T=""===R[0]||R[0]&&"/"===R[0].charAt(0);if(E){r.hostname=r.host=T?"":R.length?R.shift():"";var S=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@");S&&(r.auth=S.shift(),r.host=r.hostname=S.shift())}return _=_||r.host&&R.length,_&&!T&&R.unshift(""),R.length?r.pathname=R.join("/"):(r.pathname=null,r.path=null),c.isNull(r.pathname)&&c.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},n.prototype.parseHost=function(){var e=this.host,t=f.exec(e);t&&(t=t[0],":"!==t&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){(function(e,n){function i(e,r){var n={seen:[],stylize:s};return arguments.length>=3&&(n.depth=arguments[2]),arguments.length>=4&&(n.colors=arguments[3]),b(r)?n.showHidden=r:r&&t._extend(n,r),w(n.showHidden)&&(n.showHidden=!1),w(n.depth)&&(n.depth=2),w(n.colors)&&(n.colors=!1),w(n.customInspect)&&(n.customInspect=!0),n.colors&&(n.stylize=o),u(n,e,n.depth)}function o(e,t){var r=i.styles[t];return r?"["+i.colors[r][0]+"m"+e+"["+i.colors[r][1]+"m":e}function s(e,t){return e}function a(e){var t={};return e.forEach(function(e,r){t[e]=!0}),t}function u(e,r,n){if(e.customInspect&&r&&x(r.inspect)&&r.inspect!==t.inspect&&(!r.constructor||r.constructor.prototype!==r)){var i=r.inspect(n,e);return _(i)||(i=u(e,i,n)),i}var o=c(e,r);if(o)return o;var s=Object.keys(r),b=a(s);if(e.showHidden&&(s=Object.getOwnPropertyNames(r)),S(r)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return l(r);if(0===s.length){if(x(r)){var y=r.name?": "+r.name:"";return e.stylize("[Function"+y+"]","special")}if(k(r))return e.stylize(RegExp.prototype.toString.call(r),"regexp");if(E(r))return e.stylize(Date.prototype.toString.call(r),"date");if(S(r))return l(r)}var g="",v=!1,m=["{","}"];if(d(r)&&(v=!0,m=["[","]"]),x(r)){g=" [Function"+(r.name?": "+r.name:"")+"]"}if(k(r)&&(g=" "+RegExp.prototype.toString.call(r)),E(r)&&(g=" "+Date.prototype.toUTCString.call(r)),S(r)&&(g=" "+l(r)),0===s.length&&(!v||0==r.length))return m[0]+g+m[1];if(n<0)return k(r)?e.stylize(RegExp.prototype.toString.call(r),"regexp"):e.stylize("[Object]","special");e.seen.push(r);var w;return w=v?f(e,r,n,b,s):s.map(function(t){return h(e,r,n,b,t,v)}),e.seen.pop(),p(w,g,m)}function c(e,t){if(w(t))return e.stylize("undefined","undefined");if(_(t)){var r="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(r,"string")}return v(t)?e.stylize(""+t,"number"):b(t)?e.stylize(""+t,"boolean"):y(t)?e.stylize("null","null"):void 0}function l(e){return"["+Error.prototype.toString.call(e)+"]"}function f(e,t,r,n,i){for(var o=[],s=0,a=t.length;s<a;++s)A(t,String(s))?o.push(h(e,t,r,n,String(s),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(h(e,t,r,n,i,!0))}),o}function h(e,t,r,n,i,o){var s,a,c;if(c=Object.getOwnPropertyDescriptor(t,i)||{value:t[i]},c.get?a=c.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):c.set&&(a=e.stylize("[Setter]","special")),A(n,i)||(s="["+i+"]"),a||(e.seen.indexOf(c.value)<0?(a=y(r)?u(e,c.value,null):u(e,c.value,r-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(e){return"  "+e}).join("\n").substr(2):"\n"+a.split("\n").map(function(e){return"   "+e}).join("\n"))):a=e.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=e.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=e.stylize(s,"string"))}return s+": "+a}function p(e,t,r){var n=0;return e.reduce(function(e,t){return n++,t.indexOf("\n")>=0&&n++,e+t.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?r[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+r[1]:r[0]+t+" "+e.join(", ")+" "+r[1]}function d(e){return Array.isArray(e)}function b(e){return"boolean"==typeof e}function y(e){return null===e}function g(e){return null==e}function v(e){return"number"==typeof e}function _(e){return"string"==typeof e}function m(e){return"symbol"==typeof e}function w(e){return void 0===e}function k(e){return R(e)&&"[object RegExp]"===P(e)}function R(e){return"object"==typeof e&&null!==e}function E(e){return R(e)&&"[object Date]"===P(e)}function S(e){return R(e)&&("[object Error]"===P(e)||e instanceof Error)}function x(e){return"function"==typeof e}function O(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e}function P(e){return Object.prototype.toString.call(e)}function j(e){return e<10?"0"+e.toString(10):e.toString(10)}function T(){var e=new Date,t=[j(e.getHours()),j(e.getMinutes()),j(e.getSeconds())].join(":");return[e.getDate(),L[e.getMonth()],t].join(" ")}function A(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var C=/%[sdj%]/g;t.format=function(e){if(!_(e)){for(var t=[],r=0;r<arguments.length;r++)t.push(i(arguments[r]));return t.join(" ")}for(var r=1,n=arguments,o=n.length,s=String(e).replace(C,function(e){if("%%"===e)return"%";if(r>=o)return e;switch(e){case"%s":return String(n[r++]);case"%d":return Number(n[r++]);case"%j":try{return JSON.stringify(n[r++])}catch(e){return"[Circular]"}default:return e}}),a=n[r];r<o;a=n[++r])y(a)||!R(a)?s+=" "+a:s+=" "+i(a);return s},t.deprecate=function(r,i){function o(){if(!s){if(n.throwDeprecation)throw new Error(i);n.traceDeprecation?console.trace(i):console.error(i),s=!0}return r.apply(this,arguments)}if(w(e.process))return function(){return t.deprecate(r,i).apply(this,arguments)};if(!0===n.noDeprecation)return r;var s=!1;return o};var N,I={};t.debuglog=function(e){if(w(N)&&(N=r.i({NODE_ENV:"production"}).NODE_DEBUG||""),e=e.toUpperCase(),!I[e])if(new RegExp("\\b"+e+"\\b","i").test(N)){var i=n.pid;I[e]=function(){var r=t.format.apply(t,arguments);console.error("%s %d: %s",e,i,r)}}else I[e]=function(){};return I[e]},t.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.isArray=d,t.isBoolean=b,t.isNull=y,t.isNullOrUndefined=g,t.isNumber=v,t.isString=_,t.isSymbol=m,t.isUndefined=w,t.isRegExp=k,t.isObject=R,t.isDate=E,t.isError=S,t.isFunction=x,t.isPrimitive=O,t.isBuffer=r(92);var L=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];t.log=function(){console.log("%s - %s",T(),t.format.apply(t,arguments))},t.inherits=r(91),t._extend=function(e,t){if(!t||!R(t))return e;for(var r=Object.keys(t),n=r.length;n--;)e[r[n]]=t[r[n]];return e}}).call(t,r(5),r(0))},function(e,t,r){var n={JSONRPC:r(17)};n.JSONRPC.NodeClusterBase=null,delete n.JSONRPC.NodeClusterBase,e.exports=n},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC=r(17);JSONRPC.Exception=r(2),JSONRPC.Server=r(7),JSONRPC.IncomingRequest=r(18),JSONRPC.EndpointBase=r(6),JSONRPC.RouterBase=r(14),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(10),JSONRPC.Utils=r(3),e.exports=function(e){function BidirectionalWebRTCRouter(){return i(this,BidirectionalWebRTCRouter),o(this,(BidirectionalWebRTCRouter.__proto__||Object.getPrototypeOf(BidirectionalWebRTCRouter)).apply(this,arguments))}return s(BidirectionalWebRTCRouter,e),a(BidirectionalWebRTCRouter,[{key:"addRTCDataChannelSync",value:function(e){var r=this;if("closed"===e.readyState)return void console.log("["+t.pid+"] addRTCDataChannelSync ignoring closed dataChannel.");var i=++this._nConnectionIDCounter,o=JSONRPC.EndpointBase.normalizePath(e.label),s={dataChannel:e,nConnectionID:i,clientReverseCalls:null,clientWebRTCTransportPlugin:null,strEndpointPath:o};return this._objSessions[i]=s,e.addEventListener("message",function(){var e=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r._routeMessage(t.data,s);case 2:case"end":return e.stop()}},e,r)}));return function(t){return e.apply(this,arguments)}}()),e.addEventListener("close",function(e){r.onConnectionEnded(i)}),e.addEventListener("error",function(t){console.error(t),r.onConnectionEnded(i),"open"===e.readyState&&e.close()}),i}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWebRTCTransportPlugin=new JSONRPC.Plugins.Client.WebRTCTransport(t.dataChannel,!0),r.addPlugin(t.clientWebRTCTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var i,o,s,a,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.dataChannel,o=n.nConnectionID,r.trim().length){e.next=5;break}return console.log("["+t.pid+"] WebRTCBidirectionalRouter: Received empty message. Ignoring."),e.abrupt("return");case 5:s=void 0,e.prev=6,s=JSONRPC.Utils.jsonDecodeSafe(r),e.next=18;break;case 10:return e.prev=10,e.t0=e.catch(6),console.error(e.t0),console.error("Unable to parse JSON. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(o)&&null===this._objSessions[o].clientWebRTCTransportPlugin&&"open"===i.readyState&&i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Invalid JSON: "+JSON.stringify(r)+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),console.log("["+t.pid+"] Unclean state. Unable to match RTCDataChannel message to an existing Promise or qualify it as a request or response."),"open"===i.readyState&&i.close(),e.abrupt("return");case 18:if(a=!s.hasOwnProperty("id"),e.prev=19,!s.hasOwnProperty("method")){e.next=45;break}if(this._jsonrpcServer){e.next=24;break}throw a||"open"!==i.readyState||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Server not initialized on this RTCDataChannel. Raw request: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),new Error("JSONRPC.Server not initialized on this RTCDataChannel.");case 24:if(u=new JSONRPC.IncomingRequest,u.connectionID=o,u.router=this,e.prev=27,c=this._objSessions[o].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(c)){e.next=31;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+c+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 31:u.endpoint=this._jsonrpcServer.endpoints[c],u.requestBody=r,u.requestObject=s,e.next=39;break;case 36:e.prev=36,e.t1=e.catch(27),u.callResult=e.t1;case 39:return e.next=41,this._jsonrpcServer.processRequest(u);case 41:"open"!==i.readyState&&console.error("dataChannel.readyState: "+JSON.stringify(i.readyState)+". Request was "+r+". Attempted responding with "+JSON.stringify(u.callResultToBeSerialized,void 0,"\t")+"."),a||i.send(u.callResultSerialized),e.next=60;break;case 45:if(!s.hasOwnProperty("result")&&!s.hasOwnProperty("error")){e.next=58;break}if(!this._objSessions.hasOwnProperty(o)||null!==this._objSessions[o].clientWebRTCTransportPlugin){e.next=50;break}throw this._jsonrpcServer||a||"open"!==i.readyState||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Client not initialized on this RTCConnection. Raw message: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),"open"===i.readyState&&i.close(),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 50:if(!this._objSessions.hasOwnProperty(o)){e.next=55;break}return e.next=53,this._objSessions[o].clientWebRTCTransportPlugin.processResponse(r,s);case 53:e.next=56;break;case 55:console.error("Connection ID "+o+" is closed and session is missing. Ignoring response: "+r);case 56:e.next=60;break;case 58:throw a=!1,new Error("Unable to qualify the message as a JSONRPC request or response.");case 60:e.next=69;break;case 62:return e.prev=62,e.t2=e.catch(19),console.error(e.t2),console.error("Uncaught error. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(o)&&null===this._objSessions[o].clientWebRTCTransportPlugin&&(a||"open"!==i.readyState||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Internal error: "+e.t2.message+".",code:JSONRPC.Exception.INTERNAL_ERROR}},void 0,"\t"))),"open"===i.readyState&&(console.log("["+t.pid+"] Unclean state. Closing data channel."),i.close()),e.abrupt("return");case 69:case"end":return e.stop()}},e,this,[[6,10],[19,62],[27,36]])}));return e}()}]),BidirectionalWebRTCRouter}(JSONRPC.RouterBase)}).call(t,r(0))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC=r(17);JSONRPC.Exception=r(2),JSONRPC.Server=r(7),JSONRPC.IncomingRequest=r(18),JSONRPC.EndpointBase=r(6),JSONRPC.RouterBase=r(14),JSONRPC.Plugins={},JSONRPC.Plugins.Client=r(10),JSONRPC.Utils=r(3),JSONRPC.WebSocketAdapters={},JSONRPC.WebSocketAdapters.WebSocketWrapperBase=r(19),e.exports=function(e){function BidirectionalWebsocketRouter(){return i(this,BidirectionalWebsocketRouter),o(this,(BidirectionalWebsocketRouter.__proto__||Object.getPrototypeOf(BidirectionalWebsocketRouter)).apply(this,arguments))}return s(BidirectionalWebsocketRouter,e),a(BidirectionalWebsocketRouter,[{key:"addWebSocketSync",value:function(e,r){var n=this;if(e.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.CLOSED)return void console.log("["+t.pid+"] addWebSocketSync ignoring closed webSocket.");var i=++this._nConnectionIDCounter,o=JSONRPC.EndpointBase.normalizePath(e.url?e.url:e.upgradeReq?e.upgradeReq.url:r.url),s={webSocket:e,nConnectionID:i,clientReverseCalls:null,clientWebSocketTransportPlugin:null,strEndpointPath:o};this._objSessions[i]=s;var a=function(t){n.onConnectionEnded(i),e.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&e.close(1e3,t.message)};if(e.on)e.on("message",function(e,t){n._routeMessage(e,s)}),e.on("close",function(e,t){n.onConnectionEnded(i)}),e.on("error",a);else{if(!e.addEventListener)throw new Error("Not a supported WebSocket interface.");e.addEventListener("message",function(e){n._routeMessage(e.data,s)}),e.addEventListener("close",function(e){n.onConnectionEnded(i)}),e.addEventListener("error",a)}return i}},{key:"_makeReverseCallsClient",value:function(e,t){var r=new e(t.strEndpointPath);return t.clientWebSocketTransportPlugin=new JSONRPC.Plugins.Client.WebSocketTransport(t.webSocket,!0),r.addPlugin(t.clientWebSocketTransportPlugin),this.emit("madeReverseCallsClient",r),r}},{key:"_routeMessage",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){var i,o,s,a,u,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(i=n.webSocket,o=n.nConnectionID,r.trim().length){e.next=5;break}return console.log("["+t.pid+"] WebSocketBidirectionalRouter: Received empty message. Ignoring."),e.abrupt("return");case 5:s=void 0,e.prev=6,s=JSONRPC.Utils.jsonDecodeSafe(r),e.next=18;break;case 10:return e.prev=10,e.t0=e.catch(6),console.error(e.t0),console.error("Unable to parse JSON. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(o)&&null===this._objSessions[o].clientWebSocketTransportPlugin&&i.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Invalid JSON: "+JSON.stringify(r)+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),console.log("["+t.pid+"] Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request or response."),i.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&i.close(1e3,"Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request or response."),e.abrupt("return");case 18:if(a=!s.hasOwnProperty("id"),e.prev=19,!s.hasOwnProperty("method")){e.next=46;break}if(this._jsonrpcServer){e.next=24;break}throw a||i.readyState!==JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Server not initialized on this WebSocket. Raw request: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),new Error("JSONRPC.Server not initialized on this WebSocket");case 24:if(u=new JSONRPC.IncomingRequest,u.connectionID=o,u.router=this,i.upgradeReq&&(u.headers=i.upgradeReq.headers,u.remoteAddress=i.upgradeReq.socket.remoteAddress,u.localAddress=i.upgradeReq.socket.localAddress),e.prev=28,c=this._objSessions[o].strEndpointPath,this._jsonrpcServer.endpoints.hasOwnProperty(c)){e.next=32;break}throw new JSONRPC.Exception("Unknown JSONRPC endpoint "+c+".",JSONRPC.Exception.METHOD_NOT_FOUND);case 32:u.endpoint=this._jsonrpcServer.endpoints[c],u.requestBody=r,u.requestObject=s,e.next=40;break;case 37:e.prev=37,e.t1=e.catch(28),u.callResult=e.t1;case 40:return e.next=42,this._jsonrpcServer.processRequest(u);case 42:i.readyState!==JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&console.error("webSocket.readyState: "+JSON.stringify(i.readyState)+". Request was "+r+". Attempted responding with "+JSON.stringify(u.callResultToBeSerialized,void 0,"\t")+"."),a||i.send(u.callResultSerialized),e.next=61;break;case 46:if(!s.hasOwnProperty("result")&&!s.hasOwnProperty("error")){e.next=59;break}if(!this._objSessions.hasOwnProperty(o)||null!==this._objSessions[o].clientWebSocketTransportPlugin){e.next=51;break}throw this._jsonrpcServer||a||i.readyState!==JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"JSONRPC.Client not initialized on this WebSocket. Raw message: "+r+".",code:JSONRPC.Exception.PARSE_ERROR}},void 0,"\t")),i.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&i.close(1e3,"How can the client be not initialized, and yet getting responses from phantom requests? Closing websocket."),new Error("How can the client be not initialized, and yet getting responses from phantom requests?");case 51:if(!this._objSessions.hasOwnProperty(o)){e.next=56;break}return e.next=54,this._objSessions[o].clientWebSocketTransportPlugin.processResponse(r,s);case 54:e.next=57;break;case 56:console.error("Connection ID "+o+" is closed and session is missing. Ignoring response: "+r);case 57:e.next=61;break;case 59:throw a=!1,new Error("Unable to qualify the message as a JSONRPC request or response.");case 61:e.next=70;break;case 63:return e.prev=63,e.t2=e.catch(19),console.error(e.t2),console.error("Uncaught error. RAW remote message: "+r),this._jsonrpcServer&&this._objSessions.hasOwnProperty(o)&&null===this._objSessions[o].clientWebSocketTransportPlugin&&(a||i.readyState!==JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN||i.send(JSON.stringify({id:null,jsonrpc:"2.0",error:{message:"Internal error: "+e.t2.message+".",code:JSONRPC.Exception.INTERNAL_ERROR}},void 0,"\t"))),i.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&(console.log("["+t.pid+"] Unclean state. Closing websocket."),i.close(1e3,"Unclean state. Closing websocket.")),e.abrupt("return");case 70:case"end":return e.stop()}},e,this,[[6,10],[19,63],[28,37]])}));return e}()}]),BidirectionalWebsocketRouter}(JSONRPC.RouterBase)}).call(t,r(0))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={Client:r(12)},u=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"workerServicesReady",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpc("workerServicesReady",[t]));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"gracefulExit",value:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpc("gracefulExit",[]));case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"ping",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpc("ping",[t]));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),t}(JSONRPC.Client);e.exports=u},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(23),c=r(67),l=r(1),f=r(23),h=r(86),JSONRPC={EndpointBase:r(6),Server:r(7),Client:r(12),BidirectionalWorkerRouter:r(24),Plugins:{Server:r(25),Client:r(10)}},p=function(e){function r(e){i(this,r),console.log("Fired up "+(u.isWorker?"worker":"master")+" with PID "+t.pid);var n=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"ClusterIPC","/api-cluster/IPC",{},e));if(!u.isMaster)throw new Error("MasterEndpoint can only be instantiated in the master process.");return n._bidirectionalWorkerRouter=null,n._jsonrpcServer=null,n.bShuttingDown=!1,n.arrFailureTimestamps=[],n.objWorkerIDToState={},n._bWorkersStarted=!1,n._bWatchingForUpgrade=!1,n._nMaxWorkersCount=Number.MAX_SAFE_INTEGER,n}return s(r,e),a(r,[{key:"_startServices",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}throw new Error("This mustn't be called through JSONRPC.");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"_stopServices",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}throw new Error("This mustn't be called through JSONRPC.");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"start",value:function(){function e(){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(){var r,i=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bWorkersStarted){e.next=2;break}throw new Error("Workers have already been started.");case 2:return this._bWorkersStarted=!0,this._jsonrpcServer=new JSONRPC.Server,this._jsonrpcServer.addPlugin(new JSONRPC.Plugins.Server.AuthenticationSkip),this._jsonrpcServer.addPlugin(new JSONRPC.Plugins.Server.AuthorizeAll),this._jsonrpcServer.registerEndpoint(this),this._bidirectionalWorkerRouter=new JSONRPC.BidirectionalWorkerRouter(this._jsonrpcServer),u.on("fork",function(){var e=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,i.objWorkerIDToState[r.id]={client:null,ready:!1},console.log("Adding worker ID "+r.id+" to BidirectionalWorkerRouter."),e.next=5,i._bidirectionalWorkerRouter.addWorker(r,i.path,12e4);case 5:n=e.sent,i.objWorkerIDToState[r.id].client=i._bidirectionalWorkerRouter.connectionIDToSingletonClient(n,i.ReverseCallsClientClass),i.emit("workerReady",i.objWorkerIDToState[r.id].client),e.next=15;break;case 10:e.prev=10,e.t0=e.catch(0),console.error(e.t0),console.error("Cluster master process, on fork event handler unexpected error. Don't know how to handle."),t.exit(1);case 15:case"end":return e.stop()}},e,i,[[0,10]])}));return function(t){return e.apply(this,arguments)}}()),u.on("exit",function(){var e=n(regeneratorRuntime.mark(function e(r,n,o){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,console.log("Worker with PID  "+r.process.pid+" died. Exit code: "+n+". Signal: "+o+"."),i.arrFailureTimestamps.push((new Date).getTime()),i.arrFailureTimestamps=i.arrFailureTimestamps.filter(function(e){return e>=(new Date).getTime()-12e4}),!(i.arrFailureTimestamps.length/Math.max(c.cpus().length,1)>4)){e.next=9;break}return e.next=7,i.gracefulExit(null);case 7:e.next=13;break;case 9:if(i.bShuttingDown){e.next=13;break}return e.next=12,h(500);case 12:u.fork();case 13:e.next=20;break;case 15:e.prev=15,e.t0=e.catch(0),console.error(e.t0),console.error("Cluster master process, on worker exit event handler unexpected error. Don't know how to handle. Exiting..."),t.exit(1);case 20:case"end":return e.stop()}},e,i,[[0,15]])}));return function(t,r,n){return e.apply(this,arguments)}}()),e.next=12,this._startServices();case 12:for(r=0;r<Math.min(Math.max(c.cpus().length,1),this._nMaxWorkersCount);r++)u.fork();case 13:case"end":return e.stop()}},e,this)}));return e}()},{key:"watchForUpgrade",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,i,o,s,a,u=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(l("string"==typeof t),!this._bWatchingForUpgrade){e.next=3;break}return e.abrupt("return");case 3:return this._bWatchingForUpgrade=!0,e.t0=JSON,e.next=7,f.readFile(t,"utf8");case 7:return e.t1=e.sent,r=e.t0.parse.call(e.t0,e.t1).version,e.next=11,f.stat(t);case 11:i=e.sent.mtime.getTime(),o=r,s=1e4,a=setInterval(n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.t0=i,e.next=4,f.stat(t);case 4:if(e.t1=e.sent.mtime.getTime(),e.t0===e.t1){e.next=14;break}return e.next=8,f.stat(t);case 8:return i=e.sent.mtime.getTime(),e.t2=JSON,e.next=12,f.readFile(t,"utf8");case 12:e.t3=e.sent,o=e.t2.parse.call(e.t2,e.t3).version;case 14:if(o===r){e.next=19;break}return clearInterval(a),console.log(("\n\t\t\t\t\t\t\tUpdated. \n\t\t\t\t\t\t\tDetected new version "+o+". \n\t\t\t\t\t\t\tOld version "+r+". \n\t\t\t\t\t\t\tAttempting to exit gracefully to allow starting with new version.\n\t\t\t\t\t\t").replace(/^\t+/gm,"")),e.next=19,u.gracefulExit(null);case 19:e.next=24;break;case 21:e.prev=21,e.t4=e.catch(0),console.error(e.t4);case 24:case"end":return e.stop()}},e,u,[[0,21]])})),s);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"workerServicesReady",value:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:this.objWorkerIDToState[r].ready=!0;case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"gracefulExit",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n,i,o,s=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.bShuttingDown){e.next=2;break}return e.abrupt("return");case 2:this.bShuttingDown=!0,n=function(e){u.workers[e].isConnected()&&s.objWorkerIDToState[e].ready?s.objWorkerIDToState[e].client.gracefulExit().then(function(){}).catch(function(t){u.workers.hasOwnProperty(e)&&!u.workers[e].isDead()&&(console.error(t),u.workers[e].kill())}):u.workers[e].isDead()||u.workers[e].kill()};for(i in u.workers)n(i);console.log("Waiting for workers to exit gracefully."),o=!0;case 7:if(!o){e.next=15;break}o=!1;for(i in u.workers)u.workers[i].isDead()||(o=!0);if(!o){e.next=13;break}return e.next=13,h(1e3);case 13:e.next=7;break;case 15:return console.log("All workers have exited."),e.next=18,this._stopServices();case 18:console.log("["+t.pid+"] Master process exiting gracefully."),t.exit(0);case 20:case"end":return e.stop()}},e,this)}));return e}()},{key:"ping",value:function(){function e(e,r){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t,r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return console.log("Worker said: "+JSON.stringify(r)),e.abrupt("return",r);case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"workerClients",get:function(){return this.objWorkerIDToState}}]),r}(JSONRPC.EndpointBase);e.exports=p}).call(t,r(0))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={Client:r(12)},u=function(e){function t(){return i(this,t),o(this,(t.__proto__||Object.getPrototypeOf(t)).apply(this,arguments))}return s(t,e),a(t,[{key:"gracefulExit",value:function(){function e(){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.rpc("gracefulExit",[],!0));case 1:case"end":return e.stop()}},e,this)}));return e}()}]),t}(JSONRPC.Client);e.exports=u},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),u=r(23),JSONRPC={EndpointBase:r(6),Server:r(7),Client:r(12),BidirectionalWorkerRouter:r(24),Plugins:{Server:r(25),Client:r(10)}},c=function(e){function r(e){i(this,r),console.log("Fired up "+(u.isWorker?"worker":"master")+" with PID "+t.pid);var n=o(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,"ClusterIPC","/api-cluster/IPC",{},e));if(u.isMaster)throw new Error("WorkerEndpoint can only be instantiated in a worker process.");return n._bidirectionalWorkerRouter=null,n._jsonrpcServer=null,n._masterClient=null,n.nServicesShutdownTimeoutID=null,n.bShuttingDown=!1,n._bWorkerStarted=!1,n}return s(r,e),a(r,[{key:"_startServices",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}throw new Error("This mustn't be called through JSONRPC.");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"_stopServices",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=2;break}throw new Error("This mustn't be called through JSONRPC.");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"start",value:function(){function e(){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._bWorkerStarted){e.next=2;break}throw new Error("Worker is already started.");case 2:return this._bWorkerStarted=!0,this._jsonrpcServer=new JSONRPC.Server,this._bidirectionalWorkerRouter=new JSONRPC.BidirectionalWorkerRouter(this._jsonrpcServer),this._jsonrpcServer.addPlugin(new JSONRPC.Plugins.Server.AuthenticationSkip),this._jsonrpcServer.addPlugin(new JSONRPC.Plugins.Server.AuthorizeAll),e.next=9,this._bidirectionalWorkerRouter.addWorker(t,"/api-cluster/IPC");case 9:return r=e.sent,this._masterClient=this._bidirectionalWorkerRouter.connectionIDToSingletonClient(r,this.ReverseCallsClientClass),this._jsonrpcServer.registerEndpoint(this),e.next=14,this._masterClient.rpc("rpc.connectToEndpoint",["/api-cluster/IPC"]);case 14:return e.next=16,this._startServices();case 16:return e.next=18,this._masterClient.workerServicesReady(u.worker.id);case 18:case"end":return e.stop()}},e,this)}));return e}()},{key:"gracefulExit",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return this.bShuttingDown=!0,n=3e4,this.nServicesShutdownTimeoutID=setTimeout(function(){console.error(new Error("\n\t\t\t\t\tTimed out waiting for services to shutdown. \n\t\t\t\t\tServices status: \n\t\t\t\t\t\t\n\t\t\t\t".replace(/^\t+/gm,"").trim())),t.exit(1)},n),e.next=5,this._stopServices();case 5:clearTimeout(this.nServicesShutdownTimeoutID),console.log("["+t.pid+"] Worker exiting gracefuly."),t.exit(0);case 8:case"end":return e.stop()}},e,this)}));return e}()},{key:"masterClient",get:function(){if(!this._masterClient)throw new Error("The master client is ready only after calling await .startWorker().");return this._masterClient}}]),r}(JSONRPC.EndpointBase);e.exports=c}).call(t,r(0))},function(e,t,r){"use strict";e.exports={MasterClient:r(42),MasterEndpoint:r(43),WorkerClient:r(44),WorkerEndpoint:r(45)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},o=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),s=r(1),JSONRPC={};JSONRPC.Client=r(12),JSONRPC.Exception=r(2),e.exports=function(){function e(t,r,i){n(this,e),this._strMethod=t,this._arrParams=r,this._requestObject=null,this._mxRequestBody=null,this._mxResponseBody=null,this._responseObject=null,this._mxResult=null,this._strEndpointURL=null,this._objHeaders={},this._bCalled=!1,this._mxCallID=i,Object.seal(this)}return o(e,[{key:"toRequestObject",value:function(){return s(null!==this.methodName,"this.methodName cannot be null."),s(Array.isArray(this.params),"this.params must be an Array."),void 0!==this.callID?{method:this.methodName,params:this.params,id:this.callID,jsonrpc:"2.0"}:{method:this.methodName,params:this.params,jsonrpc:"2.0"}}},{key:"callID",get:function(){return s("number"==typeof this._mxCallID||"string"==typeof this._mxCallID||void 0===this._mxCallID,"this._mxCallID must be of type number."),this._mxCallID}},{key:"isNotification",get:function(){return void 0===this._mxCallID}},{key:"params",get:function(){return this._arrParams},set:function(e){s(Array.isArray(e),"arrParams must be of type Array."),this._arrParams=e}},{key:"methodName",get:function(){return this._strMethod},set:function(e){s("string"==typeof e,"strMethod must be of type string."),this._strMethod=e}},{key:"headers",get:function(){return this._objHeaders}},{key:"endpointURL",get:function(){return this._strEndpointURL},set:function(e){s("string"==typeof e,"strEndpointURL must be of type string."),this._strEndpointURL=e}},{key:"requestObject",get:function(){return this._requestObject},set:function(e){s("object"===(void 0===e?"undefined":i(e))||Array.isArray(e),"objRequest must be of type Object or Array."),s(e.hasOwnProperty("method")||e.hasOwnProperty("params"),JSON.stringify(e),"objRequest must have either a method or params property."),this._requestObject=e}},{key:"requestBody",get:function(){return this._mxRequestBody},set:function(e){this._mxRequestBody=e}},{key:"isMethodCalled",get:function(){return this._bCalled},set:function(e){this._bCalled=e}},{key:"responseBody",get:function(){return this._mxResponseBody},set:function(e){s("string"==typeof e||"object"===(void 0===e?"undefined":i(e)),"mxResponseBody must be of type string or Object."),this._mxResponseBody=e}},{key:"responseObject",get:function(){return this._responseObject},set:function(e){if("object"!==(void 0===e?"undefined":i(e))&&!e.hasOwnProperty("result")&&!e.hasOwnProperty("error"))throw new JSONRPC.Exception("Invalid response structure. RAW response: "+JSON.stringify(this._mxResponseBody,void 0,"\t"),JSONRPC.Exception.PARSE_ERROR);this._responseObject=e}},{key:"callResult",get:function(){return this.isMethodCalled=!0,this._mxResult},set:function(e){this.isMethodCalled=!0,this._mxResult=e}}]),e}()},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var s,a=e[Symbol.iterator]();!(n=(s=a.next()).done)&&(r.push(s.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&a.return&&a.return()}finally{if(i)throw o}}return r}return function(t,r){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return e(t,r);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),e.exports=function(e){function Cache(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;i(this,Cache);var s=o(this,(Cache.__proto__||Object.getPrototypeOf(Cache)).call(this));if("object"!==(void 0===e?"undefined":u(e))||Array.isArray(e))throw new Error("Invalid objFunctionNameToCacheSeconds parameter given.");return Object.entries(e).forEach(function(e){var t=a(e,2),r=t[0],n=t[1];if(n<=0)throw new Error("Invalid cache duration "+n+" given for function "+r+". It must be a number of seconds greater than 0.")}),s._mapFunctionNameToCacheSeconds=new Map(Object.entries(e)),s._bDeepFreeze=t,s._bReturnDeepCopy=r,s._nMaxEntries=n,s.mapCache=new Map,s}return s(Cache,e),c(Cache,[{key:"clear",value:function(){this.mapCache.clear()}},{key:"afterJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isNotification){e.next=2;break}return e.abrupt("return");case 2:this._mapFunctionNameToCacheSeconds.has(t.methodName)&&(r=this.constructor._getCacheKey(t),(this.mapCache.has(r)&&this.mapCache.size>this._nMaxEntries||!this.mapCache.has(r)&&this.mapCache.size>=this._nMaxEntries)&&this.clear(),this.mapCache.has(r)&&(this._isCacheEntryExpired(r)?this.mapCache.delete(r):(t.responseObject={jsonrpc:this.constructor.DEFAULT_JSONRPC_VERSION,result:null,id:t.callID},t.responseBody=JSON.stringify(t.responseObject,void 0,"\t"),t.isMethodCalled=!0)));case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isNotification){e.next=2;break}return e.abrupt("return");case 2:t.methodName&&this._mapFunctionNameToCacheSeconds.has(t.methodName)&&(r=this.constructor._getCacheKey(t),this.mapCache.has(r)?(n=this.mapCache.get(r).value,this._bReturnDeepCopy?(t.responseObject.result=this.constructor._deepCopy(n),this._bDeepFreeze&&this.constructor._deepFreeze(t.responseObject.result)):t.responseObject.result=n):(i=this._mapFunctionNameToCacheSeconds.get(t.methodName),o=1e3*i+Date.now(),this._bDeepFreeze&&!this._bReturnDeepCopy?(this.constructor._deepFreeze(t.responseObject.result),this.mapCache.set(r,{expiresAt:o,value:t.responseObject.result})):(s=this.constructor._deepCopy(t.responseObject.result),this.mapCache.set(r,{expiresAt:o,value:s}),this.bDeepFreeze&&(this.constructor._deepFreeze(s),this.constructor._deepFreeze(t.responseObject.result)))));case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"_isCacheEntryExpired",value:function(e){return!this.mapCache.has(e)||Date.now()>this.mapCache.get(e).expiresAt}}],[{key:"_getCacheKey",value:function(e){return e.methodName+"__"+JSON.stringify(e.params)}},{key:"_deepFreeze",value:function(e){if("object"===(void 0===e?"undefined":u(e)))return Object.getOwnPropertyNames(e).forEach(function(t){var r=e[t];"object"===(void 0===r?"undefined":u(r))&&null!=r&&Cache._deepFreeze(r)}),Object.freeze(e)}},{key:"_deepCopy",value:function(e){return JSON.parse(JSON.stringify(e))}},{key:"DEFAULT_JSONRPC_VERSION",get:function(){return"2.0"}}]),Cache}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),e.exports=function(e){function DebugLogger(){return i(this,DebugLogger),o(this,(DebugLogger.__proto__||Object.getPrototypeOf(DebugLogger)).apply(this,arguments))}return s(DebugLogger,e),a(DebugLogger,[{key:"afterJSONEncode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="string"==typeof r.requestBody?r.requestBody:JSON.stringify(r.requestBody),n.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sent JSONRPC request, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sent JSONRPC request: "+n+"\n");case 2:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){var n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:n="string"==typeof r.responseBody?r.responseBody:JSON.stringify(r.responseBody),n.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC response, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC response: "+n+"\n");case 2:case"end":return e.stop()}},e,this)}));return e}()}]),DebugLogger}(JSONRPC.ClientPluginBase)}).call(t,r(0))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Exception=r(2),e.exports=function(e){function PrettyBrowserConsoleErrors(){return i(this,PrettyBrowserConsoleErrors),o(this,(PrettyBrowserConsoleErrors.__proto__||Object.getPrototypeOf(PrettyBrowserConsoleErrors)).apply(this,arguments))}return s(PrettyBrowserConsoleErrors,e),a(PrettyBrowserConsoleErrors,[{key:"exceptionCatch",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:console.error(t.callResult);case 1:case"end":return e.stop()}},e,this)}));return e}()}]),PrettyBrowserConsoleErrors}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(3);var u=r(97);e.exports=function(e){function ProcessStdIOTransport(e,t){i(this,ProcessStdIOTransport);var r=o(this,(ProcessStdIOTransport.__proto__||Object.getPrototypeOf(ProcessStdIOTransport)).call(this));return r._strEndpointCommand=e,r._strWorkingDirectoryPath=t,r}return s(ProcessStdIOTransport,e),a(ProcessStdIOTransport,[{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:return t.isMethodCalled=!0,r={cwd:this._strWorkingDirectoryPath,maxBuffer:10485760},n=this._strEndpointCommand.trim().split(/[\s]+/,1)[0],i=this._strEndpointCommand.substr(n.length).trim(),o=u.spawn(n,[i],r),e.abrupt("return",new Promise(function(e,r){o.on("close",function(t){o.stdin.end(),e(null)}),t.responseBody="",o.stdout.on("data",function(e){t.responseBody+=e}),o.on("error",function(e){r(e)}),o.stdin.setEncoding("utf-8"),o.stdin.write(t.requestBody)}));case 8:case"end":return e.stop()}},e,this)}));return e}()}]),ProcessStdIOTransport}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4);var u=r(66);e.exports=function(e){function SignatureAdd(e,t){i(this,SignatureAdd);var r=o(this,(SignatureAdd.__proto__||Object.getPrototypeOf(SignatureAdd)).call(this));return r.strAPIKey=e,r._arrExtraURLVariables=t,r.strKeyMetaData=SignatureAdd.getKeyMetaData(e),r}return s(SignatureAdd,e),a(SignatureAdd,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.requestObject.expires=parseInt((new Date).getTime()/1e3+86400,10);case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r,n,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r=new u("SHA-256","TEXT"),r.setHMACKey(this.strAPIKey,"TEXT"),r.update(t.requestBody),n=r.getHMAC("HEX"),null!==this.strKeyMetaData&&(n=this.strKeyMetaData+":"+n),t.endpointURL.indexOf("?")>-1?t.endpointURL+="&":t.endpointURL+="?",-1===t.endpointURL.indexOf("verify")&&(t.endpointURL+="verify="+n),"&"===t.endpointURL.charAt(t.endpointURL.length-1)&&(t.endpointURL=t.endpointURL.slice(0,-1));for(i in this._arrExtraURLVariables)t.endpointURL+="&"+i+"="+this._arrExtraURLVariables[i];case 9:case"end":return e.stop()}},e,this)}));return e}()}],[{key:"getKeyMetaData",value:function(e){var t=null,r=e.split(":",2);return 1!==r.length&&(t=r[0]),t}}]),SignatureAdd}(JSONRPC.ClientPluginBase)},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(3);var u=r(1);e.exports=function(e){function WebRTCTransport(e,t){i(this,WebRTCTransport);var r=o(this,(WebRTCTransport.__proto__||Object.getPrototypeOf(WebRTCTransport)).call(this));return r._objRTCDataChannelRequestsPromises={},r._bBidirectionalWebRTCMode=!!t,r._dataChannel=e,r._setupRTCDataChannel(),r}return s(WebRTCTransport,e),a(WebRTCTransport,[{key:"processResponse",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=11;break}e.prev=1,n=JSONRPC.Utils.jsonDecodeSafe(r),e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(1),console.error(e.t0),console.error("Unable to parse JSON. RAW remote response: "+r),"open"===this._dataChannel.readyState&&this._dataChannel.close(),e.abrupt("return");case 11:if(("number"==typeof n.id||"string"==typeof n.id)&&null!==this._objRTCDataChannelRequestsPromises[n.id]){e.next=17;break}return console.error(new Error("Couldn't find JSONRPC response call ID in this._objRTCDataChannelRequestsPromises. RAW response: "+r)),console.error(new Error("RAW remote message: "+r)),console.log("["+t.pid+"] Unclean state. Unable to match WebRTC message to an existing Promise or qualify it as a request."),"open"===this._dataChannel.readyState&&this.dataChannel.close(1e3,"Unclean state. Unable to match WebRTC message to an existing Promise or qualify it as a request."),e.abrupt("return");case 17:this._objRTCDataChannelRequestsPromises[n.id].outgoingRequest.responseBody=r,this._objRTCDataChannelRequestsPromises[n.id].outgoingRequest.responseObject=n,this._objRTCDataChannelRequestsPromises[n.id].fnResolve(null),delete this._objRTCDataChannelRequestsPromises[n.id];case 21:case"end":return e.stop()}},e,this,[[1,5]])}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if("open"===this.dataChannel.readyState){e.next=4;break}throw new Error("RTCDataChannel not connected.");case 4:if(t.isMethodCalled=!0,t.isNotification||(u("number"==typeof t.requestObject.id||"string"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number or string."),this._objRTCDataChannelRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objRTCDataChannelRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objRTCDataChannelRequestsPromises[t.requestObject.id].fnResolve=e,r._objRTCDataChannelRequestsPromises[t.requestObject.id].fnReject=n})),this.dataChannel.send(t.requestBody),!t.isNotification){e.next=10;break}e.next=11;break;case 10:return e.abrupt("return",this._objRTCDataChannelRequestsPromises[t.requestObject.id].promise);case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WebRTCTransport.");var r=0;for(var n in this._objRTCDataChannelRequestsPromises)this._objRTCDataChannelRequestsPromises[n].fnReject(e),delete this._objRTCDataChannelRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WebRTCTransport.")}},{key:"_setupRTCDataChannel",value:function(){var e=this;this._dataChannel.addEventListener("close",function(t){e.rejectAllPromises(new Error("RTCDataChannel closed."))}),this._dataChannel.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebRTCMode||this._dataChannel.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())}},{key:"dataChannel",get:function(){return this._dataChannel}}]),WebRTCTransport}(JSONRPC.ClientPluginBase)}).call(t,r(0))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(3),JSONRPC.WebSocketAdapters={},JSONRPC.WebSocketAdapters.WebSocketWrapperBase=r(19);var u=r(1);e.exports=function(e){function WebSocketTransport(e,t){i(this,WebSocketTransport);var r=o(this,(WebSocketTransport.__proto__||Object.getPrototypeOf(WebSocketTransport)).call(this));return r._objWebSocketRequestsPromises={},r._bBidirectionalWebSocketMode=!!t,r._webSocket=e,r._setupWebSocket(),r}return s(WebSocketTransport,e),a(WebSocketTransport,[{key:"processResponse",value:function(){function e(e,t){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r,n){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=11;break}e.prev=1,n=JSONRPC.Utils.jsonDecodeSafe(r),e.next=11;break;case 5:return e.prev=5,e.t0=e.catch(1),console.error(e.t0),console.error("Unable to parse JSON. RAW remote response: "+r),this._webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&this._webSocket.close(1e3,"Unable to parse JSON. RAW remote response: "+r),e.abrupt("return");case 11:if(("number"==typeof n.id||"string"==typeof n.id)&&null!==this._objWebSocketRequestsPromises[n.id]){e.next=18;break}return console.error(n),console.error(new Error("Couldn't find JSONRPC response call ID in this._objWebSocketRequestsPromises. RAW response: "+r)),console.error(new Error("RAW remote message: "+r)),console.log("["+t.pid+"] Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request."),this._webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN&&this.webSocket.close(1e3,"Unclean state. Unable to match WebSocket message to an existing Promise or qualify it as a request."),e.abrupt("return");case 18:this._objWebSocketRequestsPromises[n.id].outgoingRequest.responseBody=r,this._objWebSocketRequestsPromises[n.id].outgoingRequest.responseObject=n,this._objWebSocketRequestsPromises[n.id].fnResolve(null),delete this._objWebSocketRequestsPromises[n.id];case 22:case"end":return e.stop()}},e,this,[[1,5]])}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if(this.webSocket.readyState===JSONRPC.WebSocketAdapters.WebSocketWrapperBase.OPEN){e.next=4;break}throw new Error("WebSocket not connected. Current WebSocket readyState: "+JSON.stringify(this.webSocket.readyState));case 4:if(t.isMethodCalled=!0,t.isNotification||(u("number"==typeof t.requestObject.id||"string"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number or string."),this._objWebSocketRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objWebSocketRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objWebSocketRequestsPromises[t.requestObject.id].fnResolve=e,r._objWebSocketRequestsPromises[t.requestObject.id].fnReject=n})),this.webSocket.send(t.requestBody),!t.isNotification){e.next=10;break}e.next=11;break;case 10:return e.abrupt("return",this._objWebSocketRequestsPromises[t.requestObject.id].promise);case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WebSocketTransport.");var r=0;for(var n in this._objWebSocketRequestsPromises)this._objWebSocketRequestsPromises[n].fnReject(e),delete this._objWebSocketRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WebSocketTransport.")}},{key:"_setupWebSocket",value:function(){var e=this;this._webSocket.addEventListener?(this._webSocket.addEventListener("close",function(t){e.rejectAllPromises(new Error("WebSocket closed. Code: "+JSON.stringify(t.code)+". Message: "+JSON.stringify(t.reason)+". wasClean: "+JSON.stringify(t.wasClean)))}),this._webSocket.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebSocketMode||this._webSocket.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())):(this._webSocket.on("close",function(t,r,n){e.rejectAllPromises(new Error("WebSocket closed. Code: "+JSON.stringify(t)+". Message: "+JSON.stringify(r)))}),this._webSocket.on("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWebSocketMode||this._webSocket.on("message",function(){var t=n(regeneratorRuntime.mark(function t(r,n){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r);case 2:case"end":return t.stop()}},t,e)}));return function(e,r){return t.apply(this,arguments)}}()))}},{key:"webSocket",get:function(){return this._webSocket}}]),WebSocketTransport}(JSONRPC.ClientPluginBase)}).call(t,r(0))},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ClientPluginBase=r(4),JSONRPC.Utils=r(3);var u=r(1);e.exports=function(e){function WorkerTransport(e,t){i(this,WorkerTransport);var r=o(this,(WorkerTransport.__proto__||Object.getPrototypeOf(WorkerTransport)).call(this));return r._objWorkerRequestsPromises={},r._bBidirectionalWorkerMode=!!t,r._worker=e,r._setupWorker(),r}return s(WorkerTransport,e),a(WorkerTransport,[{key:"beforeJSONEncode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.requestBody=t.requestObject;case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"processResponse",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(("number"==typeof r.id||"string"==typeof r.id)&&null!==this._objWorkerRequestsPromises[r.id]){e.next=6;break}return console.error(new Error("Couldn't find JSONRPC response call ID in this._objWorkerRequestsPromises. RAW response: "+JSON.stringify(r))),console.error(new Error("RAW remote message: "+JSON.stringify(r))),console.log("["+t.pid+"] Unclean state. Unable to match Worker message to an existing Promise or qualify it as a request."),this.worker.terminate?this.worker.terminate():this.worker!==t&&this.worker.kill(),e.abrupt("return");case 6:this._objWorkerRequestsPromises[r.id].outgoingRequest.responseBody=r,this._objWorkerRequestsPromises[r.id].outgoingRequest.responseObject=r,this._objWorkerRequestsPromises[r.id].fnResolve(null),delete this._objWorkerRequestsPromises[r.id];case 10:case"end":return e.stop()}},e,this)}));return e}()},{key:"makeRequest",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){var r=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!t.isMethodCalled){e.next=2;break}return e.abrupt("return");case 2:if(!this.worker.isDead||!this.worker.isDead()){e.next=4;break}throw new Error("Worker not connected.");case 4:if(t.isMethodCalled=!0,t.isNotification||(u("number"==typeof t.requestObject.id||"string"==typeof t.requestObject.id,"outgoingRequest.requestObject.id must be of type number or string."),this._objWorkerRequestsPromises[t.requestObject.id]={outgoingRequest:t,promise:null},this._objWorkerRequestsPromises[t.requestObject.id].promise=new Promise(function(e,n){r._objWorkerRequestsPromises[t.requestObject.id].fnResolve=e,r._objWorkerRequestsPromises[t.requestObject.id].fnReject=n})),this.worker.postMessage?this.worker.postMessage(t.requestObject):this.worker.send(t.requestObject),!t.isNotification){e.next=10;break}e.next=11;break;case 10:return e.abrupt("return",this._objWorkerRequestsPromises[t.requestObject.id].promise);case 11:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}},e,this)}));return e}()},{key:"rejectAllPromises",value:function(e){console.log("["+t.pid+"] Rejecting all Promise instances in WorkerTransport.");var r=0;for(var n in this._objWorkerRequestsPromises)this._objWorkerRequestsPromises[n].fnReject(e),delete this._objWorkerRequestsPromises[n],r++;r&&console.error("["+t.pid+"] Rejected "+r+" Promise instances in WorkerTransport.")}},{key:"_setupWorker",value:function(){var e=this;this._worker.addEventListener?(this._worker.addEventListener("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWorkerMode||this._worker.addEventListener("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r.data);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}())):(this._worker.on("exit",function(t,r){e.rejectAllPromises(new Error("Worker closed. Code: "+JSON.stringify(t)+". Signal: "+JSON.stringify(r)))}),this._worker.on("error",function(t){e.rejectAllPromises(t)}),this._bBidirectionalWorkerMode||this._worker.on("message",function(){var t=n(regeneratorRuntime.mark(function t(r){return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.processResponse(r);case 2:case"end":return t.stop()}},t,e)}));return function(e){return t.apply(this,arguments)}}()))}},{key:"worker",get:function(){return this._worker}}]),WorkerTransport}(JSONRPC.ClientPluginBase)}).call(t,r(0))},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(15),e.exports=function(e){function AuthenticationSkip(){return i(this,AuthenticationSkip),o(this,(AuthenticationSkip.__proto__||Object.getPrototypeOf(AuthenticationSkip)).apply(this,arguments))}return s(AuthenticationSkip,e),a(AuthenticationSkip,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthenticated=!0;case 1:case"end":return e.stop()}},e,this)}));return e}()}]),AuthenticationSkip}(JSONRPC.ServerPluginBase)},function(e,t,r){"use strict";function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(15),e.exports=function(e){function AuthenticationSkip(){return i(this,AuthenticationSkip),o(this,(AuthenticationSkip.__proto__||Object.getPrototypeOf(AuthenticationSkip)).apply(this,arguments))}return s(AuthenticationSkip,e),a(AuthenticationSkip,[{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=n(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.isAuthorized=!0;case 1:case"end":return e.stop()}},e,this)}));return e}()}]),AuthenticationSkip}(JSONRPC.ServerPluginBase)},function(e,t,r){"use strict";(function(t){function n(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function o(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function s(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(15),e.exports=function(e){function DebugLogger(){return i(this,DebugLogger),o(this,(DebugLogger.__proto__||Object.getPrototypeOf(DebugLogger)).apply(this,arguments))}return s(DebugLogger,e),a(DebugLogger,[{key:"beforeJSONDecode",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.requestBody.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC request at endpoint path "+r.endpoint.path+", "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Received JSONRPC request at endpoint path "+r.endpoint.path+": "+r.requestBody+"\n");case 1:case"end":return e.stop()}},e,this)}));return e}()},{key:"afterSerialize",value:function(){function e(e){return r.apply(this,arguments)}var r=n(regeneratorRuntime.mark(function e(r){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:r.requestBody.length>1048576?console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sending JSONRPC response, "+r.requestObject.method+"(). Larger than 1 MB, not logging. \n"):console.log("["+t.pid+"] ["+(new Date).toISOString()+"] Sending JSONRPC response: "+r.callResultSerialized+"\n");case 1:case"end":return e.stop()}},e,this)}));return e}()}]),DebugLogger}(JSONRPC.ServerPluginBase)}).call(t,r(0))},function(e,t,r){"use strict";(function(t){function n(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e){return function(){var t=e.apply(this,arguments);return new Promise(function(e,r){function n(i,o){try{var s=t[i](o),a=s.value}catch(e){return void r(e)}if(!s.done)return Promise.resolve(a).then(function(e){n("next",e)},function(e){n("throw",e)});e(a)}return n("next")})}}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},c=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),JSONRPC={};JSONRPC.ServerPluginBase=r(15),JSONRPC.Exception=r(2);var l=r(1),f=r(95),h=r(26),p=r(63),URLPublic=function(e){function URLPublic(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:URLPublic.COMPRESSION_TYPE_ZLIB;o(this,URLPublic);var r=s(this,(URLPublic.__proto__||Object.getPrototypeOf(URLPublic)).call(this));return URLPublic.validateEncryptionKeys(e),r._objKeys=e,r._strCompressionType=t,Object.seal(r),r}return a(URLPublic,e),c(URLPublic,[{key:"URLRequestGenerate",value:function(){function e(e,r,n){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,r,i){var o,s,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,u=arguments.length>4&&void 0!==arguments[4]?arguments[4]:URLPublic.MODE_AES_128;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o={},n(o,this.constructor.REQUEST_PARAM_NAME_METHOD,r),n(o,this.constructor.REQUEST_PARAM_NAME_PARAMS,i),s=o,null!==a&&(l(Number.isInteger(a),"Invalid nMaxAgeSeconds parameter for URLRequestGenerate. Expected Integer, but got "+JSON.stringify(a)+"."),s[this.constructor.REQUEST_PARAM_NAME_EXPIRE]=parseInt((new Date).getTime()/1e3,10)+a),e.abrupt("return",this.JSONRequestToPublicURL(t,JSON.stringify(s),u));case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"JSONRequestToPublicURL",value:function(){function e(e,r){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t,r){var n,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:URLPublic.MODE_AES_128;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:l("string"==typeof r,'Invalid parameter type for strJSONRequest. Expected "string", but got "'+(void 0===r?"undefined":u(r))+'" value '+JSON.stringify(r)+"."),n=null,e.t0=i,e.next=e.t0===this.constructor.MODE_AES_128?5:e.t0===this.constructor.MODE_BASE64?9:e.t0===this.constructor.MODE_PLAIN?13:17;break;case 5:return e.next=7,this.JSONRequestToURLEncryptedParams(r);case 7:return n=e.sent,e.abrupt("break",18);case 9:return e.next=11,this.JSONRequestToURLBase64Params(r);case 11:return n=e.sent,e.abrupt("break",18);case 13:return e.next=15,this.JSONRequestToURLPlainParams(r);case 15:return n=e.sent,e.abrupt("break",18);case 17:throw new JSONRPC.Exception("Unhandled encryption mode "+JSON.stringify(i)+".");case 18:return l(null!==n,"Invalid objPublicRequest: "+JSON.stringify(n)+"."),i!==this.constructor.MODE_DEFAULT&&(n[this.constructor.URL_PARAM_NAME_MODE]=i),t.includes("?")?t+="&":t+="?",t+=h.stringify(n),e.abrupt("return",t);case 23:case"end":return e.stop()}},e,this)}));return e}()},{key:"JSONRequestToURLEncryptedParams",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var r,i,o,s;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.JSONRequestSignatureAndIV(t,this._activeKeyIndex),e.next=3,this.URLParamEncrypt(t,i);case 3:return o=e.sent,r={},n(r,this._activeKeyIndex,this.constructor.base64URLEscape(o)),n(r,this.constructor.URL_PARAM_NAME_VERIFY,this.constructor.base64URLEscape(i.toString("base64"))),s=r,e.abrupt("return",s);case 6:case"end":return e.stop()}},e,this)}));return e}()},{key:"JSONRequestToURLPlainParams",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var r,i,o;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.JSONRequestSignatureAndIV(t,this._activeKeyIndex),r={},n(r,this._activeKeyIndex,t),n(r,this.constructor.URL_PARAM_NAME_VERIFY,this.constructor.base64URLEscape(i.toString("base64"))),o=r,e.abrupt("return",o);case 3:case"end":return e.stop()}},e,this)}));return e}()},{key:"JSONRequestToURLBase64Params",value:function(){function e(e){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r){var i,o,s,a,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.JSONRequestSignatureAndIV(r,this._activeKeyIndex),s=void 0,e.next=4,this.constructor.compress(t.from(r),this.compressionType);case 4:return s=e.sent,l(void 0!==s,"Invalid type for bufferCompresedData after compress."),a=s.toString("base64"),i={},n(i,this._activeKeyIndex,this.constructor.base64URLEscape(a)),n(i,this.constructor.URL_PARAM_NAME_VERIFY,this.constructor.base64URLEscape(o.toString("base64"))),u=i,e.abrupt("return",u);case 9:case"end":return e.stop()}},e,this)}));return e}()},{key:"beforeJSONDecode",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var r,n;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if("GET"===t.requestHTTPMethod&&"object"===u(t.requestHTTPGetQuery)&&null!==t.requestHTTPGetQuery){e.next=2;break}return e.abrupt("return");case 2:return e.next=4,this.PublicURLParamsToJSONRequest(t.requestHTTPGetQuery);case 4:r=e.sent,n=null,e.prev=6,n=JSON.parse(r),e.next=14;break;case 10:throw e.prev=10,e.t0=e.catch(6),console.error(e.t0),new JSONRPC.Exception("Failed to decode URL request.");case 14:if(n.id=null,n.jsonrpc=this.constructor.DEFAULT_JSONRPC_VERSION,n.method=n[this.constructor.REQUEST_PARAM_NAME_METHOD],n.params=n[this.constructor.REQUEST_PARAM_NAME_PARAMS],delete n[this.constructor.REQUEST_PARAM_NAME_METHOD],delete n[this.constructor.REQUEST_PARAM_NAME_PARAMS],!n.hasOwnProperty[this.constructor.REQUEST_PARAM_NAME_EXPIRE]){e.next=25;break}if(n.expires=n[this.constructor.REQUEST_PARAM_NAME_EXPIRE],delete n[this.constructor.REQUEST_PARAM_NAME_EXPIRE],!(n.expires<parseInt((new Date).getTime()/1e3,10))){e.next=25;break}throw new JSONRPC.Exception('Replay attack prevention. Request is past "expires" timestamp.',JSONRPC.Exception.REQUEST_EXPIRED);case 25:t.isAuthenticated=!0,t.isAuthorized=!0,t.requestBody=JSON.stringify(n);case 28:case"end":return e.stop()}},e,this,[[6,10]])}));return e}()},{key:"URLParamDecrypt",value:function(){function e(e,t,n){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r,n,i){var o,s,a,c,h,p,d,b;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l("string"==typeof i,"strEncryptionKeyIndex must be of type string."),l("string"==typeof r,'Invalid parameter type for strBase64Data in URLParamDecrypt. Expected "string" but got '+(void 0===r?"undefined":u(r))+"."),o=null,s=r.substr(0,this.constructor.BROTLI_PREFIX.length)===this.constructor.BROTLI_PREFIX,a=r.substr(0,this.constructor.NONE_PREFIX.length)===this.constructor.NONE_PREFIX,c=void 0,c=s?t.from(r.substr(this.constructor.BROTLI_PREFIX.length),"base64"):a?t.from(r.substr(this.constructor.NONE_PREFIX.length),"base64"):t.from(r,"base64"),h=f.cipher.createDecipher("AES-CBC",this._keys[i].aes_key),h.start({iv:f.util.createBuffer(n)}),h.update(f.util.createBuffer(c)),h.finish(),p=t.from(h.output.getBytes(),"binary"),d=this.constructor.COMPRESSION_TYPE_ZLIB,s?d=this.constructor.COMPRESSION_TYPE_BROTLI:a&&(d=this.constructor.NONE),e.next=16,this.constructor.decompress(p,d);case 16:return o=e.sent,l(o instanceof t,'Invalid decompress return type for URLParamDecrypt. Expected "buffer" but got '+(void 0===o?"undefined":u(o))+"."),b=o.toString(),l("string"==typeof b,'Invalid return type for URLParamDecrypt. Expected "string" but got '+(void 0===b?"undefined":u(b))+"."),e.abrupt("return",b);case 21:case"end":return e.stop()}},e,this)}));return e}()},{key:"URLParamDecode",value:function(){function e(e){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r){var n,i,o,s,a,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l("string"==typeof r,'Invalid parameter type for strJSONRequest in URLParamDecode. Expected "string" but got '+(void 0===r?"undefined":u(r))+"."),n=r.substr(0,this.constructor.BROTLI_PREFIX.length)===this.constructor.BROTLI_PREFIX,i=r.substr(0,this.constructor.NONE_PREFIX.length)===this.constructor.NONE_PREFIX,o=void 0,s=null,o=n?t.from(r.substr(this.constructor.BROTLI_PREFIX.length),"base64"):i?t.from(r.substr(this.constructor.NONE_PREFIX.length),"base64"):t.from(r,"base64"),a=this.constructor.COMPRESSION_TYPE_ZLIB,n?a=this.constructor.COMPRESSION_TYPE_BROTLI:i&&(a=this.constructor.NONE),e.next=10,this.constructor.decompress(o,a);case 10:return s=e.sent,l(s instanceof t,'Invalid decompress return type for URLParamDecode. Expected "buffer" but got '+(void 0===s?"undefined":u(s))+"."),c=s.toString(),l("string"==typeof c,'Invalid return type for URLParamDecode. Expected "string" but got '+(void 0===c?"undefined":u(c))+"."),e.abrupt("return",c);case 15:case"end":return e.stop()}},e,this)}));return e}()},{key:"URLParamEncrypt",value:function(){function e(e,t){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r,n){var i,o,s,a,c,h,p;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return l("string"==typeof r,'Invalid parameter type for strJSONRequest in URLParamEncrypt. Expected "string" but got '+(void 0===r?"undefined":u(r))+"."),i=void 0,e.next=4,this.constructor.compress(r,this.compressionType);case 4:return o=e.sent,l(o instanceof t,"Failed to compress data before encryption."+JSON.stringify(o)),s=f.cipher.createCipher("AES-CBC",this._keys[this._activeKeyIndex].aes_key),s.start({iv:f.util.createBuffer(n)}),s.update(f.util.createBuffer(o)),s.finish(),i=t.from(s.output.getBytes(),"binary"),l(void 0!==i&&null!==i&&i instanceof t,"Failed to encrypt data."),a=i.toString("base64"),l("string"==typeof a,'Invalid return type for URLParamEncrypt. Expected "string" but got '+(void 0===a?"undefined":u(a))+"."),a=this.constructor.getPreffixForCompressionType(this.compressionType)+a,e.next=17,this.URLParamDecrypt(a,n,this._activeKeyIndex);case 17:if(c=e.sent,h=f.md.md5.create(),h.update(c),p=f.md.md5.create(),p.update(r),h.digest().toHex()===p.digest().toHex()){e.next=24;break}throw new Error("Encrypted data failed decryption test.");case 24:return e.abrupt("return",a);case 25:case"end":return e.stop()}},e,this)}));return e}()},{key:"PublicURLParamsToJSONRequest",value:function(){function e(e){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r){var n,i,o,s,a,u=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.prev=0,e.t0=regeneratorRuntime.keys(this._keys);case 2:if((e.t1=e.t0()).done){e.next=36;break}if(n=e.t1.value,!this._keys[n].compromised){e.next=6;break}return e.abrupt("continue",2);case 6:if(!(n in r)){e.next=34;break}if(r[n]=r[n].replace(" ","+"),this.constructor.URL_PARAM_NAME_VERIFY in r){e.next=10;break}throw new JSONRPC.Exception('URLPublic: Missing "'+this.constructor.URL_PARAM_NAME_VERIFY+'" URL parameter required for verifying the URL.',JSONRPC.Exception.NOT_AUTHENTICATED);case 10:if(i=t.from(this.constructor.base64URLUnescape(r[this.constructor.URL_PARAM_NAME_VERIFY]),"base64"),o=this.constructor.URL_PARAM_NAME_MODE in r?parseInt(r[this.constructor.URL_PARAM_NAME_MODE],10):this.constructor.MODE_DEFAULT,this.allowedEncryptionModes.includes(o)){e.next=14;break}throw new JSONRPC.Exception("Encryption mode not allowed.");case 14:s=null,e.t2=o,e.next=e.t2===this.constructor.MODE_AES_128?18:e.t2===this.constructor.MODE_BASE64?22:e.t2===this.constructor.MODE_PLAIN?26:28;break;case 18:return e.next=20,this.URLParamDecrypt(this.constructor.base64URLUnescape(r[n]),i,n);case 20:return s=e.sent,e.abrupt("break",29);case 22:return e.next=24,this.URLParamDecode(this.constructor.base64URLUnescape(r[n]));case 24:return s=e.sent,e.abrupt("break",29);case 26:return s=r[n],e.abrupt("break",29);case 28:throw new JSONRPC.Exception("Unhandled encryption mode "+JSON.stringify(o)+".");case 29:if(l("string"==typeof s,"Invalid strJSONRequest after decoding."),a=this.JSONRequestSignatureAndIV(s,n),a.equals(i)){e.next=33;break}throw new JSONRPC.Exception("Authentication failure. Verify hash incorrect.",JSONRPC.Exception.NOT_AUTHENTICATED);case 33:return e.abrupt("return",s);case 34:e.next=2;break;case 36:throw new JSONRPC.Exception("Invalid params.");case 39:if(e.prev=39,e.t3=e.catch(0),!u){e.next=43;break}return e.abrupt("return",JSON.stringify({}));case 43:throw e.t3;case 44:case"end":return e.stop()}},e,this,[[0,39]])}));return e}()},{key:"JSONRequestSignatureAndIV",value:function(e,r){l("string"==typeof e,'Invalid parameter type for JSONRequestSignatureAndIV. Expecting "string", but got "'+(void 0===e?"undefined":u(e))+'".'),l("string"==typeof r,"strActiveKeyIndex needs to be of type string.");var n=f.hmac.create();return n.start(this.constructor.HMAC_ALGORITHM,this._keys[r].salt),n.update(e),t.from(n.digest().getBytes(),"binary")}},{key:"allowedEncryptionModes",get:function(){return[this.constructor.MODE_AES_128]}},{key:"compressionType",get:function(){return this._strCompressionType},set:function(e){l("string"==typeof e,'Invalid property type for compressionType in URLPublic. Expected "string", but got '+("undefined"==typeof strCompressionEnabled?"undefined":u(strCompressionEnabled))+"."),l(this.constructor.allowedCompressionTypes.includes(e),'Invalid compression type "'+e+'". Allowed ones are: '+JSON.stringify(this.constructor.allowedCompressionTypes)),this._strCompressionType=e}},{key:"_activeKeyIndex",get:function(){return this._objKeys.active_index}},{key:"_keys",get:function(){return this._objKeys.keys}}],[{key:"base64URLEscape",value:function(e){return l("string"==typeof e,'Invalid parameter type for base64URLEscape. Expecting "string", but got "'+(void 0===e?"undefined":u(e))+'".'),e.replace("+","-").replace("/","_").replace("=","")}},{key:"base64URLUnescape",value:function(e){return l("string"==typeof e,'Invalid parameter type for base64URLEscape. Expecting "string", but got "'+(void 0===e?"undefined":u(e))+'".'),e.replace("-","+").replace("_","/")}},{key:"compress",value:function(){function e(e){return r.apply(this,arguments)}var r=i(regeneratorRuntime.mark(function e(r){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:URLPublic.COMPRESSION_TYPE_ZLIB;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=n,e.next=e.t0===this.COMPRESSION_TYPE_BROTLI?3:e.t0===this.COMPRESSION_TYPE_ZLIB?4:e.t0===this.NONE?5:6;break;case 3:throw new Error("Brotli compression is not supported yet.");case 4:return e.abrupt("return",new Promise(function(e,t){p.deflate(r,function(r,n){if(r)return t(r);e(n)})}));case 5:return e.abrupt("return",t.from(r));case 6:throw new Error('Invalid compression type "'+n+'" for compress. Allowed ones are: '+JSON.stringify(this.allowedCompressionTypes));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"decompress",value:function(){function e(e){return t.apply(this,arguments)}var t=i(regeneratorRuntime.mark(function e(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:URLPublic.COMPRESSION_TYPE_ZLIB;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:e.t0=r,e.next=e.t0===this.COMPRESSION_TYPE_BROTLI?3:e.t0===this.COMPRESSION_TYPE_ZLIB?4:e.t0===this.NONE?5:6;break;case 3:throw new Error("Brotli decompression is not supported yet.");case 4:return e.abrupt("return",new Promise(function(e,r){p.inflate(t,function(t,n){if(t)return r(t);e(n)})}));case 5:return e.abrupt("return",t);case 6:throw new Error('Invalid compression type "'+r+'" for decompress. Allowed ones are: '+JSON.stringify(this.allowedCompressionTypes));case 7:case"end":return e.stop()}},e,this)}));return e}()},{key:"getPreffixForCompressionType",value:function(e){switch(e){case this.COMPRESSION_TYPE_BROTLI:return this.BROTLI_PREFIX;case this.NONE:return this.NONE_PREFIX;default:return""}}},{key:"validateEncryptionKeys",value:function(e){l("object"===(void 0===e?"undefined":u(e))&&null!==e,"objKeys needs to be of type Object."),l("object"===u(e.keys)&&null!==e.keys,"objKeys.keys needs to be of type Object."),l("string"==typeof e.active_index,"objKeys.active_index needs to be of type string.");for(var t in e.keys)if(l("object"===u(e.keys[t]),"objKeys.keys[strIndex] needs to be of type Object."),l("string"==typeof e.keys[t].aes_key,"objKeys.keys[strIndex].aes_key needs to be of type string."),l("string"==typeof e.keys[t].salt,"objKeys.keys[strIndex].salt needs to be of type string."),l(e.keys[t].salt.length>=30,"objKeys.keys["+JSON.stringify(t)+"].salt needs to have at least 30 characters."),l("string"==typeof e.keys[t].created,"objKeys.keys[strIndex].created needs to be of type string."),![16,24,32].includes(e.keys[t].aes_key.length))throw new Error("(JSONRPC.Plugins.Server.URLPublic) Invalid AES key with index "+JSON.stringify(t)+". The AES key must have 16, 24 or 32 hex characters, but found "+e[t].aes_key.length+" characters.")}},{key:"allowedCompressionTypes",get:function(){return[this.COMPRESSION_TYPE_ZLIB,this.NONE]}},{key:"URL_PARAM_NAME_VERIFY",get:function(){return"v"}},{key:"URL_PARAM_NAME_MODE",get:function(){return"m"}},{key:"REQUEST_PARAM_NAME_METHOD",get:function(){return"m"}},{key:"REQUEST_PARAM_NAME_PARAMS",get:function(){return"p"}},{key:"REQUEST_PARAM_NAME_EXPIRE",get:function(){return"e"}},{key:"MODE_DEFAULT",get:function(){return this.MODE_AES_128}},{key:"MODE_AES_128",get:function(){return 0}},{key:"MODE_PLAIN",get:function(){return 1}},{key:"MODE_BASE64",get:function(){return 2}},{key:"HMAC_ALGORITHM",get:function(){return"md5"}},{key:"BROTLI_PREFIX",get:function(){return"br."}},{key:"NONE_PREFIX",get:function(){return"no."}},{key:"COMPRESSION_TYPE_ZLIB",get:function(){return"zlib"}},{key:"COMPRESSION_TYPE_BROTLI",get:function(){return"brotli"}},{key:"NONE",get:function(){return"none"}},{key:"DEFAULT_JSONRPC_VERSION",get:function(){return"2.0"}}]),URLPublic}(JSONRPC.ServerPluginBase);e.exports=URLPublic}).call(t,r(8).Buffer)},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),a=function e(t,r,n){null===t&&(t=Function.prototype);var i=Object.getOwnPropertyDescriptor(t,r);if(void 0===i){var o=Object.getPrototypeOf(t);return null===o?void 0:e(o,r,n)}if("value"in i)return i.value;var s=i.get;if(void 0!==s)return s.call(n)},WebSocketWrapperBase=r(19);e.exports=function(e){function WebSocketWrapper(e,t){n(this,WebSocketWrapper);var r=i(this,(WebSocketWrapper.__proto__||Object.getPrototypeOf(WebSocketWrapper)).call(this,e));return r._strURL="string"==typeof t?t:e.url?e.url:e.upgradeReq.url,r.objListeningFor={},e.upgradeReq?r._objUpgradeReq=e.upgradeReq:r._objUpgradeReq=void 0,r}return o(WebSocketWrapper,e),s(WebSocketWrapper,[{key:"on",value:function(e,t){var r=this;if(a(WebSocketWrapper.prototype.__proto__||Object.getPrototypeOf(WebSocketWrapper.prototype),"superOn",this).call(this,e,t),!this.objListeningFor[e])return this.objListeningFor[e]=!0,this._webSocket.on(e,function(){for(var t=arguments.length,n=Array(t),i=0;i<t;i++)n[i]=arguments[i];r.emit.apply(r,[e].concat(n))})}},{key:"url",get:function(){return this._strURL}},{key:"upgradeReq",get:function(){return this._objUpgradeReq}}]),WebSocketWrapper}(WebSocketWrapperBase)},function(e,t,r){"use strict";function n(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===e[t-2]?2:"="===e[t-1]?1:0}function i(e){return 3*e.length/4-n(e)}function o(e){var t,r,i,o,s,a=e.length;o=n(e),s=new f(3*a/4-o),r=o>0?a-4:a;var u=0;for(t=0;t<r;t+=4)i=l[e.charCodeAt(t)]<<18|l[e.charCodeAt(t+1)]<<12|l[e.charCodeAt(t+2)]<<6|l[e.charCodeAt(t+3)],s[u++]=i>>16&255,s[u++]=i>>8&255,s[u++]=255&i;return 2===o?(i=l[e.charCodeAt(t)]<<2|l[e.charCodeAt(t+1)]>>4,s[u++]=255&i):1===o&&(i=l[e.charCodeAt(t)]<<10|l[e.charCodeAt(t+1)]<<4|l[e.charCodeAt(t+2)]>>2,s[u++]=i>>8&255,s[u++]=255&i),s}function s(e){return c[e>>18&63]+c[e>>12&63]+c[e>>6&63]+c[63&e]}function a(e,t,r){for(var n,i=[],o=t;o<r;o+=3)n=(e[o]<<16)+(e[o+1]<<8)+e[o+2],i.push(s(n));return i.join("")}function u(e){for(var t,r=e.length,n=r%3,i="",o=[],s=0,u=r-n;s<u;s+=16383)o.push(a(e,s,s+16383>u?u:s+16383));return 1===n?(t=e[r-1],i+=c[t>>2],i+=c[t<<4&63],i+="=="):2===n&&(t=(e[r-2]<<8)+e[r-1],i+=c[t>>10],i+=c[t>>4&63],i+=c[t<<2&63],i+="="),o.push(i),o.join("")}t.byteLength=i,t.toByteArray=o,t.fromByteArray=u;for(var c=[],l=[],f="undefined"!=typeof Uint8Array?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",p=0,d=h.length;p<d;++p)c[p]=h[p],l[h.charCodeAt(p)]=p;l["-".charCodeAt(0)]=62,l["_".charCodeAt(0)]=63},function(e,t,r){"use strict";(function(e,n){function i(e){if("number"!=typeof e||e<t.DEFLATE||e>t.UNZIP)throw new TypeError("Bad argument");this.dictionary=null,this.err=0,this.flush=0,this.init_done=!1,this.level=0,this.memLevel=0,this.mode=e,this.strategy=0,this.windowBits=0,this.write_in_progress=!1,this.pending_close=!1,this.gzip_id_bytes_read=0}var o=r(1),s=r(75),a=r(69),u=r(71),c=r(68);for(var l in c)t[l]=c[l];t.NONE=0,t.DEFLATE=1,t.INFLATE=2,t.GZIP=3,t.GUNZIP=4,t.DEFLATERAW=5,t.INFLATERAW=6,t.UNZIP=7;i.prototype.close=function(){if(this.write_in_progress)return void(this.pending_close=!0);this.pending_close=!1,o(this.init_done,"close before init"),o(this.mode<=t.UNZIP),this.mode===t.DEFLATE||this.mode===t.GZIP||this.mode===t.DEFLATERAW?a.deflateEnd(this.strm):this.mode!==t.INFLATE&&this.mode!==t.GUNZIP&&this.mode!==t.INFLATERAW&&this.mode!==t.UNZIP||u.inflateEnd(this.strm),this.mode=t.NONE,this.dictionary=null},i.prototype.write=function(e,t,r,n,i,o,s){return this._write(!0,e,t,r,n,i,o,s)},i.prototype.writeSync=function(e,t,r,n,i,o,s){return this._write(!1,e,t,r,n,i,o,s)},i.prototype._write=function(r,i,s,a,u,c,l,f){if(o.equal(arguments.length,8),o(this.init_done,"write before init"),o(this.mode!==t.NONE,"already finalized"),o.equal(!1,this.write_in_progress,"write already in progress"),o.equal(!1,this.pending_close,"close is pending"),this.write_in_progress=!0,o.equal(!1,void 0===i,"must provide flush value"),this.write_in_progress=!0,i!==t.Z_NO_FLUSH&&i!==t.Z_PARTIAL_FLUSH&&i!==t.Z_SYNC_FLUSH&&i!==t.Z_FULL_FLUSH&&i!==t.Z_FINISH&&i!==t.Z_BLOCK)throw new Error("Invalid flush value");if(null==s&&(s=e.alloc(0),u=0,a=0),this.strm.avail_in=u,this.strm.input=s,this.strm.next_in=a,this.strm.avail_out=f,this.strm.output=c,this.strm.next_out=l,this.flush=i,r){var h=this;return n.nextTick(function(){h._process(),h._after()}),this}if(this._process(),this._checkError())return this._afterSync()},i.prototype._afterSync=function(){var e=this.strm.avail_out,t=this.strm.avail_in;return this.write_in_progress=!1,[t,e]},i.prototype._process=function(){var e=null;switch(this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=a.deflate(this.strm,this.flush);break;case t.UNZIP:switch(this.strm.avail_in>0&&(e=this.strm.next_in),this.gzip_id_bytes_read){case 0:if(null===e)break;if(31!==this.strm.input[e]){this.mode=t.INFLATE;break}if(this.gzip_id_bytes_read=1,e++,1===this.strm.avail_in)break;case 1:if(null===e)break;139===this.strm.input[e]?(this.gzip_id_bytes_read=2,this.mode=t.GUNZIP):this.mode=t.INFLATE;break;default:throw new Error("invalid number of gzip magic number bytes read")}case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:for(this.err=u.inflate(this.strm,this.flush),this.err===t.Z_NEED_DICT&&this.dictionary&&(this.err=u.inflateSetDictionary(this.strm,this.dictionary),this.err===t.Z_OK?this.err=u.inflate(this.strm,this.flush):this.err===t.Z_DATA_ERROR&&(this.err=t.Z_NEED_DICT));this.strm.avail_in>0&&this.mode===t.GUNZIP&&this.err===t.Z_STREAM_END&&0!==this.strm.next_in[0];)this.reset(),this.err=u.inflate(this.strm,this.flush);break;default:throw new Error("Unknown mode "+this.mode)}},i.prototype._checkError=function(){switch(this.err){case t.Z_OK:case t.Z_BUF_ERROR:if(0!==this.strm.avail_out&&this.flush===t.Z_FINISH)return this._error("unexpected end of file"),!1;break;case t.Z_STREAM_END:break;case t.Z_NEED_DICT:return null==this.dictionary?this._error("Missing dictionary"):this._error("Bad dictionary"),!1;default:return this._error("Zlib error"),!1}return!0},i.prototype._after=function(){if(this._checkError()){var e=this.strm.avail_out,t=this.strm.avail_in;this.write_in_progress=!1,this.callback(t,e),this.pending_close&&this.close()}},i.prototype._error=function(e){this.strm.msg&&(e=this.strm.msg),this.onerror(e,this.err),this.write_in_progress=!1,this.pending_close&&this.close()},i.prototype.init=function(e,r,n,i,s){o(4===arguments.length||5===arguments.length,"init(windowBits, level, memLevel, strategy, [dictionary])"),o(e>=8&&e<=15,"invalid windowBits"),o(r>=-1&&r<=9,"invalid compression level"),o(n>=1&&n<=9,"invalid memlevel"),o(i===t.Z_FILTERED||i===t.Z_HUFFMAN_ONLY||i===t.Z_RLE||i===t.Z_FIXED||i===t.Z_DEFAULT_STRATEGY,"invalid strategy"),this._init(r,e,n,i,s),this._setDictionary()},i.prototype.params=function(){throw new Error("deflateParams Not supported")},i.prototype.reset=function(){this._reset(),this._setDictionary()},i.prototype._init=function(e,r,n,i,o){switch(this.level=e,this.windowBits=r,this.memLevel=n,this.strategy=i,this.flush=t.Z_NO_FLUSH,this.err=t.Z_OK,this.mode!==t.GZIP&&this.mode!==t.GUNZIP||(this.windowBits+=16),this.mode===t.UNZIP&&(this.windowBits+=32),this.mode!==t.DEFLATERAW&&this.mode!==t.INFLATERAW||(this.windowBits=-1*this.windowBits),this.strm=new s,this.mode){case t.DEFLATE:case t.GZIP:case t.DEFLATERAW:this.err=a.deflateInit2(this.strm,this.level,t.Z_DEFLATED,this.windowBits,this.memLevel,this.strategy);break;case t.INFLATE:case t.GUNZIP:case t.INFLATERAW:case t.UNZIP:this.err=u.inflateInit2(this.strm,this.windowBits);break;default:throw new Error("Unknown mode "+this.mode)}this.err!==t.Z_OK&&this._error("Init error"),this.dictionary=o,this.write_in_progress=!1,this.init_done=!0},i.prototype._setDictionary=function(){if(null!=this.dictionary){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:this.err=a.deflateSetDictionary(this.strm,this.dictionary)}this.err!==t.Z_OK&&this._error("Failed to set dictionary")}},i.prototype._reset=function(){switch(this.err=t.Z_OK,this.mode){case t.DEFLATE:case t.DEFLATERAW:case t.GZIP:this.err=a.deflateReset(this.strm);break;case t.INFLATE:case t.INFLATERAW:case t.GUNZIP:this.err=u.inflateReset(this.strm)}this.err!==t.Z_OK&&this._error("Failed to reset stream")},t.Zlib=i}).call(t,r(8).Buffer,r(0))},function(e,t,r){"use strict";(function(e){function n(e,t,r){function n(){for(var t;null!==(t=e.read());)s.push(t),a+=t.length;e.once("readable",n)}function i(t){e.removeListener("end",o),e.removeListener("readable",n),r(t)}function o(){var t,n=null;a>=w?n=new RangeError(k):t=y.concat(s,a),s=[],e.close(),r(n,t)}var s=[],a=0;e.on("error",i),e.on("end",o),e.end(t),n()}function i(e,t){if("string"==typeof t&&(t=y.from(t)),!y.isBuffer(t))throw new TypeError("Not a string or buffer");var r=e._finishFlushFlag;return e._processChunk(t,r)}function o(e){if(!(this instanceof o))return new o(e);p.call(this,e,v.DEFLATE)}function s(e){if(!(this instanceof s))return new s(e);p.call(this,e,v.INFLATE)}function a(e){if(!(this instanceof a))return new a(e);p.call(this,e,v.GZIP)}function u(e){if(!(this instanceof u))return new u(e);p.call(this,e,v.GUNZIP)}function c(e){if(!(this instanceof c))return new c(e);p.call(this,e,v.DEFLATERAW)}function l(e){if(!(this instanceof l))return new l(e);p.call(this,e,v.INFLATERAW)}function f(e){if(!(this instanceof f))return new f(e);p.call(this,e,v.UNZIP)}function h(e){return e===v.Z_NO_FLUSH||e===v.Z_PARTIAL_FLUSH||e===v.Z_SYNC_FLUSH||e===v.Z_FULL_FLUSH||e===v.Z_FINISH||e===v.Z_BLOCK}function p(e,r){var n=this;if(this._opts=e=e||{},this._chunkSize=e.chunkSize||t.Z_DEFAULT_CHUNK,g.call(this,e),e.flush&&!h(e.flush))throw new Error("Invalid flush flag: "+e.flush);if(e.finishFlush&&!h(e.finishFlush))throw new Error("Invalid flush flag: "+e.finishFlush);if(this._flushFlag=e.flush||v.Z_NO_FLUSH,this._finishFlushFlag=void 0!==e.finishFlush?e.finishFlush:v.Z_FINISH,e.chunkSize&&(e.chunkSize<t.Z_MIN_CHUNK||e.chunkSize>t.Z_MAX_CHUNK))throw new Error("Invalid chunk size: "+e.chunkSize);if(e.windowBits&&(e.windowBits<t.Z_MIN_WINDOWBITS||e.windowBits>t.Z_MAX_WINDOWBITS))throw new Error("Invalid windowBits: "+e.windowBits);if(e.level&&(e.level<t.Z_MIN_LEVEL||e.level>t.Z_MAX_LEVEL))throw new Error("Invalid compression level: "+e.level);if(e.memLevel&&(e.memLevel<t.Z_MIN_MEMLEVEL||e.memLevel>t.Z_MAX_MEMLEVEL))throw new Error("Invalid memLevel: "+e.memLevel);if(e.strategy&&e.strategy!=t.Z_FILTERED&&e.strategy!=t.Z_HUFFMAN_ONLY&&e.strategy!=t.Z_RLE&&e.strategy!=t.Z_FIXED&&e.strategy!=t.Z_DEFAULT_STRATEGY)throw new Error("Invalid strategy: "+e.strategy);if(e.dictionary&&!y.isBuffer(e.dictionary))throw new Error("Invalid dictionary: it should be a Buffer instance");this._handle=new v.Zlib(r);var i=this;this._hadError=!1,this._handle.onerror=function(e,r){d(i),i._hadError=!0;var n=new Error(e);n.errno=r,n.code=t.codes[r],i.emit("error",n)};var o=t.Z_DEFAULT_COMPRESSION;"number"==typeof e.level&&(o=e.level);var s=t.Z_DEFAULT_STRATEGY;"number"==typeof e.strategy&&(s=e.strategy),this._handle.init(e.windowBits||t.Z_DEFAULT_WINDOWBITS,o,e.memLevel||t.Z_DEFAULT_MEMLEVEL,s,e.dictionary),this._buffer=y.allocUnsafe(this._chunkSize),this._offset=0,this._level=o,this._strategy=s,this.once("end",this.close),Object.defineProperty(this,"_closed",{get:function(){return!n._handle},configurable:!0,enumerable:!0})}function d(t,r){r&&e.nextTick(r),t._handle&&(t._handle.close(),t._handle=null)}function b(e){e.emit("close")}var y=r(8).Buffer,g=r(87).Transform,v=r(62),_=r(38),m=r(1).ok,w=r(8).kMaxLength,k="Cannot create final Buffer. It would be larger than 0x"+w.toString(16)+" bytes";v.Z_MIN_WINDOWBITS=8,v.Z_MAX_WINDOWBITS=15,v.Z_DEFAULT_WINDOWBITS=15,v.Z_MIN_CHUNK=64,v.Z_MAX_CHUNK=1/0,v.Z_DEFAULT_CHUNK=16384,v.Z_MIN_MEMLEVEL=1,v.Z_MAX_MEMLEVEL=9,v.Z_DEFAULT_MEMLEVEL=8,v.Z_MIN_LEVEL=-1,v.Z_MAX_LEVEL=9,v.Z_DEFAULT_LEVEL=v.Z_DEFAULT_COMPRESSION;for(var R=Object.keys(v),E=0;E<R.length;E++){var S=R[E];S.match(/^Z/)&&Object.defineProperty(t,S,{enumerable:!0,value:v[S],writable:!1})}for(var x={Z_OK:v.Z_OK,Z_STREAM_END:v.Z_STREAM_END,Z_NEED_DICT:v.Z_NEED_DICT,Z_ERRNO:v.Z_ERRNO,Z_STREAM_ERROR:v.Z_STREAM_ERROR,Z_DATA_ERROR:v.Z_DATA_ERROR,Z_MEM_ERROR:v.Z_MEM_ERROR,Z_BUF_ERROR:v.Z_BUF_ERROR,Z_VERSION_ERROR:v.Z_VERSION_ERROR},O=Object.keys(x),P=0;P<O.length;P++){var j=O[P];x[x[j]]=j}Object.defineProperty(t,"codes",{enumerable:!0,value:Object.freeze(x),writable:!1}),t.Deflate=o,t.Inflate=s,t.Gzip=a,t.Gunzip=u,t.DeflateRaw=c,t.InflateRaw=l,t.Unzip=f,t.createDeflate=function(e){return new o(e)},t.createInflate=function(e){return new s(e)},t.createDeflateRaw=function(e){return new c(e)},t.createInflateRaw=function(e){return new l(e)},t.createGzip=function(e){return new a(e)},t.createGunzip=function(e){return new u(e)},t.createUnzip=function(e){return new f(e)},t.deflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new o(t),e,r)},t.deflateSync=function(e,t){return i(new o(t),e)},t.gzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new a(t),e,r)},t.gzipSync=function(e,t){return i(new a(t),e)},t.deflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new c(t),e,r)},t.deflateRawSync=function(e,t){return i(new c(t),e)},t.unzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new f(t),e,r)},t.unzipSync=function(e,t){return i(new f(t),e)},t.inflate=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new s(t),e,r)},t.inflateSync=function(e,t){return i(new s(t),e)},t.gunzip=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new u(t),e,r)},t.gunzipSync=function(e,t){return i(new u(t),e)},t.inflateRaw=function(e,t,r){return"function"==typeof t&&(r=t,t={}),n(new l(t),e,r)},t.inflateRawSync=function(e,t){return i(new l(t),e)},_.inherits(p,g),p.prototype.params=function(r,n,i){if(r<t.Z_MIN_LEVEL||r>t.Z_MAX_LEVEL)throw new RangeError("Invalid compression level: "+r);if(n!=t.Z_FILTERED&&n!=t.Z_HUFFMAN_ONLY&&n!=t.Z_RLE&&n!=t.Z_FIXED&&n!=t.Z_DEFAULT_STRATEGY)throw new TypeError("Invalid strategy: "+n);if(this._level!==r||this._strategy!==n){var o=this;this.flush(v.Z_SYNC_FLUSH,function(){m(o._handle,"zlib binding closed"),o._handle.params(r,n),o._hadError||(o._level=r,o._strategy=n,i&&i())})}else e.nextTick(i)},p.prototype.reset=function(){return m(this._handle,"zlib binding closed"),this._handle.reset()},p.prototype._flush=function(e){this._transform(y.alloc(0),"",e)},p.prototype.flush=function(t,r){var n=this,i=this._writableState;("function"==typeof t||void 0===t&&!r)&&(r=t,t=v.Z_FULL_FLUSH),i.ended?r&&e.nextTick(r):i.ending?r&&this.once("end",r):i.needDrain?r&&this.once("drain",function(){return n.flush(t,r)}):(this._flushFlag=t,this.write(y.alloc(0),"",r))},p.prototype.close=function(t){d(this,t),e.nextTick(b,this)},p.prototype._transform=function(e,t,r){var n,i=this._writableState,o=i.ending||i.ended,s=o&&(!e||i.length===e.length);return null===e||y.isBuffer(e)?this._handle?(s?n=this._finishFlushFlag:(n=this._flushFlag,e.length>=i.length&&(this._flushFlag=this._opts.flush||v.Z_NO_FLUSH)),void this._processChunk(e,n,r)):r(new Error("zlib binding closed")):r(new Error("invalid input"))},p.prototype._processChunk=function(e,t,r){function n(c,h){if(this&&(this.buffer=null,this.callback=null),!a._hadError){var p=o-h;if(m(p>=0,"have should not go down"),p>0){var d=a._buffer.slice(a._offset,a._offset+p);a._offset+=p,u?a.push(d):(l.push(d),f+=d.length)}if((0===h||a._offset>=a._chunkSize)&&(o=a._chunkSize,a._offset=0,a._buffer=y.allocUnsafe(a._chunkSize)),0===h){if(s+=i-c,i=c,!u)return!0;var b=a._handle.write(t,e,s,i,a._buffer,a._offset,a._chunkSize);return b.callback=n,void(b.buffer=e)}if(!u)return!1;r()}}var i=e&&e.length,o=this._chunkSize-this._offset,s=0,a=this,u="function"==typeof r;if(!u){var c,l=[],f=0;this.on("error",function(e){c=e}),m(this._handle,"zlib binding closed");do{var h=this._handle.writeSync(t,e,s,i,this._buffer,this._offset,o)}while(!this._hadError&&n(h[0],h[1]));if(this._hadError)throw c;if(f>=w)throw d(this),new RangeError(k);var p=y.concat(l,f);return d(this),p}m(this._handle,"zlib binding closed");var b=this._handle.write(t,e,s,i,this._buffer,this._offset,o);b.buffer=e,b.callback=n},_.inherits(o,p),_.inherits(s,p),_.inherits(a,p),_.inherits(u,p),_.inherits(c,p),_.inherits(l,p),_.inherits(f,p)}).call(t,r(0))},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var s=function(e){function t(e){n(this,t);var r=i(this,Object.getPrototypeOf(t).call(this,e));return r.name=r.constructor.name,r.message=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(r,r.constructor):r.stack=new Error(e).stack,r}return o(t,e),t}(function(e){function t(){var t=Reflect.construct(e,Array.from(arguments));return Object.setPrototypeOf(t,Object.getPrototypeOf(this)),t}return t.prototype=Object.create(e.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e,t}(Error));e.exports=s},function(e,t){t.read=function(e,t,r,n,i){var o,s,a=8*i-n-1,u=(1<<a)-1,c=u>>1,l=-7,f=r?i-1:0,h=r?-1:1,p=e[t+f];for(f+=h,o=p&(1<<-l)-1,p>>=-l,l+=a;l>0;o=256*o+e[t+f],f+=h,l-=8);for(s=o&(1<<-l)-1,o>>=-l,l+=n;l>0;s=256*s+e[t+f],f+=h,l-=8);if(0===o)o=1-c;else{if(o===u)return s?NaN:1/0*(p?-1:1);s+=Math.pow(2,n),o-=c}return(p?-1:1)*s*Math.pow(2,o-n)},t.write=function(e,t,r,n,i,o){var s,a,u,c=8*o-i-1,l=(1<<c)-1,f=l>>1,h=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=n?0:o-1,d=n?1:-1,b=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,s=l):(s=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-s))<1&&(s--,u*=2),t+=s+f>=1?h/u:h*Math.pow(2,1-f),t*u>=2&&(s++,u/=2),s+f>=l?(a=0,s=l):s+f>=1?(a=(t*u-1)*Math.pow(2,i),s+=f):(a=t*Math.pow(2,f-1)*Math.pow(2,i),s=0));i>=8;e[r+p]=255&a,p+=d,a/=256,i-=8);for(s=s<<i|a,c+=i;c>0;e[r+p]=255&s,p+=d,s/=256,c-=8);e[r+p-d]|=128*b}},function(e,t,r){"use strict";var n;!function(i){function o(e,t,r){var n,i,o,s,p,d,b,y,g,v=0,_=[],m=0,w=!1,k=[],R=[],E=!1,S=!1,x=-1;if(r=r||{},n=r.encoding||"UTF8",(g=r.numRounds||1)!==parseInt(g,10)||1>g)throw Error("numRounds must a integer >= 1");if("SHA-1"===e)p=512,d=D,b=M,s=160,y=function(e){return e.slice()};else if(0===e.lastIndexOf("SHA-",0))if(d=function(t,r){return q(t,r,e)},b=function(t,r,n,i){var o,s;if("SHA-224"===e||"SHA-256"===e)o=15+(r+65>>>9<<4),s=16;else{if("SHA-384"!==e&&"SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");o=31+(r+129>>>10<<5),s=32}for(;t.length<=o;)t.push(0);for(t[r>>>5]|=128<<24-r%32,r+=n,t[o]=4294967295&r,t[o-1]=r/4294967296|0,n=t.length,r=0;r<n;r+=s)i=q(t.slice(r,r+s),i,e);if("SHA-224"===e)t=[i[0],i[1],i[2],i[3],i[4],i[5],i[6]];else if("SHA-256"===e)t=i;else if("SHA-384"===e)t=[i[0].a,i[0].b,i[1].a,i[1].b,i[2].a,i[2].b,i[3].a,i[3].b,i[4].a,i[4].b,i[5].a,i[5].b];else{if("SHA-512"!==e)throw Error("Unexpected error in SHA-2 implementation");t=[i[0].a,i[0].b,i[1].a,i[1].b,i[2].a,i[2].b,i[3].a,i[3].b,i[4].a,i[4].b,i[5].a,i[5].b,i[6].a,i[6].b,i[7].a,i[7].b]}return t},y=function(e){return e.slice()},"SHA-224"===e)p=512,s=224;else if("SHA-256"===e)p=512,s=256;else if("SHA-384"===e)p=1024,s=384;else{if("SHA-512"!==e)throw Error("Chosen SHA variant is not supported");p=1024,s=512}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("Chosen SHA variant is not supported");var O=6;if(d=W,y=function(e){var t,r=[];for(t=0;5>t;t+=1)r[t]=e[t].slice();return r},x=1,"SHA3-224"===e)p=1152,s=224;else if("SHA3-256"===e)p=1088,s=256;else if("SHA3-384"===e)p=832,s=384;else if("SHA3-512"===e)p=576,s=512;else if("SHAKE128"===e)p=1344,s=-1,O=31,S=!0;else{if("SHAKE256"!==e)throw Error("Chosen SHA variant is not supported");p=1088,s=-1,O=31,S=!0}b=function(e,t,r,n,i){r=p;var o,s=O,a=[],u=r>>>5,c=0,l=t>>>5;for(o=0;o<l&&t>=r;o+=u)n=W(e.slice(o,o+u),n),t-=r;for(e=e.slice(o),t%=r;e.length<u;)e.push(0);for(o=t>>>3,e[o>>2]^=s<<o%4*8,e[u-1]^=2147483648,n=W(e,n);32*a.length<i&&(e=n[c%5][c/5|0],a.push(e.b),!(32*a.length>=i));)a.push(e.a),0==64*(c+=1)%r&&W(null,n);return a}}o=h(t,n,x),i=B(e),this.setHMACKey=function(t,r,o){var a;if(!0===w)throw Error("HMAC key already set");if(!0===E)throw Error("Cannot set HMAC key after calling update");if(!0===S)throw Error("SHAKE is not supported for HMAC");if(n=(o||{}).encoding||"UTF8",r=h(r,n,x)(t),t=r.binLen,r=r.value,a=p>>>3,o=a/4-1,a<t/8){for(r=b(r,t,0,B(e),s);r.length<=o;)r.push(0);r[o]&=4294967040}else if(a>t/8){for(;r.length<=o;)r.push(0);r[o]&=4294967040}for(t=0;t<=o;t+=1)k[t]=909522486^r[t],R[t]=1549556828^r[t];i=d(k,i),v=p,w=!0},this.update=function(e){var t,r,n,s=0,a=p>>>5;for(t=o(e,_,m),e=t.binLen,r=t.value,t=e>>>5,n=0;n<t;n+=a)s+p<=e&&(i=d(r.slice(n,n+a),i),s+=p);v+=s,_=r.slice(s>>>5),m=e%p,E=!0},this.getHash=function(t,r){var n,o,h,p;if(!0===w)throw Error("Cannot call getHash after setting HMAC key");if(h=f(r),!0===S){if(-1===h.shakeLen)throw Error("shakeLen must be specified in options");s=h.shakeLen}switch(t){case"HEX":n=function(e){return a(e,s,x,h)};break;case"B64":n=function(e){return u(e,s,x,h)};break;case"BYTES":n=function(e){return c(e,s,x)};break;case"ARRAYBUFFER":try{o=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return l(e,s,x)};break;default:throw Error("format must be HEX, B64, BYTES, or ARRAYBUFFER")}for(p=b(_.slice(),m,v,y(i),s),o=1;o<g;o+=1)!0===S&&0!=s%32&&(p[p.length-1]&=16777215>>>24-s%32),p=b(p,s,0,B(e),s);return n(p)},this.getHMAC=function(t,r){var n,o,h,g;if(!1===w)throw Error("Cannot call getHMAC without first setting HMAC key");switch(h=f(r),t){case"HEX":n=function(e){return a(e,s,x,h)};break;case"B64":n=function(e){return u(e,s,x,h)};break;case"BYTES":n=function(e){return c(e,s,x)};break;case"ARRAYBUFFER":try{n=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}n=function(e){return l(e,s,x)};break;default:throw Error("outputFormat must be HEX, B64, BYTES, or ARRAYBUFFER")}return o=b(_.slice(),m,v,y(i),s),g=d(R,B(e)),g=b(o,s,p,g,s),n(g)}}function s(e,t){this.a=e,this.b=t}function a(e,t,r,n){var i="";t/=8;var o,s,a;for(a=-1===r?3:0,o=0;o<t;o+=1)s=e[o>>>2]>>>8*(a+o%4*r),i+="0123456789abcdef".charAt(s>>>4&15)+"0123456789abcdef".charAt(15&s);return n.outputUpper?i.toUpperCase():i}function u(e,t,r,n){var i,o,s,a,u="",c=t/8;for(a=-1===r?3:0,i=0;i<c;i+=3)for(o=i+1<c?e[i+1>>>2]:0,s=i+2<c?e[i+2>>>2]:0,s=(e[i>>>2]>>>8*(a+i%4*r)&255)<<16|(o>>>8*(a+(i+1)%4*r)&255)<<8|s>>>8*(a+(i+2)%4*r)&255,o=0;4>o;o+=1)u+=8*i+6*o<=t?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(s>>>6*(3-o)&63):n.b64Pad;return u}function c(e,t,r){var n="";t/=8;var i,o,s;for(s=-1===r?3:0,i=0;i<t;i+=1)o=e[i>>>2]>>>8*(s+i%4*r)&255,n+=String.fromCharCode(o);return n}function l(e,t,r){t/=8;var n,i,o,s=new ArrayBuffer(t);for(o=new Uint8Array(s),i=-1===r?3:0,n=0;n<t;n+=1)o[n]=e[n>>>2]>>>8*(i+n%4*r)&255;return s}function f(e){var t={outputUpper:!1,b64Pad:"=",shakeLen:-1};if(e=e||{},t.outputUpper=e.outputUpper||!1,!0===e.hasOwnProperty("b64Pad")&&(t.b64Pad=e.b64Pad),!0===e.hasOwnProperty("shakeLen")){if(0!=e.shakeLen%8)throw Error("shakeLen must be a multiple of 8");t.shakeLen=e.shakeLen}if("boolean"!=typeof t.outputUpper)throw Error("Invalid outputUpper formatting option");if("string"!=typeof t.b64Pad)throw Error("Invalid b64Pad formatting option");return t}function h(e,t,r){switch(t){case"UTF8":case"UTF16BE":case"UTF16LE":break;default:throw Error("encoding must be UTF8, UTF16BE, or UTF16LE")}switch(e){case"HEX":e=function(e,t,n){var i,o,s,a,u,c,l=e.length;if(0!=l%2)throw Error("String of HEX type must be in byte increments");for(t=t||[0],n=n||0,u=n>>>3,c=-1===r?3:0,i=0;i<l;i+=2){if(o=parseInt(e.substr(i,2),16),isNaN(o))throw Error("String of HEX type contains invalid characters");for(a=(i>>>1)+u,s=a>>>2;t.length<=s;)t.push(0);t[s]|=o<<8*(c+a%4*r)}return{value:t,binLen:4*l+n}};break;case"TEXT":e=function(e,n,i){var o,s,a,u,c,l,f,h,p=0;if(n=n||[0],i=i||0,c=i>>>3,"UTF8"===t)for(h=-1===r?3:0,a=0;a<e.length;a+=1)for(o=e.charCodeAt(a),s=[],128>o?s.push(o):2048>o?(s.push(192|o>>>6),s.push(128|63&o)):55296>o||57344<=o?s.push(224|o>>>12,128|o>>>6&63,128|63&o):(a+=1,o=65536+((1023&o)<<10|1023&e.charCodeAt(a)),s.push(240|o>>>18,128|o>>>12&63,128|o>>>6&63,128|63&o)),u=0;u<s.length;u+=1){for(f=p+c,l=f>>>2;n.length<=l;)n.push(0);n[l]|=s[u]<<8*(h+f%4*r),p+=1}else if("UTF16BE"===t||"UTF16LE"===t)for(h=-1===r?2:0,s="UTF16LE"===t&&1!==r||"UTF16LE"!==t&&1===r,a=0;a<e.length;a+=1){for(o=e.charCodeAt(a),!0===s&&(u=255&o,o=u<<8|o>>>8),f=p+c,l=f>>>2;n.length<=l;)n.push(0);n[l]|=o<<8*(h+f%4*r),p+=2}return{value:n,binLen:8*p+i}};break;case"B64":e=function(e,t,n){var i,o,s,a,u,c,l,f,h=0;if(-1===e.search(/^[a-zA-Z0-9=+\/]+$/))throw Error("Invalid character in base-64 string");if(o=e.indexOf("="),e=e.replace(/\=/g,""),-1!==o&&o<e.length)throw Error("Invalid '=' found in base-64 string");for(t=t||[0],n=n||0,c=n>>>3,f=-1===r?3:0,o=0;o<e.length;o+=4){for(u=e.substr(o,4),s=a=0;s<u.length;s+=1)i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".indexOf(u[s]),a|=i<<18-6*s;for(s=0;s<u.length-1;s+=1){for(l=h+c,i=l>>>2;t.length<=i;)t.push(0);t[i]|=(a>>>16-8*s&255)<<8*(f+l%4*r),h+=1}}return{value:t,binLen:8*h+n}};break;case"BYTES":e=function(e,t,n){var i,o,s,a,u,c;for(t=t||[0],n=n||0,s=n>>>3,c=-1===r?3:0,o=0;o<e.length;o+=1)i=e.charCodeAt(o),u=o+s,a=u>>>2,t.length<=a&&t.push(0),t[a]|=i<<8*(c+u%4*r);return{value:t,binLen:8*e.length+n}};break;case"ARRAYBUFFER":try{e=new ArrayBuffer(0)}catch(e){throw Error("ARRAYBUFFER not supported by this environment")}e=function(e,t,n){var i,o,s,a,u,c;for(t=t||[0],n=n||0,o=n>>>3,u=-1===r?3:0,c=new Uint8Array(e),i=0;i<e.byteLength;i+=1)a=i+o,s=a>>>2,t.length<=s&&t.push(0),t[s]|=c[i]<<8*(u+a%4*r);return{value:t,binLen:8*e.byteLength+n}};break;default:throw Error("format must be HEX, TEXT, B64, BYTES, or ARRAYBUFFER")}return e}function p(e,t){return e<<t|e>>>32-t}function d(e,t){return 32<t?(t-=32,new s(e.b<<t|e.a>>>32-t,e.a<<t|e.b>>>32-t)):0!==t?new s(e.a<<t|e.b>>>32-t,e.b<<t|e.a>>>32-t):e}function b(e,t){return e>>>t|e<<32-t}function y(e,t){var r=null,r=new s(e.a,e.b);return r=32>=t?new s(r.a>>>t|r.b<<32-t&4294967295,r.b>>>t|r.a<<32-t&4294967295):new s(r.b>>>t-32|r.a<<64-t&4294967295,r.a>>>t-32|r.b<<64-t&4294967295)}function g(e,t){return 32>=t?new s(e.a>>>t,e.b>>>t|e.a<<32-t&4294967295):new s(0,e.a>>>t-32)}function v(e,t,r){return e&t^~e&r}function _(e,t,r){return new s(e.a&t.a^~e.a&r.a,e.b&t.b^~e.b&r.b)}function m(e,t,r){return e&t^e&r^t&r}function w(e,t,r){return new s(e.a&t.a^e.a&r.a^t.a&r.a,e.b&t.b^e.b&r.b^t.b&r.b)}function k(e){return b(e,2)^b(e,13)^b(e,22)}function R(e){var t=y(e,28),r=y(e,34);return e=y(e,39),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function E(e){return b(e,6)^b(e,11)^b(e,25)}function S(e){var t=y(e,14),r=y(e,18);return e=y(e,41),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function x(e){return b(e,7)^b(e,18)^e>>>3}function O(e){var t=y(e,1),r=y(e,8);return e=g(e,7),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function P(e){return b(e,17)^b(e,19)^e>>>10}function j(e){var t=y(e,19),r=y(e,61);return e=g(e,6),new s(t.a^r.a^e.a,t.b^r.b^e.b)}function T(e,t){var r=(65535&e)+(65535&t);return((e>>>16)+(t>>>16)+(r>>>16)&65535)<<16|65535&r}function A(e,t,r,n){var i=(65535&e)+(65535&t)+(65535&r)+(65535&n);return((e>>>16)+(t>>>16)+(r>>>16)+(n>>>16)+(i>>>16)&65535)<<16|65535&i}function C(e,t,r,n,i){var o=(65535&e)+(65535&t)+(65535&r)+(65535&n)+(65535&i);return((e>>>16)+(t>>>16)+(r>>>16)+(n>>>16)+(i>>>16)+(o>>>16)&65535)<<16|65535&o}function N(e,t){var r,n,i;return r=(65535&e.b)+(65535&t.b),n=(e.b>>>16)+(t.b>>>16)+(r>>>16),i=(65535&n)<<16|65535&r,r=(65535&e.a)+(65535&t.a)+(n>>>16),n=(e.a>>>16)+(t.a>>>16)+(r>>>16),new s((65535&n)<<16|65535&r,i)}function I(e,t,r,n){var i,o,a;return i=(65535&e.b)+(65535&t.b)+(65535&r.b)+(65535&n.b),o=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(n.b>>>16)+(i>>>16),a=(65535&o)<<16|65535&i,i=(65535&e.a)+(65535&t.a)+(65535&r.a)+(65535&n.a)+(o>>>16),o=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(n.a>>>16)+(i>>>16),new s((65535&o)<<16|65535&i,a)}function L(e,t,r,n,i){var o,a,u;return o=(65535&e.b)+(65535&t.b)+(65535&r.b)+(65535&n.b)+(65535&i.b),a=(e.b>>>16)+(t.b>>>16)+(r.b>>>16)+(n.b>>>16)+(i.b>>>16)+(o>>>16),u=(65535&a)<<16|65535&o,o=(65535&e.a)+(65535&t.a)+(65535&r.a)+(65535&n.a)+(65535&i.a)+(a>>>16),a=(e.a>>>16)+(t.a>>>16)+(r.a>>>16)+(n.a>>>16)+(i.a>>>16)+(o>>>16),new s((65535&a)<<16|65535&o,u)}function U(e,t){return new s(e.a^t.a,e.b^t.b)}function B(e){var t,r=[];if("SHA-1"===e)r=[1732584193,4023233417,2562383102,271733878,3285377520];else if(0===e.lastIndexOf("SHA-",0))switch(r=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428],t=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],e){case"SHA-224":break;case"SHA-256":r=t;break;case"SHA-384":r=[new s(3418070365,r[0]),new s(1654270250,r[1]),new s(2438529370,r[2]),new s(355462360,r[3]),new s(1731405415,r[4]),new s(41048885895,r[5]),new s(3675008525,r[6]),new s(1203062813,r[7])];break;case"SHA-512":r=[new s(t[0],4089235720),new s(t[1],2227873595),new s(t[2],4271175723),new s(t[3],1595750129),new s(t[4],2917565137),new s(t[5],725511199),new s(t[6],4215389547),new s(t[7],327033209)];break;default:throw Error("Unknown SHA variant")}else{if(0!==e.lastIndexOf("SHA3-",0)&&0!==e.lastIndexOf("SHAKE",0))throw Error("No SHA variants supported");for(e=0;5>e;e+=1)r[e]=[new s(0,0),new s(0,0),new s(0,0),new s(0,0),new s(0,0)]}return r}function D(e,t){var r,n,i,o,s,a,u,c=[];for(r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],u=0;80>u;u+=1)c[u]=16>u?e[u]:p(c[u-3]^c[u-8]^c[u-14]^c[u-16],1),a=20>u?C(p(r,5),n&i^~n&o,s,1518500249,c[u]):40>u?C(p(r,5),n^i^o,s,1859775393,c[u]):60>u?C(p(r,5),m(n,i,o),s,2400959708,c[u]):C(p(r,5),n^i^o,s,3395469782,c[u]),s=o,o=i,i=p(n,30),n=r,r=a;return t[0]=T(r,t[0]),t[1]=T(n,t[1]),t[2]=T(i,t[2]),t[3]=T(o,t[3]),t[4]=T(s,t[4]),t}function M(e,t,r,n){var i;for(i=15+(t+65>>>9<<4);e.length<=i;)e.push(0);for(e[t>>>5]|=128<<24-t%32,t+=r,e[i]=4294967295&t,e[i-1]=t/4294967296|0,t=e.length,i=0;i<t;i+=16)n=D(e.slice(i,i+16),n);return n}function q(e,t,r){var n,i,o,a,u,c,l,f,h,p,d,b,y,g,U,B,D,M,q,W,J,H,Z,Y=[];if("SHA-224"===r||"SHA-256"===r)p=64,b=1,H=Number,y=T,g=A,U=C,B=x,D=P,M=k,q=E,J=m,W=v,Z=F;else{if("SHA-384"!==r&&"SHA-512"!==r)throw Error("Unexpected error in SHA-2 implementation");p=80,b=2,H=s,y=N,g=I,U=L,B=O,D=j,M=R,q=S,J=w,W=_,Z=z}for(r=t[0],n=t[1],i=t[2],o=t[3],a=t[4],u=t[5],c=t[6],l=t[7],d=0;d<p;d+=1)16>d?(h=d*b,f=e.length<=h?0:e[h],h=e.length<=h+1?0:e[h+1],Y[d]=new H(f,h)):Y[d]=g(D(Y[d-2]),Y[d-7],B(Y[d-15]),Y[d-16]),f=U(l,q(a),W(a,u,c),Z[d],Y[d]),h=y(M(r),J(r,n,i)),l=c,c=u,u=a,a=y(o,f),o=i,i=n,n=r,r=y(f,h);return t[0]=y(r,t[0]),t[1]=y(n,t[1]),t[2]=y(i,t[2]),t[3]=y(o,t[3]),t[4]=y(a,t[4]),t[5]=y(u,t[5]),t[6]=y(c,t[6]),t[7]=y(l,t[7]),t}function W(e,t){var r,n,i,o,a=[],u=[];if(null!==e)for(n=0;n<e.length;n+=2)t[(n>>>1)%5][(n>>>1)/5|0]=U(t[(n>>>1)%5][(n>>>1)/5|0],new s(e[n+1],e[n]));for(r=0;24>r;r+=1){for(o=B("SHA3-"),n=0;5>n;n+=1){i=t[n][0];var c=t[n][1],l=t[n][2],f=t[n][3],h=t[n][4];a[n]=new s(i.a^c.a^l.a^f.a^h.a,i.b^c.b^l.b^f.b^h.b)}for(n=0;5>n;n+=1)u[n]=U(a[(n+4)%5],d(a[(n+1)%5],1));for(n=0;5>n;n+=1)for(i=0;5>i;i+=1)t[n][i]=U(t[n][i],u[n]);for(n=0;5>n;n+=1)for(i=0;5>i;i+=1)o[i][(2*n+3*i)%5]=d(t[n][i],J[n][i]);for(n=0;5>n;n+=1)for(i=0;5>i;i+=1)t[n][i]=U(o[n][i],new s(~o[(n+1)%5][i].a&o[(n+2)%5][i].a,~o[(n+1)%5][i].b&o[(n+2)%5][i].b));t[0][0]=U(t[0][0],H[r])}return t}var F,z,J,H;F=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],z=[new s(F[0],3609767458),new s(F[1],602891725),new s(F[2],3964484399),new s(F[3],2173295548),new s(F[4],4081628472),new s(F[5],3053834265),new s(F[6],2937671579),new s(F[7],3664609560),new s(F[8],2734883394),new s(F[9],1164996542),new s(F[10],1323610764),new s(F[11],3590304994),new s(F[12],4068182383),new s(F[13],991336113),new s(F[14],633803317),new s(F[15],3479774868),new s(F[16],2666613458),new s(F[17],944711139),new s(F[18],2341262773),new s(F[19],2007800933),new s(F[20],1495990901),new s(F[21],1856431235),new s(F[22],3175218132),new s(F[23],2198950837),new s(F[24],3999719339),new s(F[25],766784016),new s(F[26],2566594879),new s(F[27],3203337956),new s(F[28],1034457026),new s(F[29],2466948901),new s(F[30],3758326383),new s(F[31],168717936),new s(F[32],1188179964),new s(F[33],1546045734),new s(F[34],1522805485),new s(F[35],2643833823),new s(F[36],2343527390),new s(F[37],1014477480),new s(F[38],1206759142),new s(F[39],344077627),new s(F[40],1290863460),new s(F[41],3158454273),new s(F[42],3505952657),new s(F[43],106217008),new s(F[44],3606008344),new s(F[45],1432725776),new s(F[46],1467031594),new s(F[47],851169720),new s(F[48],3100823752),new s(F[49],1363258195),new s(F[50],3750685593),new s(F[51],3785050280),new s(F[52],3318307427),new s(F[53],3812723403),new s(F[54],2003034995),new s(F[55],3602036899),new s(F[56],1575990012),new s(F[57],1125592928),new s(F[58],2716904306),new s(F[59],442776044),new s(F[60],593698344),new s(F[61],3733110249),new s(F[62],2999351573),new s(F[63],3815920427),new s(3391569614,3928383900),new s(3515267271,566280711),new s(3940187606,3454069534),new s(4118630271,4000239992),new s(116418474,1914138554),new s(174292421,2731055270),new s(289380356,3203993006),new s(460393269,320620315),new s(685471733,587496836),new s(852142971,1086792851),new s(1017036298,365543100),new s(1126000580,2618297676),new s(1288033470,3409855158),new s(1501505948,4234509866),new s(1607167915,987167468),new s(1816402316,1246189591)],H=[new s(0,1),new s(0,32898),new s(2147483648,32906),new s(2147483648,2147516416),new s(0,32907),new s(0,2147483649),new s(2147483648,2147516545),new s(2147483648,32777),new s(0,138),new s(0,136),new s(0,2147516425),new s(0,2147483658),new s(0,2147516555),new s(2147483648,139),new s(2147483648,32905),new s(2147483648,32771),new s(2147483648,32770),new s(2147483648,128),new s(0,32778),new s(2147483648,2147483658),new s(2147483648,2147516545),new s(2147483648,32896),new s(0,2147483649),new s(2147483648,2147516424)],J=[[0,36,3,41,18],[1,44,10,45,2],[62,6,43,15,61],[28,55,25,21,56],[27,20,39,8,14]],void 0!==(n=function(){return o}.call(t,r,t,e))&&(e.exports=n)}()},function(e,t){t.endianness=function(){return"LE"},t.hostname=function(){return"undefined"!=typeof location?location.hostname:""},t.loadavg=function(){return[]},t.uptime=function(){return 0},t.freemem=function(){return Number.MAX_VALUE},t.totalmem=function(){return Number.MAX_VALUE},t.cpus=function(){return[]},t.type=function(){return"Browser"},t.release=function(){return"undefined"!=typeof navigator?navigator.appVersion:""},t.networkInterfaces=t.getNetworkInterfaces=function(){return{}},t.arch=function(){return"javascript"},t.platform=function(){return"browser"},t.tmpdir=t.tmpDir=function(){return"/tmp"},t.EOL="\n",t.homedir=function(){return"/"}},function(e,t,r){"use strict";e.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},function(e,t,r){"use strict";function n(e,t){return e.msg=I[t],t}function i(e){return(e<<1)-(e>4?9:0)}function o(e){for(var t=e.length;--t>=0;)e[t]=0}function s(e){var t=e.state,r=t.pending;r>e.avail_out&&(r=e.avail_out),0!==r&&(T.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,0===t.pending&&(t.pending_out=0))}function a(e,t){A._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,s(e.strm)}function u(e,t){e.pending_buf[e.pending++]=t}function c(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=255&t}function l(e,t,r,n){var i=e.avail_in;return i>n&&(i=n),0===i?0:(e.avail_in-=i,T.arraySet(t,e.input,e.next_in,i,r),1===e.state.wrap?e.adler=C(e.adler,t,i,r):2===e.state.wrap&&(e.adler=N(e.adler,t,i,r)),e.next_in+=i,e.total_in+=i,i)}function f(e,t){var r,n,i=e.max_chain_length,o=e.strstart,s=e.prev_length,a=e.nice_match,u=e.strstart>e.w_size-ce?e.strstart-(e.w_size-ce):0,c=e.window,l=e.w_mask,f=e.prev,h=e.strstart+ue,p=c[o+s-1],d=c[o+s];e.prev_length>=e.good_match&&(i>>=2),a>e.lookahead&&(a=e.lookahead);do{if(r=t,c[r+s]===d&&c[r+s-1]===p&&c[r]===c[o]&&c[++r]===c[o+1]){o+=2,r++;do{}while(c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&c[++o]===c[++r]&&o<h);if(n=ue-(h-o),o=h-ue,n>s){if(e.match_start=t,s=n,n>=a)break;p=c[o+s-1],d=c[o+s]}}}while((t=f[t&l])>u&&0!=--i);return s<=e.lookahead?s:e.lookahead}function h(e){var t,r,n,i,o,s=e.w_size;do{if(i=e.window_size-e.lookahead-e.strstart,e.strstart>=s+(s-ce)){T.arraySet(e.window,e.window,s,s,0),e.match_start-=s,e.strstart-=s,e.block_start-=s,r=e.hash_size,t=r;do{n=e.head[--t],e.head[t]=n>=s?n-s:0}while(--r);r=s,t=r;do{n=e.prev[--t],e.prev[t]=n>=s?n-s:0}while(--r);i+=s}if(0===e.strm.avail_in)break;if(r=l(e.strm,e.window,e.strstart+e.lookahead,i),e.lookahead+=r,e.lookahead+e.insert>=ae)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+ae-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,!(e.lookahead+e.insert<ae)););}while(e.lookahead<ce&&0!==e.strm.avail_in)}function p(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(h(e),0===e.lookahead&&t===L)return ve;if(0===e.lookahead)break}e.strstart+=e.lookahead,e.lookahead=0;var n=e.block_start+r;if((0===e.strstart||e.strstart>=n)&&(e.lookahead=e.strstart-n,e.strstart=n,a(e,!1),0===e.strm.avail_out))return ve;if(e.strstart-e.block_start>=e.w_size-ce&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===D?(a(e,!0),0===e.strm.avail_out?me:we):(e.strstart>e.block_start&&(a(e,!1),e.strm.avail_out),ve)}function d(e,t){for(var r,n;;){if(e.lookahead<ce){if(h(e),e.lookahead<ce&&t===L)return ve;if(0===e.lookahead)break}if(r=0,e.lookahead>=ae&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),0!==r&&e.strstart-r<=e.w_size-ce&&(e.match_length=f(e,r)),e.match_length>=ae)if(n=A._tr_tally(e,e.strstart-e.match_start,e.match_length-ae),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=ae){e.match_length--;do{e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart}while(0!=--e.match_length);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else n=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(n&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=e.strstart<ae-1?e.strstart:ae-1,t===D?(a(e,!0),0===e.strm.avail_out?me:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:_e}function b(e,t){for(var r,n,i;;){if(e.lookahead<ce){if(h(e),e.lookahead<ce&&t===L)return ve;if(0===e.lookahead)break}if(r=0,e.lookahead>=ae&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=ae-1,0!==r&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-ce&&(e.match_length=f(e,r),e.match_length<=5&&(e.strategy===Z||e.match_length===ae&&e.strstart-e.match_start>4096)&&(e.match_length=ae-1)),e.prev_length>=ae&&e.match_length<=e.prev_length){i=e.strstart+e.lookahead-ae,n=A._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-ae),e.lookahead-=e.prev_length-1,e.prev_length-=2;do{++e.strstart<=i&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+ae-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart)}while(0!=--e.prev_length);if(e.match_available=0,e.match_length=ae-1,e.strstart++,n&&(a(e,!1),0===e.strm.avail_out))return ve}else if(e.match_available){if(n=A._tr_tally(e,0,e.window[e.strstart-1]),n&&a(e,!1),e.strstart++,e.lookahead--,0===e.strm.avail_out)return ve}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(n=A._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<ae-1?e.strstart:ae-1,t===D?(a(e,!0),0===e.strm.avail_out?me:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:_e}function y(e,t){for(var r,n,i,o,s=e.window;;){if(e.lookahead<=ue){if(h(e),e.lookahead<=ue&&t===L)return ve;if(0===e.lookahead)break}if(e.match_length=0,e.lookahead>=ae&&e.strstart>0&&(i=e.strstart-1,(n=s[i])===s[++i]&&n===s[++i]&&n===s[++i])){o=e.strstart+ue;do{}while(n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&n===s[++i]&&i<o);e.match_length=ue-(o-i),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=ae?(r=A._tr_tally(e,1,e.match_length-ae),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===D?(a(e,!0),0===e.strm.avail_out?me:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:_e}function g(e,t){for(var r;;){if(0===e.lookahead&&(h(e),0===e.lookahead)){if(t===L)return ve;break}if(e.match_length=0,r=A._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(a(e,!1),0===e.strm.avail_out))return ve}return e.insert=0,t===D?(a(e,!0),0===e.strm.avail_out?me:we):e.last_lit&&(a(e,!1),0===e.strm.avail_out)?ve:_e}function v(e,t,r,n,i){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=n,this.func=i}function _(e){e.window_size=2*e.w_size,o(e.head),e.max_lazy_match=j[e.level].max_lazy,e.good_match=j[e.level].good_length,e.nice_match=j[e.level].nice_length,e.max_chain_length=j[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=ae-1,e.match_available=0,e.ins_h=0}function m(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Q,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new T.Buf16(2*oe),this.dyn_dtree=new T.Buf16(2*(2*ne+1)),this.bl_tree=new T.Buf16(2*(2*ie+1)),o(this.dyn_ltree),o(this.dyn_dtree),o(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new T.Buf16(se+1),this.heap=new T.Buf16(2*re+1),o(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new T.Buf16(2*re+1),o(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function w(e){var t;return e&&e.state?(e.total_in=e.total_out=0,e.data_type=G,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?fe:ye,e.adler=2===t.wrap?0:1,t.last_flush=L,A._tr_init(t),q):n(e,F)}function k(e){var t=w(e);return t===q&&_(e.state),t}function R(e,t){return e&&e.state?2!==e.state.wrap?F:(e.state.gzhead=t,q):F}function E(e,t,r,i,o,s){if(!e)return F;var a=1;if(t===H&&(t=6),i<0?(a=0,i=-i):i>15&&(a=2,i-=16),o<1||o>$||r!==Q||i<8||i>15||t<0||t>9||s<0||s>X)return n(e,F);8===i&&(i=9);var u=new m;return e.state=u,u.strm=e,u.wrap=a,u.gzhead=null,u.w_bits=i,u.w_size=1<<u.w_bits,u.w_mask=u.w_size-1,u.hash_bits=o+7,u.hash_size=1<<u.hash_bits,u.hash_mask=u.hash_size-1,u.hash_shift=~~((u.hash_bits+ae-1)/ae),u.window=new T.Buf8(2*u.w_size),u.head=new T.Buf16(u.hash_size),u.prev=new T.Buf16(u.w_size),u.lit_bufsize=1<<o+6,u.pending_buf_size=4*u.lit_bufsize,u.pending_buf=new T.Buf8(u.pending_buf_size),u.d_buf=1*u.lit_bufsize,u.l_buf=3*u.lit_bufsize,u.level=t,u.strategy=s,u.method=r,k(e)}function S(e,t){return E(e,t,Q,ee,te,V)}function x(e,t){var r,a,l,f;if(!e||!e.state||t>M||t<0)return e?n(e,F):F;if(a=e.state,!e.output||!e.input&&0!==e.avail_in||a.status===ge&&t!==D)return n(e,0===e.avail_out?J:F);if(a.strm=e,r=a.last_flush,a.last_flush=t,a.status===fe)if(2===a.wrap)e.adler=0,u(a,31),u(a,139),u(a,8),a.gzhead?(u(a,(a.gzhead.text?1:0)+(a.gzhead.hcrc?2:0)+(a.gzhead.extra?4:0)+(a.gzhead.name?8:0)+(a.gzhead.comment?16:0)),u(a,255&a.gzhead.time),u(a,a.gzhead.time>>8&255),u(a,a.gzhead.time>>16&255),u(a,a.gzhead.time>>24&255),u(a,9===a.level?2:a.strategy>=Y||a.level<2?4:0),u(a,255&a.gzhead.os),a.gzhead.extra&&a.gzhead.extra.length&&(u(a,255&a.gzhead.extra.length),u(a,a.gzhead.extra.length>>8&255)),a.gzhead.hcrc&&(e.adler=N(e.adler,a.pending_buf,a.pending,0)),a.gzindex=0,a.status=he):(u(a,0),u(a,0),u(a,0),u(a,0),u(a,0),u(a,9===a.level?2:a.strategy>=Y||a.level<2?4:0),u(a,ke),a.status=ye);else{var h=Q+(a.w_bits-8<<4)<<8,p=-1;p=a.strategy>=Y||a.level<2?0:a.level<6?1:6===a.level?2:3,h|=p<<6,0!==a.strstart&&(h|=le),h+=31-h%31,a.status=ye,c(a,h),0!==a.strstart&&(c(a,e.adler>>>16),c(a,65535&e.adler)),e.adler=1}if(a.status===he)if(a.gzhead.extra){for(l=a.pending;a.gzindex<(65535&a.gzhead.extra.length)&&(a.pending!==a.pending_buf_size||(a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),s(e),l=a.pending,a.pending!==a.pending_buf_size));)u(a,255&a.gzhead.extra[a.gzindex]),a.gzindex++;a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),a.gzindex===a.gzhead.extra.length&&(a.gzindex=0,a.status=pe)}else a.status=pe;if(a.status===pe)if(a.gzhead.name){l=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),s(e),l=a.pending,a.pending===a.pending_buf_size)){f=1;break}f=a.gzindex<a.gzhead.name.length?255&a.gzhead.name.charCodeAt(a.gzindex++):0,u(a,f)}while(0!==f);a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),0===f&&(a.gzindex=0,a.status=de)}else a.status=de;if(a.status===de)if(a.gzhead.comment){l=a.pending;do{if(a.pending===a.pending_buf_size&&(a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),s(e),l=a.pending,a.pending===a.pending_buf_size)){f=1;break}f=a.gzindex<a.gzhead.comment.length?255&a.gzhead.comment.charCodeAt(a.gzindex++):0,u(a,f)}while(0!==f);a.gzhead.hcrc&&a.pending>l&&(e.adler=N(e.adler,a.pending_buf,a.pending-l,l)),0===f&&(a.status=be)}else a.status=be;if(a.status===be&&(a.gzhead.hcrc?(a.pending+2>a.pending_buf_size&&s(e),a.pending+2<=a.pending_buf_size&&(u(a,255&e.adler),u(a,e.adler>>8&255),e.adler=0,a.status=ye)):a.status=ye),0!==a.pending){if(s(e),0===e.avail_out)return a.last_flush=-1,q}else if(0===e.avail_in&&i(t)<=i(r)&&t!==D)return n(e,J);if(a.status===ge&&0!==e.avail_in)return n(e,J);if(0!==e.avail_in||0!==a.lookahead||t!==L&&a.status!==ge){var d=a.strategy===Y?g(a,t):a.strategy===K?y(a,t):j[a.level].func(a,t);if(d!==me&&d!==we||(a.status=ge),d===ve||d===me)return 0===e.avail_out&&(a.last_flush=-1),q;if(d===_e&&(t===U?A._tr_align(a):t!==M&&(A._tr_stored_block(a,0,0,!1),t===B&&(o(a.head),0===a.lookahead&&(a.strstart=0,a.block_start=0,a.insert=0))),s(e),0===e.avail_out))return a.last_flush=-1,q}return t!==D?q:a.wrap<=0?W:(2===a.wrap?(u(a,255&e.adler),u(a,e.adler>>8&255),u(a,e.adler>>16&255),u(a,e.adler>>24&255),u(a,255&e.total_in),u(a,e.total_in>>8&255),u(a,e.total_in>>16&255),u(a,e.total_in>>24&255)):(c(a,e.adler>>>16),c(a,65535&e.adler)),s(e),a.wrap>0&&(a.wrap=-a.wrap),0!==a.pending?q:W)}function O(e){var t;return e&&e.state?(t=e.state.status)!==fe&&t!==he&&t!==pe&&t!==de&&t!==be&&t!==ye&&t!==ge?n(e,F):(e.state=null,t===ye?n(e,z):q):F}function P(e,t){var r,n,i,s,a,u,c,l,f=t.length;if(!e||!e.state)return F;if(r=e.state,2===(s=r.wrap)||1===s&&r.status!==fe||r.lookahead)return F;for(1===s&&(e.adler=C(e.adler,t,f,0)),r.wrap=0,f>=r.w_size&&(0===s&&(o(r.head),r.strstart=0,r.block_start=0,r.insert=0),l=new T.Buf8(r.w_size),T.arraySet(l,t,f-r.w_size,r.w_size,0),t=l,f=r.w_size),a=e.avail_in,u=e.next_in,c=e.input,e.avail_in=f,e.next_in=0,e.input=t,h(r);r.lookahead>=ae;){n=r.strstart,i=r.lookahead-(ae-1);do{r.ins_h=(r.ins_h<<r.hash_shift^r.window[n+ae-1])&r.hash_mask,r.prev[n&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=n,n++}while(--i);r.strstart=n,r.lookahead=ae-1,h(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=ae-1,r.match_available=0,e.next_in=u,e.input=c,e.avail_in=a,r.wrap=s,q}var j,T=r(20),A=r(74),C=r(30),N=r(31),I=r(73),L=0,U=1,B=3,D=4,M=5,q=0,W=1,F=-2,z=-3,J=-5,H=-1,Z=1,Y=2,K=3,X=4,V=0,G=2,Q=8,$=9,ee=15,te=8,re=286,ne=30,ie=19,oe=2*re+1,se=15,ae=3,ue=258,ce=ue+ae+1,le=32,fe=42,he=69,pe=73,de=91,be=103,ye=113,ge=666,ve=1,_e=2,me=3,we=4,ke=3;j=[new v(0,0,0,0,p),new v(4,4,8,4,d),new v(4,5,16,8,d),new v(4,6,32,32,d),new v(4,4,16,16,b),new v(8,16,32,32,b),new v(8,16,128,128,b),new v(8,32,128,256,b),new v(32,128,258,1024,b),new v(32,258,258,4096,b)],t.deflateInit=S,t.deflateInit2=E,t.deflateReset=k,t.deflateResetKeep=w,t.deflateSetHeader=R,t.deflate=x,t.deflateEnd=O,t.deflateSetDictionary=P,t.deflateInfo="pako deflate (from Nodeca project)"},function(e,t,r){"use strict";e.exports=function(e,t){var r,n,i,o,s,a,u,c,l,f,h,p,d,b,y,g,v,_,m,w,k,R,E,S,x;r=e.state,n=e.next_in,S=e.input,i=n+(e.avail_in-5),o=e.next_out,x=e.output,s=o-(t-e.avail_out),a=o+(e.avail_out-257),u=r.dmax,c=r.wsize,l=r.whave,f=r.wnext,h=r.window,p=r.hold,d=r.bits,b=r.lencode,y=r.distcode,g=(1<<r.lenbits)-1,v=(1<<r.distbits)-1;e:do{d<15&&(p+=S[n++]<<d,d+=8,p+=S[n++]<<d,d+=8),_=b[p&g];t:for(;;){if(m=_>>>24,p>>>=m,d-=m,0===(m=_>>>16&255))x[o++]=65535&_;else{if(!(16&m)){if(0==(64&m)){_=b[(65535&_)+(p&(1<<m)-1)];continue t}if(32&m){r.mode=12;break e}e.msg="invalid literal/length code",r.mode=30;break e}w=65535&_,m&=15,m&&(d<m&&(p+=S[n++]<<d,d+=8),w+=p&(1<<m)-1,p>>>=m,d-=m),d<15&&(p+=S[n++]<<d,d+=8,p+=S[n++]<<d,d+=8),_=y[p&v];r:for(;;){if(m=_>>>24,p>>>=m,d-=m,!(16&(m=_>>>16&255))){if(0==(64&m)){_=y[(65535&_)+(p&(1<<m)-1)];continue r}e.msg="invalid distance code",r.mode=30;break e}if(k=65535&_,m&=15,d<m&&(p+=S[n++]<<d,(d+=8)<m&&(p+=S[n++]<<d,d+=8)),(k+=p&(1<<m)-1)>u){e.msg="invalid distance too far back",r.mode=30;break e}if(p>>>=m,d-=m,m=o-s,k>m){if((m=k-m)>l&&r.sane){e.msg="invalid distance too far back",r.mode=30;break e}if(R=0,E=h,0===f){if(R+=c-m,m<w){w-=m;do{x[o++]=h[R++]}while(--m);R=o-k,E=x}}else if(f<m){if(R+=c+f-m,(m-=f)<w){w-=m;do{x[o++]=h[R++]}while(--m);if(R=0,f<w){m=f,w-=m;do{x[o++]=h[R++]}while(--m);R=o-k,E=x}}}else if(R+=f-m,m<w){w-=m;do{x[o++]=h[R++]}while(--m);R=o-k,E=x}for(;w>2;)x[o++]=E[R++],x[o++]=E[R++],x[o++]=E[R++],w-=3;w&&(x[o++]=E[R++],w>1&&(x[o++]=E[R++]))}else{R=o-k;do{x[o++]=x[R++],x[o++]=x[R++],x[o++]=x[R++],w-=3}while(w>2);w&&(x[o++]=x[R++],w>1&&(x[o++]=x[R++]))}break}}break}}while(n<i&&o<a);w=d>>3,n-=w,d-=w<<3,p&=(1<<d)-1,e.next_in=n,e.next_out=o,e.avail_in=n<i?i-n+5:5-(n-i),e.avail_out=o<a?a-o+257:257-(o-a),r.hold=p,r.bits=d}},function(e,t,r){"use strict";function n(e){return(e>>>24&255)+(e>>>8&65280)+((65280&e)<<8)+((255&e)<<24)}function i(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new v.Buf16(320),this.work=new v.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function o(e){var t;return e&&e.state?(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=1&t.wrap),t.mode=B,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new v.Buf32(be),t.distcode=t.distdyn=new v.Buf32(ye),t.sane=1,t.back=-1,j):C}function s(e){var t;return e&&e.state?(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,o(e)):C}function a(e,t){var r,n;return e&&e.state?(n=e.state,t<0?(r=0,t=-t):(r=1+(t>>4),t<48&&(t&=15)),t&&(t<8||t>15)?C:(null!==n.window&&n.wbits!==t&&(n.window=null),n.wrap=r,n.wbits=t,s(e))):C}function u(e,t){var r,n;return e?(n=new i,e.state=n,n.window=null,r=a(e,t),r!==j&&(e.state=null),r):C}function c(e){return u(e,ge)}function l(e){if(ve){var t;for(y=new v.Buf32(512),g=new v.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(k(E,e.lens,0,288,y,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;k(S,e.lens,0,32,g,0,e.work,{bits:5}),ve=!1}e.lencode=y,e.lenbits=9,e.distcode=g,e.distbits=5}function f(e,t,r,n){var i,o=e.state;return null===o.window&&(o.wsize=1<<o.wbits,o.wnext=0,o.whave=0,o.window=new v.Buf8(o.wsize)),n>=o.wsize?(v.arraySet(o.window,t,r-o.wsize,o.wsize,0),o.wnext=0,o.whave=o.wsize):(i=o.wsize-o.wnext,i>n&&(i=n),v.arraySet(o.window,t,r-n,i,o.wnext),n-=i,n?(v.arraySet(o.window,t,r-n,n,0),o.wnext=n,o.whave=o.wsize):(o.wnext+=i,o.wnext===o.wsize&&(o.wnext=0),o.whave<o.wsize&&(o.whave+=i))),0}function h(e,t){var r,i,o,s,a,u,c,h,p,d,b,y,g,be,ye,ge,ve,_e,me,we,ke,Re,Ee,Se,xe=0,Oe=new v.Buf8(4),Pe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&0!==e.avail_in)return C;r=e.state,r.mode===K&&(r.mode=X),a=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,i=e.input,u=e.avail_in,h=r.hold,p=r.bits,d=u,b=c,Re=j;e:for(;;)switch(r.mode){case B:if(0===r.wrap){r.mode=X;break}for(;p<16;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(2&r.wrap&&35615===h){r.check=0,Oe[0]=255&h,Oe[1]=h>>>8&255,r.check=m(r.check,Oe,2,0),h=0,p=0,r.mode=D;break}if(r.flags=0,r.head&&(r.head.done=!1),!(1&r.wrap)||(((255&h)<<8)+(h>>8))%31){e.msg="incorrect header check",r.mode=he;break}if((15&h)!==U){e.msg="unknown compression method",r.mode=he;break}if(h>>>=4,p-=4,ke=8+(15&h),0===r.wbits)r.wbits=ke;else if(ke>r.wbits){e.msg="invalid window size",r.mode=he;break}r.dmax=1<<ke,e.adler=r.check=1,r.mode=512&h?Z:K,h=0,p=0;break;case D:for(;p<16;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(r.flags=h,(255&r.flags)!==U){e.msg="unknown compression method",r.mode=he;break}if(57344&r.flags){e.msg="unknown header flags set",r.mode=he;break}r.head&&(r.head.text=h>>8&1),512&r.flags&&(Oe[0]=255&h,Oe[1]=h>>>8&255,r.check=m(r.check,Oe,2,0)),h=0,p=0,r.mode=M;case M:for(;p<32;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.head&&(r.head.time=h),512&r.flags&&(Oe[0]=255&h,Oe[1]=h>>>8&255,Oe[2]=h>>>16&255,Oe[3]=h>>>24&255,r.check=m(r.check,Oe,4,0)),h=0,p=0,r.mode=q;case q:for(;p<16;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.head&&(r.head.xflags=255&h,r.head.os=h>>8),512&r.flags&&(Oe[0]=255&h,Oe[1]=h>>>8&255,r.check=m(r.check,Oe,2,0)),h=0,p=0,r.mode=W;case W:if(1024&r.flags){for(;p<16;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.length=h,r.head&&(r.head.extra_len=h),512&r.flags&&(Oe[0]=255&h,Oe[1]=h>>>8&255,r.check=m(r.check,Oe,2,0)),h=0,p=0}else r.head&&(r.head.extra=null);r.mode=F;case F:if(1024&r.flags&&(y=r.length,y>u&&(y=u),y&&(r.head&&(ke=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),v.arraySet(r.head.extra,i,s,y,ke)),512&r.flags&&(r.check=m(r.check,i,y,s)),u-=y,s+=y,r.length-=y),r.length))break e;r.length=0,r.mode=z;case z:if(2048&r.flags){if(0===u)break e;y=0;do{ke=i[s+y++],r.head&&ke&&r.length<65536&&(r.head.name+=String.fromCharCode(ke))}while(ke&&y<u);if(512&r.flags&&(r.check=m(r.check,i,y,s)),u-=y,s+=y,ke)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=J;case J:if(4096&r.flags){if(0===u)break e;y=0;do{ke=i[s+y++],r.head&&ke&&r.length<65536&&(r.head.comment+=String.fromCharCode(ke))}while(ke&&y<u);if(512&r.flags&&(r.check=m(r.check,i,y,s)),u-=y,s+=y,ke)break e}else r.head&&(r.head.comment=null);r.mode=H;case H:if(512&r.flags){for(;p<16;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(h!==(65535&r.check)){e.msg="header crc mismatch",r.mode=he;break}h=0,p=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=K;break;case Z:for(;p<32;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}e.adler=r.check=n(h),h=0,p=0,r.mode=Y;case Y:if(0===r.havedict)return e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=u,r.hold=h,r.bits=p,A;e.adler=r.check=1,r.mode=K;case K:if(t===O||t===P)break e;case X:if(r.last){h>>>=7&p,p-=7&p,r.mode=ce;break}for(;p<3;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}switch(r.last=1&h,h>>>=1,p-=1,3&h){case 0:r.mode=V;break;case 1:if(l(r),r.mode=re,t===P){h>>>=2,p-=2;break e}break;case 2:r.mode=$;break;case 3:e.msg="invalid block type",r.mode=he}h>>>=2,p-=2;break;case V:for(h>>>=7&p,p-=7&p;p<32;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if((65535&h)!=(h>>>16^65535)){e.msg="invalid stored block lengths",r.mode=he;break}if(r.length=65535&h,h=0,p=0,r.mode=G,t===P)break e;case G:r.mode=Q;case Q:if(y=r.length){if(y>u&&(y=u),y>c&&(y=c),0===y)break e;v.arraySet(o,i,s,y,a),u-=y,s+=y,c-=y,a+=y,r.length-=y;break}r.mode=K;break;case $:for(;p<14;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(r.nlen=257+(31&h),h>>>=5,p-=5,r.ndist=1+(31&h),h>>>=5,p-=5,r.ncode=4+(15&h),h>>>=4,p-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=he;break}r.have=0,r.mode=ee;case ee:for(;r.have<r.ncode;){for(;p<3;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.lens[Pe[r.have++]]=7&h,h>>>=3,p-=3}for(;r.have<19;)r.lens[Pe[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,Ee={bits:r.lenbits},Re=k(R,r.lens,0,19,r.lencode,0,r.work,Ee),r.lenbits=Ee.bits,Re){e.msg="invalid code lengths set",r.mode=he;break}r.have=0,r.mode=te;case te:for(;r.have<r.nlen+r.ndist;){for(;xe=r.lencode[h&(1<<r.lenbits)-1],ye=xe>>>24,ge=xe>>>16&255,ve=65535&xe,!(ye<=p);){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(ve<16)h>>>=ye,p-=ye,r.lens[r.have++]=ve;else{if(16===ve){for(Se=ye+2;p<Se;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(h>>>=ye,p-=ye,0===r.have){e.msg="invalid bit length repeat",r.mode=he;break}ke=r.lens[r.have-1],y=3+(3&h),h>>>=2,p-=2}else if(17===ve){for(Se=ye+3;p<Se;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}h>>>=ye,p-=ye,ke=0,y=3+(7&h),h>>>=3,p-=3}else{for(Se=ye+7;p<Se;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}h>>>=ye,p-=ye,ke=0,y=11+(127&h),h>>>=7,p-=7}if(r.have+y>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=he;break}for(;y--;)r.lens[r.have++]=ke}}if(r.mode===he)break;if(0===r.lens[256]){e.msg="invalid code -- missing end-of-block",r.mode=he;break}if(r.lenbits=9,Ee={bits:r.lenbits},Re=k(E,r.lens,0,r.nlen,r.lencode,0,r.work,Ee),r.lenbits=Ee.bits,Re){e.msg="invalid literal/lengths set",r.mode=he;break}if(r.distbits=6,r.distcode=r.distdyn,Ee={bits:r.distbits},Re=k(S,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,Ee),r.distbits=Ee.bits,Re){e.msg="invalid distances set",r.mode=he;break}if(r.mode=re,t===P)break e;case re:r.mode=ne;case ne:if(u>=6&&c>=258){e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=u,r.hold=h,r.bits=p,w(e,b),a=e.next_out,o=e.output,c=e.avail_out,s=e.next_in,i=e.input,u=e.avail_in,h=r.hold,p=r.bits,r.mode===K&&(r.back=-1);break}for(r.back=0;xe=r.lencode[h&(1<<r.lenbits)-1],ye=xe>>>24,ge=xe>>>16&255,ve=65535&xe,!(ye<=p);){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(ge&&0==(240&ge)){for(_e=ye,me=ge,we=ve;xe=r.lencode[we+((h&(1<<_e+me)-1)>>_e)],ye=xe>>>24,ge=xe>>>16&255,ve=65535&xe,!(_e+ye<=p);){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}h>>>=_e,p-=_e,r.back+=_e}if(h>>>=ye,p-=ye,r.back+=ye,r.length=ve,0===ge){r.mode=ue;break}if(32&ge){r.back=-1,r.mode=K;break}if(64&ge){e.msg="invalid literal/length code",r.mode=he;break}r.extra=15&ge,r.mode=ie;case ie:if(r.extra){for(Se=r.extra;p<Se;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.length+=h&(1<<r.extra)-1,h>>>=r.extra,p-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=oe;case oe:for(;xe=r.distcode[h&(1<<r.distbits)-1],ye=xe>>>24,ge=xe>>>16&255,ve=65535&xe,!(ye<=p);){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(0==(240&ge)){for(_e=ye,me=ge,we=ve;xe=r.distcode[we+((h&(1<<_e+me)-1)>>_e)],ye=xe>>>24,ge=xe>>>16&255,ve=65535&xe,!(_e+ye<=p);){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}h>>>=_e,p-=_e,r.back+=_e}if(h>>>=ye,p-=ye,r.back+=ye,64&ge){e.msg="invalid distance code",r.mode=he;break}r.offset=ve,r.extra=15&ge,r.mode=se;case se:if(r.extra){for(Se=r.extra;p<Se;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}r.offset+=h&(1<<r.extra)-1,h>>>=r.extra,p-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=he;break}r.mode=ae;case ae:if(0===c)break e;if(y=b-c,r.offset>y){if((y=r.offset-y)>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=he;break}y>r.wnext?(y-=r.wnext,g=r.wsize-y):g=r.wnext-y,y>r.length&&(y=r.length),be=r.window}else be=o,g=a-r.offset,y=r.length;y>c&&(y=c),c-=y,r.length-=y;do{o[a++]=be[g++]}while(--y);0===r.length&&(r.mode=ne);break;case ue:if(0===c)break e;o[a++]=r.length,c--,r.mode=ne;break;case ce:if(r.wrap){for(;p<32;){if(0===u)break e;u--,h|=i[s++]<<p,p+=8}if(b-=c,e.total_out+=b,r.total+=b,b&&(e.adler=r.check=r.flags?m(r.check,o,b,a-b):_(r.check,o,b,a-b)),b=c,(r.flags?h:n(h))!==r.check){e.msg="incorrect data check",r.mode=he;break}h=0,p=0}r.mode=le;case le:if(r.wrap&&r.flags){for(;p<32;){if(0===u)break e;u--,h+=i[s++]<<p,p+=8}if(h!==(4294967295&r.total)){e.msg="incorrect length check",r.mode=he;break}h=0,p=0}r.mode=fe;case fe:Re=T;break e;case he:Re=N;break e;case pe:return I;case de:default:return C}return e.next_out=a,e.avail_out=c,e.next_in=s,e.avail_in=u,r.hold=h,r.bits=p,(r.wsize||b!==e.avail_out&&r.mode<he&&(r.mode<ce||t!==x))&&f(e,e.output,e.next_out,b-e.avail_out)?(r.mode=pe,I):(d-=e.avail_in,b-=e.avail_out,e.total_in+=d,e.total_out+=b,r.total+=b,r.wrap&&b&&(e.adler=r.check=r.flags?m(r.check,o,b,e.next_out-b):_(r.check,o,b,e.next_out-b)),e.data_type=r.bits+(r.last?64:0)+(r.mode===K?128:0)+(r.mode===re||r.mode===G?256:0),(0===d&&0===b||t===x)&&Re===j&&(Re=L),Re)}function p(e){if(!e||!e.state)return C;var t=e.state;return t.window&&(t.window=null),e.state=null,j}function d(e,t){var r;return e&&e.state?(r=e.state,0==(2&r.wrap)?C:(r.head=t,t.done=!1,j)):C}function b(e,t){var r,n,i=t.length;return e&&e.state?(r=e.state,0!==r.wrap&&r.mode!==Y?C:r.mode===Y&&(n=1,(n=_(n,t,i,0))!==r.check)?N:f(e,t,i,i)?(r.mode=pe,I):(r.havedict=1,j)):C}var y,g,v=r(20),_=r(30),m=r(31),w=r(70),k=r(72),R=0,E=1,S=2,x=4,O=5,P=6,j=0,T=1,A=2,C=-2,N=-3,I=-4,L=-5,U=8,B=1,D=2,M=3,q=4,W=5,F=6,z=7,J=8,H=9,Z=10,Y=11,K=12,X=13,V=14,G=15,Q=16,$=17,ee=18,te=19,re=20,ne=21,ie=22,oe=23,se=24,ae=25,ue=26,ce=27,le=28,fe=29,he=30,pe=31,de=32,be=852,ye=592,ge=15,ve=!0;t.inflateReset=s,t.inflateReset2=a,t.inflateResetKeep=o,t.inflateInit=c,t.inflateInit2=u,t.inflate=h,t.inflateEnd=p,t.inflateGetHeader=d,t.inflateSetDictionary=b,t.inflateInfo="pako inflate (from Nodeca project)"},function(e,t,r){"use strict";var n=r(20),i=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],s=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],a=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];e.exports=function(e,t,r,u,c,l,f,h){var p,d,b,y,g,v,_,m,w,k=h.bits,R=0,E=0,S=0,x=0,O=0,P=0,j=0,T=0,A=0,C=0,N=null,I=0,L=new n.Buf16(16),U=new n.Buf16(16),B=null,D=0;for(R=0;R<=15;R++)L[R]=0;for(E=0;E<u;E++)L[t[r+E]]++;for(O=k,x=15;x>=1&&0===L[x];x--);if(O>x&&(O=x),0===x)return c[l++]=20971520,c[l++]=20971520,h.bits=1,0;for(S=1;S<x&&0===L[S];S++);for(O<S&&(O=S),T=1,R=1;R<=15;R++)if(T<<=1,(T-=L[R])<0)return-1;if(T>0&&(0===e||1!==x))return-1;for(U[1]=0,R=1;R<15;R++)U[R+1]=U[R]+L[R];for(E=0;E<u;E++)0!==t[r+E]&&(f[U[t[r+E]]++]=E);if(0===e?(N=B=f,v=19):1===e?(N=i,I-=257,B=o,D-=257,v=256):(N=s,B=a,v=-1),C=0,E=0,R=S,g=l,P=O,j=0,b=-1,A=1<<O,y=A-1,1===e&&A>852||2===e&&A>592)return 1;for(;;){_=R-j,f[E]<v?(m=0,w=f[E]):f[E]>v?(m=B[D+f[E]],w=N[I+f[E]]):(m=96,w=0),p=1<<R-j,d=1<<P,S=d;do{d-=p,c[g+(C>>j)+d]=_<<24|m<<16|w|0}while(0!==d);for(p=1<<R-1;C&p;)p>>=1;if(0!==p?(C&=p-1,C+=p):C=0,E++,0==--L[R]){if(R===x)break;R=t[r+f[E]]}if(R>O&&(C&y)!==b){for(0===j&&(j=O),g+=S,P=R-j,T=1<<P;P+j<x&&!((T-=L[P+j])<=0);)P++,T<<=1;if(A+=1<<P,1===e&&A>852||2===e&&A>592)return 1;b=C&y,c[b]=O<<24|P<<16|g-l|0}}return 0!==C&&(c[g+C]=R-j<<24|64<<16|0),h.bits=O,0}},function(e,t,r){"use strict";e.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},function(e,t,r){"use strict";function n(e){for(var t=e.length;--t>=0;)e[t]=0}function i(e,t,r,n,i){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=n,this.max_length=i,this.has_stree=e&&e.length}function o(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function s(e){return e<256?oe[e]:oe[256+(e>>>7)]}function a(e,t){e.pending_buf[e.pending++]=255&t,e.pending_buf[e.pending++]=t>>>8&255}function u(e,t,r){e.bi_valid>Y-r?(e.bi_buf|=t<<e.bi_valid&65535,a(e,e.bi_buf),e.bi_buf=t>>Y-e.bi_valid,e.bi_valid+=r-Y):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function c(e,t,r){u(e,r[2*t],r[2*t+1])}function l(e,t){var r=0;do{r|=1&e,e>>>=1,r<<=1}while(--t>0);return r>>>1}function f(e){16===e.bi_valid?(a(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=255&e.bi_buf,e.bi_buf>>=8,e.bi_valid-=8)}function h(e,t){var r,n,i,o,s,a,u=t.dyn_tree,c=t.max_code,l=t.stat_desc.static_tree,f=t.stat_desc.has_stree,h=t.stat_desc.extra_bits,p=t.stat_desc.extra_base,d=t.stat_desc.max_length,b=0;for(o=0;o<=Z;o++)e.bl_count[o]=0;for(u[2*e.heap[e.heap_max]+1]=0,r=e.heap_max+1;r<H;r++)n=e.heap[r],o=u[2*u[2*n+1]+1]+1,o>d&&(o=d,b++),u[2*n+1]=o,n>c||(e.bl_count[o]++,s=0,n>=p&&(s=h[n-p]),a=u[2*n],e.opt_len+=a*(o+s),f&&(e.static_len+=a*(l[2*n+1]+s)));if(0!==b){do{for(o=d-1;0===e.bl_count[o];)o--;e.bl_count[o]--,e.bl_count[o+1]+=2,e.bl_count[d]--,b-=2}while(b>0);for(o=d;0!==o;o--)for(n=e.bl_count[o];0!==n;)(i=e.heap[--r])>c||(u[2*i+1]!==o&&(e.opt_len+=(o-u[2*i+1])*u[2*i],u[2*i+1]=o),n--)}}function p(e,t,r){var n,i,o=new Array(Z+1),s=0;for(n=1;n<=Z;n++)o[n]=s=s+r[n-1]<<1;for(i=0;i<=t;i++){var a=e[2*i+1];0!==a&&(e[2*i]=l(o[a]++,a))}}function d(){var e,t,r,n,o,s=new Array(Z+1);for(r=0,n=0;n<q-1;n++)for(ae[n]=r,e=0;e<1<<$[n];e++)se[r++]=n;for(se[r-1]=n,o=0,n=0;n<16;n++)for(ue[n]=o,e=0;e<1<<ee[n];e++)oe[o++]=n;for(o>>=7;n<z;n++)for(ue[n]=o<<7,e=0;e<1<<ee[n]-7;e++)oe[256+o++]=n;for(t=0;t<=Z;t++)s[t]=0;for(e=0;e<=143;)ne[2*e+1]=8,e++,s[8]++;for(;e<=255;)ne[2*e+1]=9,e++,s[9]++;for(;e<=279;)ne[2*e+1]=7,e++,s[7]++;for(;e<=287;)ne[2*e+1]=8,e++,s[8]++;for(p(ne,F+1,s),e=0;e<z;e++)ie[2*e+1]=5,ie[2*e]=l(e,5);ce=new i(ne,$,W+1,F,Z),le=new i(ie,ee,0,z,Z),fe=new i(new Array(0),te,0,J,K)}function b(e){var t;for(t=0;t<F;t++)e.dyn_ltree[2*t]=0;for(t=0;t<z;t++)e.dyn_dtree[2*t]=0;for(t=0;t<J;t++)e.bl_tree[2*t]=0;e.dyn_ltree[2*X]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function y(e){e.bi_valid>8?a(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function g(e,t,r,n){y(e),n&&(a(e,r),a(e,~r)),C.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function v(e,t,r,n){var i=2*t,o=2*r;return e[i]<e[o]||e[i]===e[o]&&n[t]<=n[r]}function _(e,t,r){for(var n=e.heap[r],i=r<<1;i<=e.heap_len&&(i<e.heap_len&&v(t,e.heap[i+1],e.heap[i],e.depth)&&i++,!v(t,n,e.heap[i],e.depth));)e.heap[r]=e.heap[i],r=i,i<<=1;e.heap[r]=n}function m(e,t,r){var n,i,o,a,l=0;if(0!==e.last_lit)do{n=e.pending_buf[e.d_buf+2*l]<<8|e.pending_buf[e.d_buf+2*l+1],i=e.pending_buf[e.l_buf+l],l++,0===n?c(e,i,t):(o=se[i],c(e,o+W+1,t),a=$[o],0!==a&&(i-=ae[o],u(e,i,a)),n--,o=s(n),c(e,o,r),0!==(a=ee[o])&&(n-=ue[o],u(e,n,a)))}while(l<e.last_lit);c(e,X,t)}function w(e,t){var r,n,i,o=t.dyn_tree,s=t.stat_desc.static_tree,a=t.stat_desc.has_stree,u=t.stat_desc.elems,c=-1;for(e.heap_len=0,e.heap_max=H,r=0;r<u;r++)0!==o[2*r]?(e.heap[++e.heap_len]=c=r,e.depth[r]=0):o[2*r+1]=0;for(;e.heap_len<2;)i=e.heap[++e.heap_len]=c<2?++c:0,o[2*i]=1,e.depth[i]=0,e.opt_len--,a&&(e.static_len-=s[2*i+1]);for(t.max_code=c,r=e.heap_len>>1;r>=1;r--)_(e,o,r);i=u;do{r=e.heap[1],e.heap[1]=e.heap[e.heap_len--],_(e,o,1),n=e.heap[1],e.heap[--e.heap_max]=r,e.heap[--e.heap_max]=n,o[2*i]=o[2*r]+o[2*n],e.depth[i]=(e.depth[r]>=e.depth[n]?e.depth[r]:e.depth[n])+1,o[2*r+1]=o[2*n+1]=i,e.heap[1]=i++,_(e,o,1)}while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],h(e,t),p(o,c,e.bl_count)}function k(e,t,r){var n,i,o=-1,s=t[1],a=0,u=7,c=4;for(0===s&&(u=138,c=3),t[2*(r+1)+1]=65535,n=0;n<=r;n++)i=s,s=t[2*(n+1)+1],++a<u&&i===s||(a<c?e.bl_tree[2*i]+=a:0!==i?(i!==o&&e.bl_tree[2*i]++,e.bl_tree[2*V]++):a<=10?e.bl_tree[2*G]++:e.bl_tree[2*Q]++,a=0,o=i,0===s?(u=138,c=3):i===s?(u=6,c=3):(u=7,c=4))}function R(e,t,r){var n,i,o=-1,s=t[1],a=0,l=7,f=4;for(0===s&&(l=138,f=3),n=0;n<=r;n++)if(i=s,s=t[2*(n+1)+1],!(++a<l&&i===s)){if(a<f)do{c(e,i,e.bl_tree)}while(0!=--a);else 0!==i?(i!==o&&(c(e,i,e.bl_tree),a--),c(e,V,e.bl_tree),u(e,a-3,2)):a<=10?(c(e,G,e.bl_tree),u(e,a-3,3)):(c(e,Q,e.bl_tree),u(e,a-11,7));a=0,o=i,0===s?(l=138,f=3):i===s?(l=6,f=3):(l=7,f=4)}}function E(e){var t;for(k(e,e.dyn_ltree,e.l_desc.max_code),k(e,e.dyn_dtree,e.d_desc.max_code),w(e,e.bl_desc),t=J-1;t>=3&&0===e.bl_tree[2*re[t]+1];t--);return e.opt_len+=3*(t+1)+5+5+4,t}function S(e,t,r,n){var i;for(u(e,t-257,5),u(e,r-1,5),u(e,n-4,4),i=0;i<n;i++)u(e,e.bl_tree[2*re[i]+1],3);R(e,e.dyn_ltree,t-1),R(e,e.dyn_dtree,r-1)}function x(e){var t,r=4093624447;for(t=0;t<=31;t++,r>>>=1)if(1&r&&0!==e.dyn_ltree[2*t])return I;if(0!==e.dyn_ltree[18]||0!==e.dyn_ltree[20]||0!==e.dyn_ltree[26])return L;for(t=32;t<W;t++)if(0!==e.dyn_ltree[2*t])return L;return I}function O(e){he||(d(),he=!0),e.l_desc=new o(e.dyn_ltree,ce),e.d_desc=new o(e.dyn_dtree,le),e.bl_desc=new o(e.bl_tree,fe),e.bi_buf=0,e.bi_valid=0,b(e)}function P(e,t,r,n){u(e,(B<<1)+(n?1:0),3),g(e,t,r,!0)}function j(e){u(e,D<<1,3),c(e,X,ne),f(e)}function T(e,t,r,n){var i,o,s=0;e.level>0?(e.strm.data_type===U&&(e.strm.data_type=x(e)),w(e,e.l_desc),w(e,e.d_desc),s=E(e),i=e.opt_len+3+7>>>3,(o=e.static_len+3+7>>>3)<=i&&(i=o)):i=o=r+5,r+4<=i&&-1!==t?P(e,t,r,n):e.strategy===N||o===i?(u(e,(D<<1)+(n?1:0),3),m(e,ne,ie)):(u(e,(M<<1)+(n?1:0),3),S(e,e.l_desc.max_code+1,e.d_desc.max_code+1,s+1),m(e,e.dyn_ltree,e.dyn_dtree)),b(e),n&&y(e)}function A(e,t,r){return e.pending_buf[e.d_buf+2*e.last_lit]=t>>>8&255,e.pending_buf[e.d_buf+2*e.last_lit+1]=255&t,e.pending_buf[e.l_buf+e.last_lit]=255&r,e.last_lit++,0===t?e.dyn_ltree[2*r]++:(e.matches++,t--,e.dyn_ltree[2*(se[r]+W+1)]++,e.dyn_dtree[2*s(t)]++),e.last_lit===e.lit_bufsize-1}var C=r(20),N=4,I=0,L=1,U=2,B=0,D=1,M=2,q=29,W=256,F=W+1+q,z=30,J=19,H=2*F+1,Z=15,Y=16,K=7,X=256,V=16,G=17,Q=18,$=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ee=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],te=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],re=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ne=new Array(2*(F+2));n(ne);var ie=new Array(2*z);n(ie);var oe=new Array(512);n(oe);var se=new Array(256);n(se);var ae=new Array(q);n(ae);var ue=new Array(z);n(ue);var ce,le,fe,he=!1;t._tr_init=O,t._tr_stored_block=P,t._tr_flush_block=T,t._tr_tally=A,t._tr_align=j},function(e,t,r){"use strict";function n(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}e.exports=n},function(e,t,r){(function(e,n){var i;!function(o){function s(e){throw new RangeError(C[e])}function a(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function u(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),e=e.replace(A,"."),n+a(e.split("."),t).join(".")}function c(e){for(var t,r,n=[],i=0,o=e.length;i<o;)t=e.charCodeAt(i++),t>=55296&&t<=56319&&i<o?(r=e.charCodeAt(i++),56320==(64512&r)?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),i--)):n.push(t);return n}function l(e){return a(e,function(e){var t="";return e>65535&&(e-=65536,t+=L(e>>>10&1023|55296),e=56320|1023&e),t+=L(e)}).join("")}function f(e){return e-48<10?e-22:e-65<26?e-65:e-97<26?e-97:w}function h(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function p(e,t,r){var n=0;for(e=r?I(e/S):e>>1,e+=I(e/t);e>N*R>>1;n+=w)e=I(e/N);return I(n+(N+1)*e/(e+E))}function d(e){var t,r,n,i,o,a,u,c,h,d,b=[],y=e.length,g=0,v=O,_=x;for(r=e.lastIndexOf(P),r<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&s("not-basic"),b.push(e.charCodeAt(n));for(i=r>0?r+1:0;i<y;){for(o=g,a=1,u=w;i>=y&&s("invalid-input"),c=f(e.charCodeAt(i++)),(c>=w||c>I((m-g)/a))&&s("overflow"),g+=c*a,h=u<=_?k:u>=_+R?R:u-_,!(c<h);u+=w)d=w-h,a>I(m/d)&&s("overflow"),a*=d;t=b.length+1,_=p(g-o,t,0==o),I(g/t)>m-v&&s("overflow"),v+=I(g/t),g%=t,b.splice(g++,0,v)}return l(b)}function b(e){var t,r,n,i,o,a,u,l,f,d,b,y,g,v,_,E=[];for(e=c(e),y=e.length,t=O,r=0,o=x,a=0;a<y;++a)(b=e[a])<128&&E.push(L(b));for(n=i=E.length,i&&E.push(P);n<y;){for(u=m,a=0;a<y;++a)(b=e[a])>=t&&b<u&&(u=b);for(g=n+1,u-t>I((m-r)/g)&&s("overflow"),r+=(u-t)*g,t=u,a=0;a<y;++a)if(b=e[a],b<t&&++r>m&&s("overflow"),b==t){for(l=r,f=w;d=f<=o?k:f>=o+R?R:f-o,!(l<d);f+=w)_=l-d,v=w-d,E.push(L(h(d+_%v,0))),l=I(_/v);E.push(L(h(l,0))),o=p(r,g,n==i),r=0,++n}++r,++t}return E.join("")}function y(e){return u(e,function(e){return j.test(e)?d(e.slice(4).toLowerCase()):e})}function g(e){return u(e,function(e){return T.test(e)?"xn--"+b(e):e})}var v=("object"==typeof t&&t&&t.nodeType,"object"==typeof e&&e&&e.nodeType,"object"==typeof n&&n);var _,m=2147483647,w=36,k=1,R=26,E=38,S=700,x=72,O=128,P="-",j=/^xn--/,T=/[^\x20-\x7E]/,A=/[\x2E\u3002\uFF0E\uFF61]/g,C={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},N=w-k,I=Math.floor,L=String.fromCharCode;_={version:"1.4.1",ucs2:{decode:c,encode:l},decode:d,encode:b,toASCII:g,toUnicode:y},void 0!==(i=function(){return _}.call(t,r,t,e))&&(e.exports=i)}()}).call(t,r(93)(e),r(5))},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,o){t=t||"&",r=r||"=";var s={};if("string"!=typeof e||0===e.length)return s;var a=/\+/g;e=e.split(t);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var c=e.length;u>0&&c>u&&(c=u);for(var l=0;l<c;++l){var f,h,p,d,b=e[l].replace(a,"%20"),y=b.indexOf(r);y>=0?(f=b.substr(0,y),h=b.substr(y+1)):(f=b,h=""),p=decodeURIComponent(f),d=decodeURIComponent(h),n(s,p)?i(s[p])?s[p].push(d):s[p]=[s[p],d]:s[p]=d}return s};var i=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)}},function(e,t,r){"use strict";function n(e,t){if(e.map)return e.map(t);for(var r=[],n=0;n<e.length;n++)r.push(t(e[n],n));return r}var i=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?n(s(e),function(s){var a=encodeURIComponent(i(s))+r;return o(e[s])?n(e[s],function(e){return a+encodeURIComponent(i(e))}).join(t):a+encodeURIComponent(i(e[s]))}).join(t):a?encodeURIComponent(i(a))+r+encodeURIComponent(i(e)):""};var o=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},s=Object.keys||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.push(r);return t}},function(e,t,r){e.exports=r(11)},function(e,t,r){"use strict";function n(e){if(!(this instanceof n))return new n(e);i.call(this,e)}e.exports=n;var i=r(33),o=r(16);o.inherits=r(13),o.inherits(n,i),n.prototype._transform=function(e,t,r){r(null,e)}},function(e,t,r){"use strict";function n(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t,r){e.copy(t,r)}var o=r(22).Buffer;e.exports=function(){function e(){n(this,e),this.head=null,this.tail=null,this.length=0}return e.prototype.push=function(e){var t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length},e.prototype.unshift=function(e){var t={data:e,next:this.head};0===this.length&&(this.tail=t),this.head=t,++this.length},e.prototype.shift=function(){if(0!==this.length){var e=this.head.data;return 1===this.length?this.head=this.tail=null:this.head=this.head.next,--this.length,e}},e.prototype.clear=function(){this.head=this.tail=null,this.length=0},e.prototype.join=function(e){if(0===this.length)return"";for(var t=this.head,r=""+t.data;t=t.next;)r+=e+t.data;return r},e.prototype.concat=function(e){if(0===this.length)return o.alloc(0);if(1===this.length)return this.head.data;for(var t=o.allocUnsafe(e>>>0),r=this.head,n=0;r;)i(r.data,t,n),n+=r.data.length,r=r.next;return t},e}()},function(e,t,r){e.exports=r(28).PassThrough},function(e,t,r){e.exports=r(28).Transform},function(e,t,r){e.exports=r(27)},function(e,t,r){(function(e,t){!function(e,r){"use strict";function n(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),r=0;r<t.length;r++)t[r]=arguments[r+1];var n={callback:e,args:t};return c[u]=n,a(u),u++}function i(e){delete c[e]}function o(e){var t=e.callback,n=e.args;switch(n.length){case 0:t();break;case 1:t(n[0]);break;case 2:t(n[0],n[1]);break;case 3:t(n[0],n[1],n[2]);break;default:t.apply(r,n)}}function s(e){if(l)setTimeout(s,0,e);else{var t=c[e];if(t){l=!0;try{o(t)}finally{i(e),l=!1}}}}if(!e.setImmediate){var a,u=1,c={},l=!1,f=e.document,h=Object.getPrototypeOf&&Object.getPrototypeOf(e);h=h&&h.setTimeout?h:e,"[object process]"==={}.toString.call(e.process)?function(){a=function(e){t.nextTick(function(){s(e)})}}():function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?function(){var t="setImmediate$"+Math.random()+"$",r=function(r){r.source===e&&"string"==typeof r.data&&0===r.data.indexOf(t)&&s(+r.data.slice(t.length))};e.addEventListener?e.addEventListener("message",r,!1):e.attachEvent("onmessage",r),a=function(r){e.postMessage(t+r,"*")}}():e.MessageChannel?function(){var e=new MessageChannel;e.port1.onmessage=function(e){s(e.data)},a=function(t){e.port2.postMessage(t)}}():f&&"onreadystatechange"in f.createElement("script")?function(){var e=f.documentElement;a=function(t){var r=f.createElement("script");r.onreadystatechange=function(){s(t),r.onreadystatechange=null,e.removeChild(r),r=null},e.appendChild(r)}}():function(){a=function(e){setTimeout(s,0,e)}}(),h.setImmediate=n,h.clearImmediate=i}}("undefined"==typeof self?void 0===e?this:e:self)}).call(t,r(5),r(0))},function(e,t){function r(e){return new Promise(function(t){setTimeout(t,e)})}function n(e){function t(t){return r(e).then(function(){return t})}return t.then=function(){var t=r(e);return t.then.apply(t,arguments)},t.catch=Promise.resolve().catch,t}e.exports=n},function(e,t,r){function n(){i.call(this)}e.exports=n;var i=r(9).EventEmitter;r(13)(n,i),n.Readable=r(28),n.Writable=r(84),n.Duplex=r(79),n.Transform=r(83),n.PassThrough=r(82),n.Stream=n,n.prototype.pipe=function(e,t){function r(t){e.writable&&!1===e.write(t)&&c.pause&&c.pause()}function n(){c.readable&&c.resume&&c.resume()}function o(){l||(l=!0,e.end())}function s(){l||(l=!0,"function"==typeof e.destroy&&e.destroy())}function a(e){if(u(),0===i.listenerCount(this,"error"))throw e}function u(){c.removeListener("data",r),e.removeListener("drain",n),c.removeListener("end",o),c.removeListener("close",s),c.removeListener("error",a),e.removeListener("error",a),c.removeListener("end",u),c.removeListener("close",u),e.removeListener("close",u)}var c=this;c.on("data",r),e.on("drain",n),e._isStdio||t&&!1===t.end||(c.on("end",o),c.on("close",s));var l=!1;return c.on("error",a),e.on("error",a),c.on("end",u),c.on("close",u),e.on("close",u),e.emit("pipe",c),e}},function(e,t,r){(function(e){function n(e,t){this._id=e,this._clearFn=t}var i=Function.prototype.apply;t.setTimeout=function(){return new n(i.call(setTimeout,window,arguments),clearTimeout)},t.setInterval=function(){return new n(i.call(setInterval,window,arguments),clearInterval)},t.clearTimeout=t.clearInterval=function(e){e&&e.close()},n.prototype.unref=n.prototype.ref=function(){},n.prototype.close=function(){this._clearFn.call(window,this._id)},t.enroll=function(e,t){clearTimeout(e._idleTimeoutId),e._idleTimeout=t},t.unenroll=function(e){clearTimeout(e._idleTimeoutId),e._idleTimeout=-1},t._unrefActive=t.active=function(e){clearTimeout(e._idleTimeoutId);var t=e._idleTimeout;t>=0&&(e._idleTimeoutId=setTimeout(function(){e._onTimeout&&e._onTimeout()},t))},r(85),t.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==e&&e.setImmediate||this&&this.setImmediate,t.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==e&&e.clearImmediate||this&&this.clearImmediate}).call(t,r(5))},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){(function(t){function r(e,t){function r(){if(!i){if(n("throwDeprecation"))throw new Error(t);n("traceDeprecation")?console.trace(t):console.warn(t),i=!0}return e.apply(this,arguments)}if(n("noDeprecation"))return e;var i=!1;return r}function n(e){try{if(!t.localStorage)return!1}catch(e){return!1}var r=t.localStorage[e];return null!=r&&"true"===String(r).toLowerCase()}e.exports=r}).call(t,r(5))},function(e,t){"function"==typeof Object.create?e.exports=function(e,t){e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}})}:e.exports=function(e,t){e.super_=t;var r=function(){};r.prototype=t.prototype,e.prototype=new r,e.prototype.constructor=e}},function(e,t){e.exports=function(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,r){e.exports=t},function(e,t){e.exports=r},function(e,t){},function(e,t){},function(e,t,r){e.exports=r(39)}])});
//# sourceMappingURL=jsonrpc.min.js.map